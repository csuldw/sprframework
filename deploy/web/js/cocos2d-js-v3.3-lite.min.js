var cc=cc||{};cc._tmp=cc._tmp||{};cc._LogInfos={};window._p;_p=window;_p.gl;_p.WebGLRenderingContext;_p.DeviceOrientationEvent;_p.DeviceMotionEvent;_p.AudioContext;_p.webkitAudioContext;_p.mozAudioContext;_p=Object.prototype;_p._super;_p.ctor;delete window._p;cc.newElement=function(a){return document.createElement(a);};cc._addEventListener=function(b,c,d,a){b.addEventListener(c,d,a);};cc._isNodeJs=typeof require!=="undefined"&&require("fs");cc.each=function(f,e,d){if(!f){return;}if(f instanceof Array){for(var c=0,a=f.length;c<a;c++){if(e.call(d,f[c],c)===false){return;}}}else{for(var b in f){if(e.call(d,f[b],b)===false){return;}}}};cc.extend=function(b){var a=arguments.length>=2?Array.prototype.slice.call(arguments,1):[];cc.each(a,function(d){for(var c in d){if(d.hasOwnProperty(c)){b[c]=d[c];}}});return b;};cc.isFunction=function(a){return typeof a=="function";};cc.isNumber=function(a){return typeof a=="number"||Object.prototype.toString.call(a)=="[object Number]";};cc.isString=function(a){return typeof a=="string"||Object.prototype.toString.call(a)=="[object String]";};cc.isArray=function(a){return Object.prototype.toString.call(a)=="[object Array]";};cc.isUndefined=function(a){return typeof a=="undefined";};cc.isObject=function(b){var a=typeof b;return a=="function"||(b&&a=="object");};cc.isCrossOrigin=function(a){if(!a){cc.log("invalid URL");return false;}var d=a.indexOf("://");if(d==-1){return false;}var c=a.indexOf("/",d+3);var b=(c==-1)?a:a.substring(0,c);return b!=location.origin;};cc.AsyncPool=function(d,a,e,c,f){var b=this;b._srcObj=d;b._limit=a;b._pool=[];b._iterator=e;b._iteratorTarget=f;b._onEnd=c;b._onEndTarget=f;b._results=d instanceof Array?[]:{};b._isErr=false;cc.each(d,function(h,g){b._pool.push({index:g,value:h});});b.size=b._pool.length;b.finishedSize=0;b._workingSize=0;b._limit=b._limit||b.size;b.onIterator=function(g,h){b._iterator=g;b._iteratorTarget=h;};b.onEnd=function(h,g){b._onEnd=h;b._onEndTarget=g;};b._handleItem=function(){var g=this;if(g._pool.length==0||g._workingSize>=g._limit){return;}var i=g._pool.shift();var j=i.value,h=i.index;g._workingSize++;g._iterator.call(g._iteratorTarget,j,h,function(m){if(g._isErr){return;}g.finishedSize++;g._workingSize--;if(m){g._isErr=true;if(g._onEnd){g._onEnd.call(g._onEndTarget,m);}return;}var k=Array.prototype.slice.call(arguments,1);g._results[this.index]=k[0];if(g.finishedSize==g.size){if(g._onEnd){g._onEnd.call(g._onEndTarget,null,g._results);}return;}g._handleItem();}.bind(i),g);};b.flow=function(){var g=this;if(g._pool.length==0){if(g._onEnd){g._onEnd.call(g._onEndTarget,null,[]);}return;}for(var h=0;h<g._limit;h++){g._handleItem();}};};cc.async={series:function(d,a,c){var b=new cc.AsyncPool(d,1,function(g,f,e){g.call(c,e);},a,c);b.flow();return b;},parallel:function(d,a,c){var b=new cc.AsyncPool(d,0,function(g,f,e){g.call(c,e);},a,c);b.flow();return b;},waterfall:function(f,a,d){var b=[];var e=[null];var c=new cc.AsyncPool(f,1,function(i,h,g){b.push(function(j){b=Array.prototype.slice.call(arguments,1);if(f.length-1==h){e=e.concat(b);}g.apply(null,arguments);});i.apply(d,b);},function(g){if(!a){return;}if(g){return a.call(d,g);}a.apply(d,e);});c.flow();return c;},map:function(f,c,e,d){var a=c;if(typeof(c)=="object"){e=c.cb;d=c.iteratorTarget;a=c.iterator;}var b=new cc.AsyncPool(f,0,a,e,d);b.flow();return b;},mapLimit:function(f,b,d,a,e){var c=new cc.AsyncPool(f,b,d,a,e);c.flow();return c;}};cc.path={join:function(){var b=arguments.length;var a="";for(var c=0;c<b;c++){a=(a+(a==""?"":"/")+arguments[c]).replace(/(\/|\\\\)$/,"");}return a;},extname:function(b){var a=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(b);return a?a[1]:null;},mainFileName:function(b){if(b){var a=b.lastIndexOf(".");if(a!==-1){return b.substring(0,a);}}return b;},basename:function(e,f){var b=e.indexOf("?");if(b>0){e=e.substring(0,b);}var d=/(\/|\\\\)([^(\/|\\\\)]+)$/g;var a=d.exec(e.replace(/(\/|\\\\)$/,""));if(!a){return null;}var c=a[2];if(f&&e.substring(e.length-f.length).toLowerCase()==f.toLowerCase()){return c.substring(0,c.length-f.length);}return c;},dirname:function(a){return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2");},changeExtname:function(c,d){d=d||"";var b=c.indexOf("?");var a="";if(b>0){a=c.substring(b);c=c.substring(0,b);}b=c.lastIndexOf(".");if(b<0){return c+d+a;}return c.substring(0,b)+d+a;},changeBasename:function(e,f,b){if(f.indexOf(".")==0){return this.changeExtname(e,f);}var c=e.indexOf("?");var a="";var d=b?this.extname(e):"";if(c>0){a=e.substring(c);e=e.substring(0,c);}c=e.lastIndexOf("/");c=c<=0?0:c+1;return e.substring(0,c)+f+d+a;}};cc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest():new ActiveXObject("MSXML2.XMLHTTP");},_getArgs4Js:function(d){var c=d[0],b=d[1],a=d[2],e=["",null,null];if(d.length===1){e[1]=c instanceof Array?c:[c];}else{if(d.length===2){if(typeof b=="function"){e[1]=c instanceof Array?c:[c];e[2]=b;}else{e[0]=c||"";e[1]=b instanceof Array?b:[b];}}else{if(d.length===3){e[0]=c||"";e[1]=b instanceof Array?b:[b];e[2]=a;}else{throw"arguments error to load js!";}}}return e;},loadJs:function(f,c,a){var h=this,i=h._jsCache,e=h._getArgs4Js(arguments);var b=e[0],d=e[1],g=e[2];if(navigator.userAgent.indexOf("Trident/5")>-1){h._loadJs4Dependency(b,d,0,g);}else{cc.async.map(d,function(m,k,j){var n=cc.path.join(b,m);if(i[n]){return j(null);}h._createScript(n,false,j);},g);}},loadJsWithImg:function(e,f,b){var c=this,a=c._loadJsImg(),d=c._getArgs4Js(arguments);this.loadJs(d[0],d[1],function(g){if(g){throw g;}a.parentNode.removeChild(a);if(d[2]){d[2]();}});},_createScript:function(f,e,a){var g=document,b=this,c=cc.newElement("script");c.async=e;b._jsCache[f]=true;if(cc.game.config["noCache"]&&typeof f==="string"){if(b._noCacheRex.test(f)){c.src=f+"&_t="+(new Date()-0);}else{c.src=f+"?_t="+(new Date()-0);}}else{c.src=f;}cc._addEventListener(c,"load",function(){c.parentNode.removeChild(c);this.removeEventListener("load",arguments.callee,false);a();},false);cc._addEventListener(c,"error",function(){c.parentNode.removeChild(c);a("Load "+f+" failed!");},false);g.body.appendChild(c);},_loadJs4Dependency:function(d,e,c,a){if(c>=e.length){if(a){a();}return;}var b=this;b._createScript(cc.path.join(d,e[c]),false,function(f){if(f){return a(f);}b._loadJs4Dependency(d,e,c+1,a);});},_loadJsImg:function(){var e=document,b=e.getElementById("cocos2d_loadJsImg");if(!b){b=cc.newElement("img");if(cc._loadingImage){b.src=cc._loadingImage;}var c=e.getElementById(cc.game.config["id"]);c.style.backgroundColor="black";c.parentNode.appendChild(b);var a=getComputedStyle?getComputedStyle(c):c.currentStyle;if(!a){a={width:c.width,height:c.height};}b.style.left=c.offsetLeft+(parseFloat(a.width)-b.width)/2+"px";b.style.top=c.offsetTop+(parseFloat(a.height)-b.height)/2+"px";b.style.position="absolute";}return b;},loadTxt:function(c,b){if(!cc._isNodeJs){var e=this.getXMLHttpRequest(),d="load "+c+" failed!";e.open("GET",c,true);if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){e.setRequestHeader("Accept-Charset","utf-8");e.onreadystatechange=function(){if(e.readyState==4){e.status==200?b(null,e.responseText):b(d);}};}else{if(e.overrideMimeType){e.overrideMimeType("text/plain; charset=utf-8");}e.onload=function(){if(e.readyState==4){e.status==200?b(null,e.responseText):b(d);}};}e.send(null);}else{var a=require("fs");a.readFile(c,function(f,g){f?b(f):b(null,g.toString());});}},_loadTxtSync:function(b){if(!cc._isNodeJs){var c=this.getXMLHttpRequest();c.open("GET",b,false);if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){c.setRequestHeader("Accept-Charset","utf-8");}else{if(c.overrideMimeType){c.overrideMimeType("text/plain; charset=utf-8");}}c.send(null);if(!c.readyState==4||c.status!=200){return null;}return c.responseText;}else{var a=require("fs");return a.readFileSync(b).toString();}},loadCsb:function(b,a){var c=new XMLHttpRequest();c.open("GET",b,true);c.responseType="arraybuffer";c.onload=function(){var d=c.response;if(d){window.msg=d;}if(c.readyState==4){c.status==200?a(null,c.response):a("load "+b+" failed!");}};c.send(null);},loadJson:function(b,a){this.loadTxt(b,function(f,d){if(f){a(f);}else{try{var c=JSON.parse(d);}catch(g){throw"parse json ["+b+"] failed : "+g;return;}a(null,c);}});},_checkIsImageURL:function(a){var b=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(a);return(b!=null);},loadImg:function(e,g,h){var f={isCrossOrigin:true};if(h!==undefined){f.isCrossOrigin=g.isCrossOrigin==null?f.isCrossOrigin:g.isCrossOrigin;}else{if(g!==undefined){h=g;}}var d=this.getRes(e);if(d){h&&h(null,d);return d;}d=new Image();if(f.isCrossOrigin&&location.origin!="file://"){d.crossOrigin="Anonymous";}var a=function(){this.removeEventListener("load",a,false);this.removeEventListener("error",b,false);cc.loader.cache[e]=d;if(h){h(null,d);}};var c=this;var b=function(){this.removeEventListener("error",b,false);if(d.crossOrigin&&d.crossOrigin.toLowerCase()=="anonymous"){f.isCrossOrigin=false;c.release(e);cc.loader.loadImg(e,f,h);}else{typeof h=="function"&&h("load image failed");}};cc._addEventListener(d,"load",a);cc._addEventListener(d,"error",b);d.src=e;return d;},_loadResIterator:function(i,e,b){var j=this,a=null;var f=i.type;if(f){f="."+f.toLowerCase();a=i.src?i.src:i.name+f;}else{a=i;f=cc.path.extname(a);}var d=j.getRes(a);if(d){return b(null,d);}var g=null;if(f){g=j._register[f.toLowerCase()];}if(!g){cc.error("loader for ["+f+"] not exists!");return b();}var h=g.getBasePath?g.getBasePath():j.resPath;var c=j.getUrl(h,a);if(cc.game.config["noCache"]&&typeof c==="string"){if(j._noCacheRex.test(c)){c+="&_t="+(new Date()-0);}else{c+="?_t="+(new Date()-0);}}g.load(c,a,i,function(k,m){if(k){cc.log(k);j.cache[a]=null;delete j.cache[a];b();}else{j.cache[a]=m;b(null,m);}});},_noCacheRex:/\?/,getUrl:function(h,d){var b=this,c=b._langPathCache,f=cc.path;if(h!==undefined&&d===undefined){d=h;var e=f.extname(d);e=e?e.toLowerCase():"";var a=b._register[e];if(!a){h=b.resPath;}else{h=a.getBasePath?a.getBasePath():b.resPath;}}d=cc.path.join(h||"",d);if(d.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(c[d]){return c[d];}var g=f.extname(d)||"";d=c[d]=d.substring(0,d.length-g.length)+"_"+cc.sys.language+g;}return d;},load:function(f,e,b){var c=this;var a=arguments.length;if(a==0){throw"arguments error!";}if(a==3){if(typeof e=="function"){if(typeof b=="function"){e={trigger:e,cb:b};}else{e={cb:e,cbTarget:b};}}}else{if(a==2){if(typeof e=="function"){e={cb:e};}}else{if(a==1){e={};}}}if(!(f instanceof Array)){f=[f];}var d=new cc.AsyncPool(f,0,function(j,h,i,g){c._loadResIterator(j,h,function(m){if(m){return i(m);}var k=Array.prototype.slice.call(arguments,1);if(e.trigger){e.trigger.call(e.triggerTarget,k[0],g.size,g.finishedSize);}i(null,k[0]);});},e.cb,e.cbTarget);d.flow();return d;},_handleAliases:function(c,a){var d=this,b=d._aliases;var f=[];for(var e in c){var g=c[e];b[e]=g;f.push(g);}this.load(f,a);},loadAliases:function(b,d){var a=this,c=a.getRes(b);if(!c){a.load(b,function(f,e){a._handleAliases(e[0]["filenames"],d);});}else{a._handleAliases(c["filenames"],d);}},register:function(e,b){if(!e||!b){return;}var c=this;if(typeof e=="string"){return this._register[e.trim().toLowerCase()]=b;}for(var d=0,a=e.length;d<a;d++){c._register["."+e[d].trim().toLowerCase()]=b;}},getRes:function(a){return this.cache[a]||this.cache[this._aliases[a]];},release:function(c){var b=this.cache,a=this._aliases;delete b[c];delete b[a[c]];delete a[c];},releaseAll:function(){var c=this.cache,a=this._aliases;for(var b in c){delete c[b];}for(var b in a){delete a[b];}}};cc.formatStr=function(){var e=arguments;var c=e.length;if(c<1){return"";}var g=e[0];var d=true;if(typeof g=="object"){d=false;}for(var f=1;f<c;++f){var b=e[f];if(d){while(true){var a=null;if(typeof b=="number"){a=g.match(/(%d)|(%s)/);if(a){g=g.replace(/(%d)|(%s)/,b);break;}}a=g.match(/%s/);if(a){g=g.replace(/%s/,b);}else{g+="    "+b;}break;}}else{g+="    "+b;}}return g;};(function(){var d=window,c,b,a="undefined";if(!cc.isUndefined(document.hidden)){c="hidden";b="visibilitychange";}else{if(!cc.isUndefined(document.mozHidden)){c="mozHidden";b="mozvisibilitychange";}else{if(!cc.isUndefined(document.msHidden)){c="msHidden";b="msvisibilitychange";}else{if(!cc.isUndefined(document.webkitHidden)){c="webkitHidden";b="webkitvisibilitychange";}}}}var f=function(){if(cc.eventManager&&cc.game._eventHide){cc.eventManager.dispatchEvent(cc.game._eventHide);}};var e=function(){if(cc.eventManager&&cc.game._eventShow){cc.eventManager.dispatchEvent(cc.game._eventShow);}if(cc.game._intervalId){window.cancelAnimationFrame(cc.game._intervalId);cc.game._runMainLoop();}};if(c){cc._addEventListener(document,b,function(){if(document[c]){f();}else{e();}},false);}else{cc._addEventListener(d,"blur",f,false);cc._addEventListener(d,"focus",e,false);}if(navigator.userAgent.indexOf("MicroMessenger")>-1){d.onfocus=function(){e();};}if("onpageshow" in window&&"onpagehide" in window){cc._addEventListener(d,"pagehide",f,false);cc._addEventListener(d,"pageshow",e,false);}d=null;b=null;})();cc.log=cc.warn=cc.error=cc.assert=function(){};cc.create3DContext=function(a,c){var g=["webgl","experimental-webgl","webkit-3d","moz-webgl"];var b=null;for(var d=0;d<g.length;++d){try{b=a.getContext(g[d],c);}catch(f){}if(b){break;}}return b;};cc._initSys=function(y,m){cc._RENDER_TYPE_CANVAS=0;cc._RENDER_TYPE_WEBGL=1;cc.sys={};var j=cc.sys;j.LANGUAGE_ENGLISH="en";j.LANGUAGE_CHINESE="zh";j.LANGUAGE_FRENCH="fr";j.LANGUAGE_ITALIAN="it";j.LANGUAGE_GERMAN="de";j.LANGUAGE_SPANISH="es";j.LANGUAGE_DUTCH="du";j.LANGUAGE_RUSSIAN="ru";j.LANGUAGE_KOREAN="ko";j.LANGUAGE_JAPANESE="ja";j.LANGUAGE_HUNGARIAN="hu";j.LANGUAGE_PORTUGUESE="pt";j.LANGUAGE_ARABIC="ar";j.LANGUAGE_NORWEGIAN="no";j.LANGUAGE_POLISH="pl";j.OS_WINDOWS="Windows";j.OS_IOS="iOS";j.OS_OSX="OS X";j.OS_UNIX="UNIX";j.OS_LINUX="Linux";j.OS_ANDROID="Android";j.OS_UNKNOWN="Unknown";j.WINDOWS=0;j.LINUX=1;j.MACOS=2;j.ANDROID=3;j.IPHONE=4;j.IPAD=5;j.BLACKBERRY=6;j.NACL=7;j.EMSCRIPTEN=8;j.TIZEN=9;j.WINRT=10;j.WP8=11;j.MOBILE_BROWSER=100;j.DESKTOP_BROWSER=101;j.BROWSER_TYPE_WECHAT="wechat";j.BROWSER_TYPE_ANDROID="androidbrowser";j.BROWSER_TYPE_IE="ie";j.BROWSER_TYPE_QQ="qqbrowser";j.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";j.BROWSER_TYPE_UC="ucbrowser";j.BROWSER_TYPE_360="360browser";j.BROWSER_TYPE_BAIDU_APP="baiduboxapp";j.BROWSER_TYPE_BAIDU="baidubrowser";j.BROWSER_TYPE_MAXTHON="maxthon";j.BROWSER_TYPE_OPERA="opera";j.BROWSER_TYPE_OUPENG="oupeng";j.BROWSER_TYPE_MIUI="miuibrowser";j.BROWSER_TYPE_FIREFOX="firefox";j.BROWSER_TYPE_SAFARI="safari";j.BROWSER_TYPE_CHROME="chrome";j.BROWSER_TYPE_LIEBAO="liebao";j.BROWSER_TYPE_QZONE="qzone";j.BROWSER_TYPE_SOUGOU="sogou";j.BROWSER_TYPE_UNKNOWN="unknown";j.isNative=false;var t=[j.BROWSER_TYPE_BAIDU,j.BROWSER_TYPE_OPERA,j.BROWSER_TYPE_FIREFOX,j.BROWSER_TYPE_CHROME,j.BROWSER_TYPE_SAFARI];var u=[j.OS_IOS,j.OS_WINDOWS,j.OS_OSX,j.OS_LINUX];var v=[j.BROWSER_TYPE_BAIDU,j.BROWSER_TYPE_OPERA,j.BROWSER_TYPE_FIREFOX,j.BROWSER_TYPE_CHROME,j.BROWSER_TYPE_BAIDU_APP,j.BROWSER_TYPE_SAFARI,j.BROWSER_TYPE_UC,j.BROWSER_TYPE_QQ,j.BROWSER_TYPE_MOBILE_QQ,j.BROWSER_TYPE_IE];var h=window,k=h.navigator,z=document,i=z.documentElement;var n=k.userAgent.toLowerCase();j.isMobile=n.indexOf("mobile")!=-1||n.indexOf("android")!=-1;j.platform=j.isMobile?j.MOBILE_BROWSER:j.DESKTOP_BROWSER;var d=k.language;d=d?d:k.browserLanguage;d=d?d.split("-")[0]:j.LANGUAGE_ENGLISH;j.language=d;var b=j.BROWSER_TYPE_UNKNOWN;var a=n.match(/sogou|qzone|liebao|micromessenger|qqbrowser|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|trident|oupeng|opera|miuibrowser|firefox/i)||n.match(/chrome|safari/i);if(a&&a.length>0){b=a[0];if(b=="micromessenger"){b=j.BROWSER_TYPE_WECHAT;}else{if(b==="safari"&&(n.match(/android.*applewebkit/))){b=j.BROWSER_TYPE_ANDROID;}else{if(b=="trident"){b=j.BROWSER_TYPE_IE;}else{if(b=="360 aphone"){b=j.BROWSER_TYPE_360;}}}}}else{if(n.indexOf("iphone")&&n.indexOf("mobile")){b="safari";}}j.browserType=b;var g=(n.match(/(iPad|iPhone|iPod)/i)?true:false);var x=n.match(/android/i)||k.platform.match(/android/i)?true:false;var p=j.OS_UNKNOWN;if(k.appVersion.indexOf("Win")!=-1){p=j.OS_WINDOWS;}else{if(g){p=j.OS_IOS;}else{if(k.appVersion.indexOf("Mac")!=-1){p=j.OS_OSX;}else{if(k.appVersion.indexOf("X11")!=-1&&k.appVersion.indexOf("Linux")==-1){p=j.OS_UNIX;}else{if(x){p=j.OS_ANDROID;}else{if(k.appVersion.indexOf("Linux")!=-1){p=j.OS_LINUX;}}}}}}j.os=p;j._supportMultipleAudio=v.indexOf(j.browserType)>-1;var w=parseInt(y[m.renderMode]);var o=cc._RENDER_TYPE_WEBGL;var q=cc.newElement("Canvas");cc._supportRender=true;var c=!window.WebGLRenderingContext||t.indexOf(j.browserType)==-1||u.indexOf(j.os)==-1;if(w===1||(w===0&&c)||(location.origin=="file://")){o=cc._RENDER_TYPE_CANVAS;}j._canUseCanvasNewBlendModes=function(){var e=document.createElement("canvas");e.width=1;e.height=1;var A=e.getContext("2d");A.fillStyle="#000";A.fillRect(0,0,1,1);A.globalCompositeOperation="multiply";var B=document.createElement("canvas");B.width=1;B.height=1;var C=B.getContext("2d");C.fillStyle="#fff";C.fillRect(0,0,1,1);A.drawImage(B,0,0,1,1);return A.getImageData(0,0,1,1).data[0]===0;};j._supportCanvasNewBlendModes=j._canUseCanvasNewBlendModes();if(o==cc._RENDER_TYPE_WEBGL){if(!h.WebGLRenderingContext||!cc.create3DContext(q,{"stencil":true,"preserveDrawingBuffer":true})){if(w==0){o=cc._RENDER_TYPE_CANVAS;}else{cc._supportRender=false;}}}if(o==cc._RENDER_TYPE_CANVAS){try{q.getContext("2d");}catch(s){cc._supportRender=false;}}cc._renderType=o;try{j._supportWebAudio=!!(h.AudioContext||h.webkitAudioContext||h.mozAudioContext);}catch(s){j._supportWebAudio=false;}try{var r=j.localStorage=h.localStorage;r.setItem("storage","");r.removeItem("storage");r=null;}catch(s){if(s.name==="SECURITY_ERR"||s.name==="QuotaExceededError"){cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option");}j.localStorage=function(){};}var f=j.capabilities={"canvas":true};if(cc._renderType==cc._RENDER_TYPE_WEBGL){f["opengl"]=true;}if(i["ontouchstart"]!==undefined||z["ontouchstart"]!==undefined||k.msPointerEnabled){f["touches"]=true;}if(i["onmouseup"]!==undefined){f["mouse"]=true;}if(i["onkeyup"]!==undefined){f["keyboard"]=true;}if(h.DeviceMotionEvent||h.DeviceOrientationEvent){f["accelerometer"]=true;}j.garbageCollect=function(){};j.dumpRoot=function(){};j.restartVM=function(){};j.cleanScript=function(e){};j.dump=function(){var e=this;var A="";A+="isMobile : "+e.isMobile+"\r\n";A+="language : "+e.language+"\r\n";A+="browserType : "+e.browserType+"\r\n";A+="capabilities : "+JSON.stringify(e.capabilities)+"\r\n";A+="os : "+e.os+"\r\n";A+="platform : "+e.platform+"\r\n";cc.log(A);};};cc.ORIENTATION_PORTRAIT=0;cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1;cc.ORIENTATION_LANDSCAPE_LEFT=2;cc.ORIENTATION_LANDSCAPE_RIGHT=3;cc._drawingUtil=null;cc._renderContext=null;cc._canvas=null;cc._gameDiv=null;cc._rendererInitialized=false;cc._setupCalled=false;cc._setup=function(c,b,i){if(cc._setupCalled){return;}else{cc._setupCalled=true;}var f=window;var e=cc.$(c)||cc.$("#"+c);var h,a,g;cc.game._setAnimFrame();if(e.tagName=="CANVAS"){b=b||e.width;i=i||e.height;a=cc.container=cc.newElement("DIV");h=cc._canvas=e;h.parentNode.insertBefore(a,h);h.appendTo(a);a.setAttribute("id","Cocos2dGameContainer");}else{if(e.tagName!="DIV"){cc.log("Warning: target element is not a DIV or CANVAS");}b=b||e.clientWidth;i=i||e.clientHeight;a=cc.container=e;h=cc._canvas=cc.$(cc.newElement("CANVAS"));e.appendChild(h);}h.addClass("gameCanvas");h.setAttribute("width",b||480);h.setAttribute("height",i||320);h.setAttribute("tabindex",99);h.style.outline="none";g=a.style;g.width=(b||480)+"px";g.height=(i||320)+"px";g.margin="0 auto";g.position="relative";g.overflow="hidden";a.top="100%";if(cc._renderType==cc._RENDER_TYPE_WEBGL){cc._renderContext=cc.webglContext=cc.create3DContext(h,{"stencil":true,"preserveDrawingBuffer":true,"antialias":!cc.sys.isMobile,"alpha":false});}if(cc._renderContext){f.gl=cc._renderContext;cc._drawingUtil=new cc.DrawingPrimitiveWebGL(cc._renderContext);cc._rendererInitialized=true;cc.textureCache._initializingRenderer();cc.shaderCache._init();}else{cc._renderContext=new cc.CanvasContextWrapper(h.getContext("2d"));cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(cc._renderContext):null;}cc._gameDiv=a;cc.log(cc.ENGINE_VERSION);cc._setContextMenuEnable(false);if(cc.sys.isMobile){var d=cc.newElement("style");d.type="text/css";document.body.appendChild(d);d.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;"+"-webkit-tap-highlight-color:rgba(0,0,0,0);}";}cc.view=cc.EGLView._getInstance();cc.inputManager.registerSystemEvent(cc._canvas);cc.director=cc.Director._getInstance();if(cc.director.setOpenGLView){cc.director.setOpenGLView(cc.view);}cc.winSize=cc.director.getWinSize();cc.saxParser=new cc.SAXParser();cc.plistParser=new cc.PlistParser();};cc._checkWebGLRenderMode=function(){if(cc._renderType!==cc._RENDER_TYPE_WEBGL){throw"This feature supports WebGL render mode only.";}};cc._isContextMenuEnable=false;cc._setContextMenuEnable=function(a){cc._isContextMenuEnable=a;cc._canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable){return false;}};};cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:false,_prepared:false,_paused:true,_intervalId:null,_lastTime:null,_frameTime:null,config:null,onStart:null,onStop:null,setFrameRate:function(c){var a=this,b=a.config,d=a.CONFIG_KEY;b[d.frameRate]=c;if(a._intervalId){window.cancelAnimationFrame(a._intervalId);}a._paused=true;a._setAnimFrame();a._runMainLoop();},_setAnimFrame:function(){this._lastTime=new Date();this._frameTime=1000/cc.game.config[cc.game.CONFIG_KEY.frameRate];if((cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT)||cc.game.config[cc.game.CONFIG_KEY.frameRate]!=60){window.requestAnimFrame=this._stTime;window.cancelAnimationFrame=this._ctTime;}else{window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime;window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime;}},_stTime:function(d){var a=new Date().getTime();var b=Math.max(0,cc.game._frameTime-(a-cc.game._lastTime));var c=window.setTimeout(function(){d();},b);cc.game._lastTime=a+b;return c;},_ctTime:function(a){window.clearTimeout(a);},_runMainLoop:function(){var b=this,e,c=b.config,d=b.CONFIG_KEY,a=cc.director;a.setDisplayStats(c[d.showFPS]);e=function(){if(!b._paused){a.mainLoop();if(b._intervalId){window.cancelAnimationFrame(b._intervalId);}b._intervalId=window.requestAnimFrame(e);}};window.requestAnimFrame(e);b._paused=false;},restart:function(){cc.director.popToSceneStackLevel(0);cc.audioEngine&&cc.audioEngine.end();cc.game.onStart();},run:function(c){var a=this;var b=function(){if(c){a.config[a.CONFIG_KEY.id]=c;}if(!a._prepareCalled){a.prepare(function(){a._prepared=true;});}if(cc._supportRender){a._checkPrepare=setInterval(function(){if(a._prepared){cc._setup(a.config[a.CONFIG_KEY.id]);a._runMainLoop();a._eventHide=a._eventHide||new cc.EventCustom(a.EVENT_HIDE);a._eventHide.setUserData(a);a._eventShow=a._eventShow||new cc.EventCustom(a.EVENT_SHOW);a._eventShow.setUserData(a);a.onStart();clearInterval(a._checkPrepare);}},10);}};document.body?b():cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,false);b();},false);},_initConfig:function(){var n=this,g=n.CONFIG_KEY;var j=function(e){e[g.engineDir]=e[g.engineDir]||"frameworks/cocos2d-html5";if(e[g.debugMode]==null){e[g.debugMode]=0;}e[g.frameRate]=e[g.frameRate]||60;if(e[g.renderMode]==null){e[g.renderMode]=1;}return e;};if(document["ccConfig"]){n.config=j(document["ccConfig"]);}else{try{var k=document.getElementsByTagName("script");for(var d=0;d<k.length;d++){var m=k[d].getAttribute("cocos");if(m==""||m){break;}}var b,f,a;if(d<k.length){b=k[d].src;if(b){a=/(.*)\//.exec(b)[0];cc.loader.resPath=a;b=cc.path.join(a,"project.json");}f=cc.loader._loadTxtSync(b);}if(!f){f=cc.loader._loadTxtSync("project.json");}var c=JSON.parse(f);n.config=j(c||{});}catch(h){cc.log("Failed to read or parse project.json");n.config=j({});}}cc._initSys(n.config,g);},_jsAddedCache:{},_getJsListOfModule:function(k,b,d){var a=this._jsAddedCache;if(a[b]){return null;}d=d||"";var g=[];var j=k[b];if(!j){throw"can not find module ["+b+"]";}var c=cc.path;for(var e=0,m=j.length;e<m;e++){var n=j[e];if(a[n]){continue;}var h=c.extname(n);if(!h){var f=this._getJsListOfModule(k,n,d);if(f){g=g.concat(f);}}else{if(h.toLowerCase()==".js"){g.push(c.join(d,n));}}a[n]=1;}return g;},prepare:function(b){var c=this;var d=c.config,g=c.CONFIG_KEY,e=d[g.engineDir],a=cc.loader;if(!cc._supportRender){throw"The renderer doesn't support the renderMode "+d[g.renderMode];}c._prepareCalled=true;var f=d[g.jsList]||[];if(cc.Class){a.loadJsWithImg("",f,function(i){if(i){throw i;}c._prepared=true;if(b){b();}});}else{var h=cc.path.join(e,"moduleConfig.json");a.loadJson(h,function(q,p){if(q){throw q;}var m=d["modules"]||[];var o=p["module"];var r=[];if(cc._renderType==cc._RENDER_TYPE_WEBGL){m.splice(0,0,"shaders");}else{if(m.indexOf("core")<0){m.splice(0,0,"core");}}for(var n=0,k=m.length;n<k;n++){var j=c._getJsListOfModule(o,m[n],e);if(j){r=r.concat(j);}}r=r.concat(f);cc.loader.loadJsWithImg(r,function(i){if(i){throw i;}c._prepared=true;if(b){b();}});});}}};cc.game._initConfig();Function.prototype.bind=Function.prototype.bind||function(a){if(!cc.isFunction(this)){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)));};b.prototype=this.prototype;c.prototype=new b();return c;};var cc=cc||{};cc._loadingImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAB4CAYAAADIb21fAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MUUwOEE2OENFRDIxMUU0QTdGQUVDNzNBMzFCMzA3RiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3MUUwOEE2OUNFRDIxMUU0QTdGQUVDNzNBMzFCMzA3RiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjcxRTA4QTY2Q0VEMjExRTRBN0ZBRUM3M0EzMUIzMDdGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjcxRTA4QTY3Q0VEMjExRTRBN0ZBRUM3M0EzMUIzMDdGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+QVa+ywAAEKdJREFUeNrsXXtwVNUZ/+7dR567WZJACElIwiM8BBSwlg4qWIqC2orUVqWtDY5ip52qdBxn2ikIWscZx6mx09r6mCnY1sdMZXT8A6SDDUordloBHxBEIBAgISQh72Q3u3t7vt2zcbN7791z955792Zzv5lvFrJn7z3n/s73POd8V5AkCWzKThK+v/p67hc9fdP1hnS29t33k/72xBNrdF93y5Y9iX9aSbiR59jk+p6CfIQfZmi3g3Az/uONvfvHfOG053cS1RD+J+HbCb+VwX5sI/wQQ7vGGLiJJNpYJkn/DvrZQKUnE3QVI7CqZIM7ltYRXkH/XZ2oFvWYG42/3cFjMGrgot05bFEQGqja4kk+et14eoyqaTMJJ9SVPC7kTPEAr6Q3a7AQsPEqC2f4IOE6wjMoEFWEywlPIVxCuIhwAWE3/U2A8ADhHsKdhNsJt06ZN31W+7Gz1XJSNFxWurL9ijozxubjOWmdKsb8yrh/v6VktM2knrpa8J48+7oQCkVd/dLiQ+QjREFkpVzKJXRCQF/fMBBgldqvoJPpOROGuINORi4kKniL8bamiJcNSJNQ4lYTfpzwFwTYObEvpI4u364PLpbovcHvX2tS/d7VN/As+dhP+7A6TgvwJDSDt/G8oMg4e1ZQZ8NM+gbhrYT3Ed7rGvZv8ZxumZ3Y6FDj5+APBNO+yfMf9MJgS5tqG8fgkFB0vg09oi3YF9qnrbSPvJwq7gIkqniLcjc3OjRA23gX4b8R3k14O+Fr8YuSL06DOCIDYiAADa8eT+tmOClaDhxialt0/BTk9A/G/nst7dtu2te7aN/1xLTVRoLrSzF7iliMfZrhAqrWBwjvIvwa4Q3x2qOg4zLktbYr/rj/ZEtEArXSH99tA+fgEHsnCcAyz2QD7fMuOgatZqKGeuVgJLjbGIz5Q9Q28JTU+wi/QfhPhG9M6mAwBKWfHEt5IZRAreq58z+faWqf09Gl9vWNdAxv0DEVME5+w/wZMc6Ys2ZEeHUGTcArhF8ivEqpUfHpFnl1nOj2Ewl8/p0WK4Rqq+iYXmHwU9TMIDdwtcSx1TpjsYWE0fvcSXi9WsO8nl7wnDrLfOGuw8fh0Ek29Rw2fjFsPR3js3TMcjEtD0FpVgN3ZRoZkZVp2tuNhF+koZY3VeO8y9rtaNv5TqZ2A0FTMq9eOtYX6dhBoxlMRc+pgWvWqtAswj8j/FODYsRR6htxgAVpGeElhBcR/gPhQtC/MHAmlQblBq6K1OKSy4OE15rzHC27FuKmUjwn7HLOYfEjUhBeq9sUcBXofsK/IDzXrCdYlhsCK5PvXNtaDsBitizlWrPTIKl1EX6UstdU8XBYd9sQhnVFX5zical6lkZGSG4x4V8SfgRsGkNTjp4ADlK7HRgXcZycpRaX2n5NHSebEsI6tSwbLyfKKMlFYDGN9oANZTKVfnKcx2XqtTQWOUltMZVYG1g5O9V8TlMOW4HeBoUdmUbGDS5qY21VLPdwhv2RFSWd1KNVanmB+6jtPCnT5M9P8LjMtlQxLVdwqUq+n4JrkwzhUmWKlSQWOgJp7mHTI7lraILCa8MoH9OyLFXydqJ0e8uS05EH0ZTiXKs9VKukMFiXKtUoUFHSPFhX0W8quMG83Gnk4xorSkz/SOZzy7gdR8tSpRw5HBJc5WuucXScxgWXzaap5XBOToVV1aFTzLzsTv5cf0xbVTUMjuhYMArZaKbNFawKrjvD4PrOtYGru0/XNQoLQ+DxjIwOifAmkF/wNzwUso1unBPFY2GgsjKa8Ig7O70sLIr3CoIwscENMR4mL3SFud+bx8LA1Kl+cNG+xYMphsP3gsa941kHbiDMNiTedoXHwoDbHYbJk/1KX3uJJP8INOyPzjpwC13m6+VoTMvHiUpBuOnu7olrczPiRLXqXhjw+EKQn8+k0vF0Q4kNrgnEY2FAcApQXu5nbY77ou+YkOCarZR5LAwUVQiQ49TkiK1nsb1ZB64/ZF4I7mm7pHthIOzNg4qiXpXJKjsePLrybVstG+hEFR/VL7XVZb0gSmEVr15KjHljZINrFHmJ1Ore7FblAV8uoyMmJEF1C6Q4H2yDm7bk6gNWcjlgnreN3elK9ibwKMrqieVQjZNqh97pDnCK2jbQh4SkozKqJRyyMEMlWL6PuV5ia/M7eVwKT/ivmEChkPXBrZ42EFGzWouqhgVZuK6bMODmiGFL9w8XBtyuqDoOOrUdeHRKQTnPefmEATfXaV2j63ZLUFwS+AqsUFCTphEoqAlLf+gxL5wQ4FpZKVdVDcV2V4x6wJKgu8e4n22pHQplkAp9YdmFAbUEBrMTKboXE05W49nnUJlDXTWVEWaJT70jvVBz+TAxsinaEilGe4rMuusiTO7gDgdky15kH7gmmlzc5VjAkFsWiSN0zu+B4kBwjKTG+oo44r9Z8CwoDEFe7sgo+GJ0Oi+AaCHT9qwG10zComOsCwfByJN3cXDKwjBrNvG2RRHVMeSE/ThhcH23zhBwKz86pHvHX4wuLL8a/IX5lgeWx4pQWvY1IMLFS3kwrWwQ8sPDMCjmgt+RAyEQsQLtAa4OFR5P5AVsTBpM86yna9t+HczPiz40TitC6VJnuxOGhx0R24wA+wLdUDxyuUbOW27WevGwKyrwuAtB7876JDtGpAH3/kbu49SuWNw57L+549YryFjYVWXHomg1YB5HRfRSa2vumIQGiYGrlMDdrmnm1NVGPnEXghGDxL2/KB3dlVNhxOdh/t2kaUVw9ZJK5vaLykXwLJrD1HaofAoMFXm5HBXhQf39DrjUlRf/p3KlOHcbROstpKSeOTNgJDeH1/FEee+STJgpVO11zp3J/LvVaxZoTmI8cHM1hArymSe0mWYjFbW3uSD01cLSFLUkRj2LzcHYjuPxROW0S2t7ZC8wSkvfjOkp2+cumAULaz2a7zPJHYLZq65hmtCZcqIUzSMB9sLF0a1UJWrgNg5Uqm/BM9vm4F5gnEhdtVWjdl7eB3DBhptmp32fHy7Ng5HKcsUJ3U2+y7QTpUTdnQ7oHsrDHHVSHUnnmVVjFxXyLspvH4nZHK2VVPUQ7gXGPcGRbND82VB6RF5bVNxwDdT60s9euEQJrlt1FRzc2ZqciZo3izh2Dig90ZxxJ0qJWvzF0FPiTNoNKWLH49jVUzdD1jtunx+VjJKmk6Z2PFZ+vm/qZPCXFid9HyorhfuW6z/cf/MsCYILxp4lx/sNlE6yjBOlpFlaZ82DE56ZbjW1HBVz4qEmPkQEHMHnHdOyUuy866UrxqpeiUy679y2lMuxTXTE1iwbGyr2VEfjYI/+4mCGEWqWYXcuSP1BIRW4kcXGvoqyMX/sJVKDlE9UdiYIJxRKDzo1aB5iNOLzwtRJ/Cr8Hjs8NuSfdDL6/56qclWbnymKaRbMN0z68oyUCtwBdBx8J8YOEh0orWEJT0JvGVOSiSfp3Je6YPdnHVzucehsAM7/tylpUmFCBSeVnLnKqKdMJltMk0VOPUgQSgVuDwKZeKgJ7U0sLImXHLMGgd6y0km6c42H4Ui7vixqMCzA39/8mGtCxYwJPzbfICWDm9vbD3E8pOQ4xB4sOlZmqqiORfMi9l7pJJ04MARv7muCsJT+joaX97WB2NWtmFApPXGa2vw5lgAWJ1livkEISyNJfS//8GOI8eRPm6rUwhJ0qPBB4wM3g1BLxLxVtZN00tFT0NiUnqN3rEOAcwfVX0FTcPZCRHOhaWBJqBhNMfM4Jt8gSQE1tbzN2T/oZQlL8IHLhSW81XEs/GKpDrN/7ycwHNKmnrH9X975DITACFNCJeKdpkioGE0D06fJ5riFcFgRXIwBWN6PPppbRWNu5CAxaaEl/Ap39MLLu09rusdf/9cLjlNs7yLKhOaSm/Ads2tlJzwB168E7g5gfA1KbEnOSA8StQImLbQuKV786Bh0dLAVXMP3Cp384IimfsX6YobmUpvwcuWQhFB4WA7claDxrVT5FzsUEx48XXxPGifpTnzJFhrhe4WcGhMy8X0xWnOpTXi5ckhCKDScMkOl2bjP4Su9qA1QK1idsI9mOlex56z0NlIhGBpMMiW6ZxTxINuXLiQGfkC/1DqdEW0wXoh1eysvUiuHRGzuCHdwYzYI2SbjKJ1ySPaJg3FC6ZRDssEdB5RuOSQb3HFA6ZZDssG1OOnZt2WDa3EnSs++LRtcC5PejYh2eUCLEo+NiHZ5QIsSj42Itlq2qNTy2IiYdeAGw4I9O7IV3IANrg2uDe44pOGgDWoWSy5bOyNePWODazCd6WeLdAVbcscf9fgDtj7OVnDzXXb1pawFt8DpsFHVCa5lU7i5TjsU0gWu6Peft6xatrWyPnCdQ8MXyMduS0quQ7JR1QOuEAzhTq3fEW6y2oBctlbm4lDtIfxbwr2WAjcLXERBgsGMglv77vv48RLhpy0FbhaoZdfg0GtWCYUQ3GdsyeVGz/iaTr5uFXDxGMNThJ+3hp0Z15KLz/ApcSQYzDi4VDUj4d7L3xB+IdNPxz1+1fIL9Bl28Zvo/AjLr23PtAQL41di8dm1xglM5sFN6AwCvMVKNng82Fj6zFp5X9iIfA6qlV8RxvIwjxL22vjJUi91Rp+mfgvwlFpualmmU9jZJwk/YnaiY5xkqJros3kyBqwRZHQmFuNgrCjyIOG1trBGCNO2mN3bk0JAuEhut0HSG6M9FNwGoLUlJygF6DN4MBFY48JCgMOEd2r83TaN7b8kvJnwTwgfZP0RFrHWVFTE7YYlGt5xECrIMwvYg3Tsm+mzSCUY6Qhct5LNxRpUPYwXeZtwY5qD/DPhTXQGp8xJY1mervnsFdBvuGUR5LjZJ8P81Us1db5He3GXXjrWTXTsrJSOwDUogdsNbEXGcALUp6Ga4+lTOoN/THhXqsZKRbQTyVVRBt9cUqrpady52AMwvZypbawcvgbaRce4mY5ZK2kRuJ1yAhfvLe8gvJ/hht2cVNVbhO8hfD/hfWoNE4toJ5LkcsE931uouQNY/n7d2kVM7xaKlcNnoH10TPfQMaZL3Yzmr0dJMBNDoXqVi+ynE4AnYX2jl1GIqE3aK9coUq1ORSVOXbYQakrSc/yXVgowefFc1TaxAqMpaC8dw510TAMcng+q2lRl7rYpCVwiuM2g/AKpegMdjk6I5lbXE76b8KuJKgnrPcnVO5aKi2DTt8p03fzntxInrLBA3u4Thy72TiEFqXmV9nk9HUMnpygjXluqCVyDliQGzoTEF0hthzReC5emJONy1w9oXPwYxL18UK5S+223L9H9jgOHIMHtdyyWt/m0aHUCHaB9W0v7+jonSZWjRhXn6uF0MlTxUnomjdCHB31I+HHCqwjfSPiJoSLve30zqkaXw2qXz4Wv1fApJbhkZiGU1lUlOVG0QhxuK3oP+0D7sor27UODcgMsztVz1KvWDG78bKk3qMNagv9/EN6KD3WwtHiFJIpDYp67b921Vf/SqgbV6N51M8fE1d11tejxbiT8dQroVtoXs5Mxic5VD4vAOVPMlmYdMa1R9G8hHN4QHgp0077hSxfwxcDocdUQRvErp3/HV6BhqWE0qO64yTJAHxBODCymiCsyLR5PbnNBsXfl0MWujTSe/66Fxo22dR1EK+zWs0QtTg6ueCYoPsRop3yA07VfQS2Nk7v08FHou+l6K437YQoyU4glSJK9zzdb6f8CDABVcb30LGbtdAAAAABJRU5ErkJggg==";cc._loaderImage=cc._loadingImage;cc._fpsImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII=";cc.loader.loadBinary=function(c,a){var b=this;var e=this.getXMLHttpRequest(),d="load "+c+" failed!";e.open("GET",c,true);if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){e.setRequestHeader("Accept-Charset","x-user-defined");e.onreadystatechange=function(){if(e.readyState==4&&e.status==200){var f=cc._convertResponseBodyToText(e["responseBody"]);a(null,b._str2Uint8Array(f));}else{a(d);}};}else{if(e.overrideMimeType){e.overrideMimeType("text/plain; charset=x-user-defined");}e.onload=function(){e.readyState==4&&e.status==200?a(null,b._str2Uint8Array(e.responseText)):a(d);};}e.send(null);};cc.loader._str2Uint8Array=function(c){if(!c){return null;}var a=new Uint8Array(c.length);for(var b=0;b<c.length;b++){a[b]=c.charCodeAt(b)&255;}return a;};cc.loader.loadBinarySync=function(c){var b=this;var f=this.getXMLHttpRequest();var e="load "+c+" failed!";f.open("GET",c,false);var a=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){f.setRequestHeader("Accept-Charset","x-user-defined");f.send(null);if(f.status!=200){cc.log(e);return null;}var d=cc._convertResponseBodyToText(f["responseBody"]);if(d){a=b._str2Uint8Array(d);}}else{if(f.overrideMimeType){f.overrideMimeType("text/plain; charset=x-user-defined");}f.send(null);if(f.status!=200){cc.log(e);return null;}a=this._str2Uint8Array(f.responseText);}return a;};var Uint8Array=Uint8Array||Array;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var IEBinaryToArray_ByteStr_Script="<!-- IEBinaryToArray_ByteStr -->\r\n"+"Function IEBinaryToArray_ByteStr(Binary)\r\n"+"   IEBinaryToArray_ByteStr = CStr(Binary)\r\n"+"End Function\r\n"+"Function IEBinaryToArray_ByteStr_Last(Binary)\r\n"+"   Dim lastIndex\r\n"+"   lastIndex = LenB(Binary)\r\n"+"   if lastIndex mod 2 Then\r\n"+"       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n"+"   Else\r\n"+"       IEBinaryToArray_ByteStr_Last = "+'""'+"\r\n"+"   End If\r\n"+"End Function\r\n";var myVBScript=cc.newElement("script");myVBScript.type="text/vbscript";myVBScript.textContent=IEBinaryToArray_ByteStr_Script;document.body.appendChild(myVBScript);cc._convertResponseBodyToText=function(f){var a={};for(var e=0;e<256;e++){for(var d=0;d<256;d++){a[String.fromCharCode(e+d*256)]=String.fromCharCode(e)+String.fromCharCode(d);}}var b=IEBinaryToArray_ByteStr(f);var c=IEBinaryToArray_ByteStr_Last(f);return b.replace(/[\s\S]/g,function(g){return a[g];})+c;};}var cc=cc||{};var ClassManager={id:(0|(Math.random()*998)),instanceId:(0|(Math.random()*998)),compileSuper:function(h,b,d){var n=h.toString();var k=n.indexOf("("),e=n.indexOf(")");var j=n.substring(k+1,e);j=j.trim();var g=n.indexOf("{"),o=n.lastIndexOf("}");var n=n.substring(g+1,o);while(n.indexOf("this._super")!=-1){var c=n.indexOf("this._super");var a=n.indexOf("(",c);var i=n.indexOf(")",a);var m=n.substring(a+1,i);m=m.trim();var f=m?",":"";n=n.substring(0,c)+"ClassManager["+d+"]."+b+".call(this"+f+n.substring(a+1);}return Function(j,n);},getNewID:function(){return this.id++;},getNewInstanceId:function(){return this.instanceId++;}};ClassManager.compileSuper.ClassManager=ClassManager;(function(){var c=/\b_super\b/;var b=cc.game.config;var a=b[cc.game.CONFIG_KEY.classReleaseMode];if(a){console.log("release Mode");}cc.Class=function(){};cc.Class.extend=function(q){var v=this.prototype;var r=Object.create(v);var p=ClassManager.getNewID();ClassManager[p]=v;var n={writable:true,enumerable:false,configurable:true};r.__instanceId=null;function g(){this.__instanceId=ClassManager.getNewInstanceId();if(this.ctor){this.ctor.apply(this,arguments);}}g.id=p;n.value=p;Object.defineProperty(r,"__pid",n);g.prototype=r;n.value=g;Object.defineProperty(g.prototype,"constructor",n);this.__getters__&&(g.__getters__=cc.clone(this.__getters__));this.__setters__&&(g.__setters__=cc.clone(this.__setters__));for(var t=0,u=arguments.length;t<u;++t){var f=arguments[t];for(var e in f){var s=(typeof f[e]==="function");var h=(typeof v[e]==="function");var d=c.test(f[e]);if(a&&s&&h&&d){n.value=ClassManager.compileSuper(f[e],e,p);Object.defineProperty(r,e,n);}else{if(s&&h&&d){n.value=(function(i,w){return function(){var y=this._super;this._super=v[i];var x=w.apply(this,arguments);this._super=y;return x;};})(e,f[e]);Object.defineProperty(r,e,n);}else{if(s){n.value=f[e];Object.defineProperty(r,e,n);}else{r[e]=f[e];}}}if(s){var o,j,m;if(this.__getters__&&this.__getters__[e]){m=this.__getters__[e];for(var k in this.__setters__){if(this.__setters__[k]==m){j=k;break;}}cc.defineGetterSetter(r,m,f[e],f[j]?f[j]:r[j],e,j);}if(this.__setters__&&this.__setters__[e]){m=this.__setters__[e];for(var k in this.__getters__){if(this.__getters__[k]==m){o=k;break;}}cc.defineGetterSetter(r,m,f[o]?f[o]:r[o],f[e],o,e);}}}}g.extend=cc.Class.extend;g.implement=function(w){for(var i in w){r[i]=w[i];}};return g;};})();cc.defineGetterSetter=function(h,b,m,d,o,g){if(h.__defineGetter__){m&&h.__defineGetter__(b,m);d&&h.__defineSetter__(b,d);}else{if(Object.defineProperty){var j={enumerable:false,configurable:true};m&&(j.get=m);d&&(j.set=d);Object.defineProperty(h,b,j);}else{throw new Error("browser does not support getters");}}if(!o&&!g){var n=(m!=null),e=(d!=undefined),k=Object.getOwnPropertyNames(h);for(var f=0;f<k.length;f++){var a=k[f];if((h.__lookupGetter__?h.__lookupGetter__(a):Object.getOwnPropertyDescriptor(h,a))||typeof h[a]!=="function"){continue;}var c=h[a];if(n&&c===m){o=a;if(!e||g){break;}}if(e&&c===d){g=a;if(!n||o){break;}}}}var p=h.constructor;if(o){if(!p.__getters__){p.__getters__={};}p.__getters__[o]=b;}if(g){if(!p.__setters__){p.__setters__={};}p.__setters__[g]=b;}};cc.clone=function(c){var a=(c.constructor)?new c.constructor:{};for(var b in c){var d=c[b];if(((typeof d)=="object")&&d&&!(d instanceof cc.Node)&&!(d instanceof HTMLElement)){a[b]=cc.clone(d);}else{a[b]=d;}}return a;};cc.inject=function(a,c){for(var b in a){c[b]=a[b];}};cc.Point=function(a,b){this.x=a||0;this.y=b||0;};cc.p=function(a,b){if(a==undefined){return{x:0,y:0};}if(b==undefined){return{x:a.x,y:a.y};}return{x:a,y:b};};cc.pointEqualToPoint=function(b,a){return b&&a&&(b.x===a.x)&&(b.y===a.y);};cc.Size=function(b,a){this.width=b||0;this.height=a||0;};cc.size=function(a,b){if(a===undefined){return{width:0,height:0};}if(b===undefined){return{width:a.width,height:a.height};}return{width:a,height:b};};cc.sizeEqualToSize=function(b,a){return(b&&a&&(b.width==a.width)&&(b.height==a.height));};cc.Rect=function(b,d,c,a){this.x=b||0;this.y=d||0;this.width=c||0;this.height=a||0;};cc.rect=function(a,d,b,c){if(a===undefined){return{x:0,y:0,width:0,height:0};}if(d===undefined){return{x:a.x,y:a.y,width:a.width,height:a.height};}return{x:a,y:d,width:b,height:c};};cc.rectEqualToRect=function(b,a){return b&&a&&(b.x===a.x)&&(b.y===a.y)&&(b.width===a.width)&&(b.height===a.height);};cc._rectEqualToZero=function(a){return a&&(a.x===0)&&(a.y===0)&&(a.width===0)&&(a.height===0);};cc.rectContainsRect=function(b,a){if(!b||!a){return false;}return !((b.x>=a.x)||(b.y>=a.y)||(b.x+b.width<=a.x+a.width)||(b.y+b.height<=a.y+a.height));};cc.rectGetMaxX=function(a){return(a.x+a.width);};cc.rectGetMidX=function(a){return(a.x+a.width/2);};cc.rectGetMinX=function(a){return a.x;};cc.rectGetMaxY=function(a){return(a.y+a.height);};cc.rectGetMidY=function(a){return a.y+a.height/2;};cc.rectGetMinY=function(a){return a.y;};cc.rectContainsPoint=function(b,a){return(a.x>=cc.rectGetMinX(b)&&a.x<=cc.rectGetMaxX(b)&&a.y>=cc.rectGetMinY(b)&&a.y<=cc.rectGetMaxY(b));};cc.rectIntersectsRect=function(e,d){var a=e.x+e.width,f=e.y+e.height,c=d.x+d.width,b=d.y+d.height;return !(a<d.x||c<e.x||f<d.y||b<e.y);};cc.rectOverlapsRect=function(b,a){return !((b.x+b.width<a.x)||(a.x+a.width<b.x)||(b.y+b.height<a.y)||(a.y+a.height<b.y));};cc.rectUnion=function(c,b){var a=cc.rect(0,0,0,0);a.x=Math.min(c.x,b.x);a.y=Math.min(c.y,b.y);a.width=Math.max(c.x+c.width,b.x+b.width)-a.x;a.height=Math.max(c.y+c.height,b.y+b.height)-a.y;return a;};cc.rectIntersection=function(b,a){var c=cc.rect(Math.max(cc.rectGetMinX(b),cc.rectGetMinX(a)),Math.max(cc.rectGetMinY(b),cc.rectGetMinY(a)),0,0);c.width=Math.min(cc.rectGetMaxX(b),cc.rectGetMaxX(a))-cc.rectGetMinX(c);c.height=Math.min(cc.rectGetMaxY(b),cc.rectGetMaxY(a))-cc.rectGetMinY(c);return c;};cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){if(window.DOMParser){this._isSupportDOMParser=true;this._parser=new DOMParser();}else{this._isSupportDOMParser=false;}},parse:function(a){return this._parseXML(a);},_parseXML:function(b){var a;if(this._isSupportDOMParser){a=this._parser.parseFromString(b,"text/xml");}else{a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b);}return a;}});cc.PlistParser=cc.SAXParser.extend({parse:function(f){var d=this._parseXML(f);var e=d.documentElement;if(e.tagName!="plist"){throw"Not a plist file!";}var c=null;for(var b=0,a=e.childNodes.length;b<a;b++){c=e.childNodes[b];if(c.nodeType==1){break;}}d=null;return this._parseNode(c);},_parseNode:function(c){var d=null,b=c.tagName;if(b=="dict"){d=this._parseDict(c);}else{if(b=="array"){d=this._parseArray(c);}else{if(b=="string"){if(c.childNodes.length==1){d=c.firstChild.nodeValue;}else{d="";for(var a=0;a<c.childNodes.length;a++){d+=c.childNodes[a].nodeValue;}}}else{if(b=="false"){d=false;}else{if(b=="true"){d=true;}else{if(b=="real"){d=parseFloat(c.firstChild.nodeValue);}else{if(b=="integer"){d=parseInt(c.firstChild.nodeValue,10);}}}}}}}return d;},_parseArray:function(c){var d=[];for(var b=0,a=c.childNodes.length;b<a;b++){var e=c.childNodes[b];if(e.nodeType!=1){continue;}d.push(this._parseNode(e));}return d;},_parseDict:function(d){var e={};var c=null;for(var b=0,a=d.childNodes.length;b<a;b++){var f=d.childNodes[b];if(f.nodeType!=1){continue;}if(f.tagName=="key"){c=f.firstChild.nodeValue;}else{e[c]=this._parseNode(f);}}return e;}});cc._txtLoader={load:function(d,b,c,a){cc.loader.loadTxt(d,a);}};cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader);cc._jsonLoader={load:function(d,b,c,a){cc.loader.loadJson(d,a);}};cc.loader.register(["json","ExportJson"],cc._jsonLoader);cc._jsLoader={load:function(d,b,c,a){cc.loader.loadJs(d,a);}};cc.loader.register(["js"],cc._jsLoader);cc._imgLoader={load:function(d,b,c,a){cc.loader.cache[b]=cc.loader.loadImg(d,function(f,e){if(f){return a(f);}cc.textureCache.handleLoadedTexture(b);a(null,e);});}};cc.loader.register(["png","jpg","bmp","jpeg","gif","ico"],cc._imgLoader);cc._serverImgLoader={load:function(d,b,c,a){cc.loader.cache[b]=cc.loader.loadImg(c.src,function(f,e){if(f){return a(f);}cc.textureCache.handleLoadedTexture(b);a(null,e);});}};cc.loader.register(["serverImg"],cc._serverImgLoader);cc._plistLoader={load:function(d,b,c,a){cc.loader.loadTxt(d,function(f,e){if(f){return a(f);}a(null,cc.plistParser.parse(e));});}};cc.loader.register(["plist"],cc._plistLoader);cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(b,f,k){var m=document,o=cc.path,j=this.TYPE,g=cc.newElement("style");g.type="text/css";m.body.appendChild(g);var d="@font-face { font-family:"+b+"; src:";if(f instanceof Array){for(var h=0,n=f.length;h<n;h++){var a=f[h];k=o.extname(a).toLowerCase();d+="url('"+f[h]+"') format('"+j[k]+"')";d+=(h==n-1)?";":",";}}else{d+="url('"+f+"') format('"+j[k]+"');";}g.textContent+=d+"};";var e=cc.newElement("div");var c=e.style;c.fontFamily=b;e.innerHTML=".";c.position="absolute";c.left="-100px";c.top="-100px";m.body.appendChild(e);},load:function(h,d,e,a){var b=this;var f=e.type,c=e.name,g=e.srcs;if(cc.isString(e)){f=cc.path.extname(e);c=cc.path.basename(e,f);b._loadFont(c,e,f);}else{b._loadFont(c,g);}a(null,true);}};cc.loader.register(["font","eot","ttf","woff","svg"],cc._fontLoader);cc._binaryLoader={load:function(d,b,c,a){cc.loader.loadBinary(d,a);}};cc._csbLoader={load:function(d,b,c,a){cc.loader.loadCsb(d,a);}};cc.loader.register(["csb"],cc._csbLoader);window["CocosEngine"]=cc.ENGINE_VERSION="Cocos2d-JS v3.3";cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0;cc.DIRECTOR_STATS_POSITION=cc.p(0,0);cc.DIRECTOR_FPS_INTERVAL=0.5;cc.COCOSNODE_RENDER_SUBPIXEL=1;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1;cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=0;cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0;cc.TEXTURE_ATLAS_USE_VAO=0;cc.TEXTURE_NPOT_SUPPORT=0;cc.RETINA_DISPLAY_SUPPORT=1;cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd";cc.USE_LA88_LABELS=1;cc.SPRITE_DEBUG_DRAW=0;cc.SPRITEBATCHNODE_DEBUG_DRAW=0;cc.LABELBMFONT_DEBUG_DRAW=0;cc.LABELATLAS_DEBUG_DRAW=0;cc.IS_RETINA_DISPLAY_SUPPORTED=1;cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas";cc.ENABLE_STACKABLE_ACTIONS=1;cc.ENABLE_GL_STATE_CACHE=1;cc.$=function(a){var c=(this==cc)?document:this;var b=(a instanceof HTMLElement)?a:c.querySelector(a);if(b){b.find=b.find||cc.$;b.hasClass=b.hasClass||function(d){return this.className.match(new RegExp("(\\s|^)"+d+"(\\s|$)"));};b.addClass=b.addClass||function(d){if(!this.hasClass(d)){if(this.className){this.className+=" ";}this.className+=d;}return this;};b.removeClass=b.removeClass||function(d){if(this.hasClass(d)){this.className=this.className.replace(d,"");}return this;};b.remove=b.remove||function(){if(this.parentNode){this.parentNode.removeChild(this);}return this;};b.appendTo=b.appendTo||function(d){d.appendChild(this);return this;};b.prependTo=b.prependTo||function(d){(d.childNodes[0])?d.insertBefore(this,d.childNodes[0]):d.appendChild(this);return this;};b.transforms=b.transforms||function(){this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew);return this;};b.position=b.position||{x:0,y:0};b.rotation=b.rotation||0;b.scale=b.scale||{x:1,y:1};b.skew=b.skew||{x:0,y:0};b.translates=function(d,e){this.position.x=d;this.position.y=e;this.transforms();return this;};b.rotate=function(d){this.rotation=d;this.transforms();return this;};b.resize=function(d,e){this.scale.x=d;this.scale.y=e;this.transforms();return this;};b.setSkew=function(d,e){this.skew.x=d;this.skew.y=e;this.transforms();return this;};}return b;};switch(cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz";cc.$.hd=true;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit";cc.$.hd=true;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O";cc.$.hd=false;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms";cc.$.hd=false;break;default:cc.$.pfx="webkit";cc.$.hd=true;}cc.$.trans=cc.$.pfx+"Transform";cc.$.translate=(cc.$.hd)?function(b){return"translate3d("+b.x+"px, "+b.y+"px, 0) ";}:function(b){return"translate("+b.x+"px, "+b.y+"px) ";};cc.$.rotate=(cc.$.hd)?function(b){return"rotateZ("+b+"deg) ";}:function(b){return"rotate("+b+"deg) ";};cc.$.scale=function(b){return"scale("+b.x+", "+b.y+") ";};cc.$.skew=function(b){return"skewX("+-b.x+"deg) skewY("+b.y+"deg)";};cc.$new=function(a){return cc.$(document.createElement(a));};cc.$.findpos=function(b){var c=0;var a=0;do{c+=b.offsetLeft;a+=b.offsetTop;}while(b=b.offsetParent);return{x:c,y:a};};cc.INVALID_INDEX=-1;cc.PI=Math.PI;cc.FLT_MAX=parseFloat("3.402823466e+38F");cc.FLT_MIN=parseFloat("1.175494351e-38F");cc.RAD=cc.PI/180;cc.DEG=180/cc.PI;cc.UINT_MAX=4294967295;cc.swap=function(a,d,c){if(cc.isObject(c)&&!cc.isUndefined(c.x)&&!cc.isUndefined(c.y)){var b=c[a];c[a]=c[d];c[d]=b;}else{cc.log(cc._LogInfos.swap);}};cc.lerp=function(d,c,e){return d+(c-d)*e;};cc.rand=function(){return Math.random()*16777215;};cc.randomMinus1To1=function(){return(Math.random()-0.5)*2;};cc.random0To1=Math.random;cc.degreesToRadians=function(a){return a*cc.RAD;};cc.radiansToDegrees=function(a){return a*cc.DEG;};cc.radiansToDegress=function(a){cc.log(cc._LogInfos.radiansToDegress);return a*cc.DEG;};cc.REPEAT_FOREVER=Number.MAX_VALUE-1;cc.BLEND_SRC=cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?1:770;cc.BLEND_DST=771;cc.nodeDrawSetup=function(a){if(a._shaderProgram){a._shaderProgram.use();a._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4();}};cc.enableDefaultGLStates=function(){};cc.disableDefaultGLStates=function(){};cc.incrementGLDraws=function(a){cc.g_NumberOfDraws+=a;};cc.FLT_EPSILON=1.192092896e-7;cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor();}:function(){return 1;};cc.pointPointsToPixels=function(a){var b=cc.contentScaleFactor();return cc.p(a.x*b,a.y*b);};cc.pointPixelsToPoints=function(b){var a=cc.contentScaleFactor();return cc.p(b.x/a,b.y/a);};cc._pointPixelsToPointsOut=function(c,a){var b=cc.contentScaleFactor();a.x=c.x/b;a.y=c.y/b;};cc.sizePointsToPixels=function(a){var b=cc.contentScaleFactor();return cc.size(a.width*b,a.height*b);};cc.sizePixelsToPoints=function(a){var b=cc.contentScaleFactor();return cc.size(a.width/b,a.height/b);};cc._sizePixelsToPointsOut=function(a,b){var c=cc.contentScaleFactor();b.width=a.width/c;b.height=a.height/c;};cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var b=cc.contentScaleFactor();return cc.rect(a.x/b,a.y/b,a.width/b,a.height/b);}:function(a){return a;};cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var b=cc.contentScaleFactor();return cc.rect(a.x*b,a.y*b,a.width*b,a.height*b);}:function(a){return a;};cc.ONE=1;cc.ZERO=0;cc.SRC_ALPHA=770;cc.SRC_ALPHA_SATURATE=776;cc.SRC_COLOR=768;cc.DST_ALPHA=772;cc.DST_COLOR=774;cc.ONE_MINUS_SRC_ALPHA=771;cc.ONE_MINUS_SRC_COLOR=769;cc.ONE_MINUS_DST_ALPHA=773;cc.ONE_MINUS_DST_COLOR=775;cc.ONE_MINUS_CONSTANT_ALPHA=32772;cc.ONE_MINUS_CONSTANT_COLOR=32770;cc.LINEAR=9729;cc.REPEAT=10497;cc.CLAMP_TO_EDGE=33071;cc.MIRRORED_REPEAT=33648;cc.checkGLErrorDebug=function(){if(cc.renderMode==cc._RENDER_TYPE_WEBGL){var a=cc._renderContext.getError();if(a){cc.log(cc._LogInfos.checkGLErrorDebug,a);}}};cc.DEVICE_ORIENTATION_PORTRAIT=0;cc.DEVICE_ORIENTATION_LANDSCAPE_LEFT=1;cc.DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2;cc.DEVICE_ORIENTATION_LANDSCAPE_RIGHT=3;cc.DEVICE_MAX_ORIENTATIONS=2;cc.VERTEX_ATTRIB_FLAG_NONE=0;cc.VERTEX_ATTRIB_FLAG_POSITION=1<<0;cc.VERTEX_ATTRIB_FLAG_COLOR=1<<1;cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=1<<2;cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);cc.GL_ALL=0;cc.VERTEX_ATTRIB_POSITION=0;cc.VERTEX_ATTRIB_COLOR=1;cc.VERTEX_ATTRIB_TEX_COORDS=2;cc.VERTEX_ATTRIB_MAX=3;cc.UNIFORM_PMATRIX=0;cc.UNIFORM_MVMATRIX=1;cc.UNIFORM_MVPMATRIX=2;cc.UNIFORM_TIME=3;cc.UNIFORM_SINTIME=4;cc.UNIFORM_COSTIME=5;cc.UNIFORM_RANDOM01=6;cc.UNIFORM_SAMPLER=7;cc.UNIFORM_MAX=8;cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor";cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest";cc.SHADER_POSITION_COLOR="ShaderPositionColor";cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture";cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor";cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color";cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor";cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor";cc.UNIFORM_PMATRIX_S="CC_PMatrix";cc.UNIFORM_MVMATRIX_S="CC_MVMatrix";cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix";cc.UNIFORM_TIME_S="CC_Time";cc.UNIFORM_SINTIME_S="CC_SinTime";cc.UNIFORM_COSTIME_S="CC_CosTime";cc.UNIFORM_RANDOM01_S="CC_Random01";cc.UNIFORM_SAMPLER_S="CC_Texture0";cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value";cc.ATTRIBUTE_NAME_COLOR="a_color";cc.ATTRIBUTE_NAME_POSITION="a_position";cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord";cc.ITEM_SIZE=32;cc.CURRENT_ITEM=3233828865;cc.ZOOM_ACTION_TAG=3233828866;cc.NORMAL_TAG=8801;cc.SELECTED_TAG=8802;cc.DISABLE_TAG=8803;cc.arrayVerifyType=function(a,c){if(a&&a.length>0){for(var b=0;b<a.length;b++){if(!(a[b] instanceof c)){cc.log("element type is wrong!");return false;}}}return true;};cc.arrayRemoveObject=function(a,c){for(var d=0,b=a.length;d<b;d++){if(a[d]==c){a.splice(d,1);break;}}};cc.arrayRemoveArray=function(a,d){for(var c=0,b=d.length;c<b;c++){cc.arrayRemoveObject(a,d[c]);}};cc.arrayAppendObjectsToIndex=function(a,b,c){a.splice.apply(a,[c,0].concat(b));return a;};cc.copyArray=function(b){var c,a=b.length,d=new Array(a);for(c=0;c<a;c+=1){d[c]=b[c];}return d;};cc._tmp.PrototypeColor=function(){var a=cc.color;a._getWhite=function(){return a(255,255,255);};a._getYellow=function(){return a(255,255,0);};a._getBlue=function(){return a(0,0,255);};a._getGreen=function(){return a(0,255,0);};a._getRed=function(){return a(255,0,0);};a._getMagenta=function(){return a(255,0,255);};a._getBlack=function(){return a(0,0,0);};a._getOrange=function(){return a(255,127,0);};a._getGray=function(){return a(166,166,166);};a.WHITE;cc.defineGetterSetter(a,"WHITE",a._getWhite);a.YELLOW;cc.defineGetterSetter(a,"YELLOW",a._getYellow);a.BLUE;cc.defineGetterSetter(a,"BLUE",a._getBlue);a.GREEN;cc.defineGetterSetter(a,"GREEN",a._getGreen);a.RED;cc.defineGetterSetter(a,"RED",a._getRed);a.MAGENTA;cc.defineGetterSetter(a,"MAGENTA",a._getMagenta);a.BLACK;cc.defineGetterSetter(a,"BLACK",a._getBlack);a.ORANGE;cc.defineGetterSetter(a,"ORANGE",a._getOrange);a.GRAY;cc.defineGetterSetter(a,"GRAY",a._getGray);cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO);};cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA);};cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA);};cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE);};cc.BlendFunc.DISABLE;cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable);cc.BlendFunc.ALPHA_PREMULTIPLIED;cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied);cc.BlendFunc.ALPHA_NON_PREMULTIPLIED;cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied);cc.BlendFunc.ADDITIVE;cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive);};var cc=cc||{};cc._tmp=cc._tmp||{};cc._tmp.WebGLColor=function(){cc.color=function(i,h,c,d,f,j){if(i===undefined){return new cc.Color(0,0,0,255,f,j);}if(cc.isString(i)){var e=cc.hexToColor(i);return new cc.Color(e.r,e.g,e.b,e.a);}if(cc.isObject(i)){return new cc.Color(i.r,i.g,i.b,i.a,i.arrayBuffer,i.offset);}return new cc.Color(i,h,c,d,f,j);};cc.Color=function(d,h,k,m,i,f){this._arrayBuffer=i||new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT);this._offset=f||0;var j=this._arrayBuffer,e=this._offset,c=Uint8Array.BYTES_PER_ELEMENT;this._rU8=new Uint8Array(j,e,1);this._gU8=new Uint8Array(j,e+c,1);this._bU8=new Uint8Array(j,e+c*2,1);this._aU8=new Uint8Array(j,e+c*3,1);this._rU8[0]=d||0;this._gU8[0]=h||0;this._bU8[0]=k||0;this._aU8[0]=(m==null)?255:m;if(m===undefined){this.a_undefined=true;}};cc.Color.BYTES_PER_ELEMENT=4;var a=cc.Color.prototype;a._getR=function(){return this._rU8[0];};a._setR=function(b){this._rU8[0]=b<0?0:b;};a._getG=function(){return this._gU8[0];};a._setG=function(b){this._gU8[0]=b<0?0:b;};a._getB=function(){return this._bU8[0];};a._setB=function(b){this._bU8[0]=b<0?0:b;};a._getA=function(){return this._aU8[0];};a._setA=function(b){this._aU8[0]=b<0?0:b;};a.r;cc.defineGetterSetter(a,"r",a._getR,a._setR);a.g;cc.defineGetterSetter(a,"g",a._getG,a._setG);a.b;cc.defineGetterSetter(a,"b",a._getB,a._setB);a.a;cc.defineGetterSetter(a,"a",a._getA,a._setA);cc.Vertex2F=function(b,e,c,d){this._arrayBuffer=c||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT);this._offset=d||0;this._xF32=new Float32Array(this._arrayBuffer,this._offset,1);this._yF32=new Float32Array(this._arrayBuffer,this._offset+4,1);this._xF32[0]=b||0;this._yF32[0]=e||0;};cc.Vertex2F.BYTES_PER_ELEMENT=8;Object.defineProperties(cc.Vertex2F.prototype,{x:{get:function(){return this._xF32[0];},set:function(b){this._xF32[0]=b;},enumerable:true},y:{get:function(){return this._yF32[0];},set:function(b){this._yF32[0]=b;},enumerable:true}});cc.Vertex3F=function(b,h,g,d,f){this._arrayBuffer=d||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT);this._offset=f||0;var c=this._arrayBuffer,e=this._offset;this._xF32=new Float32Array(c,e,1);this._xF32[0]=b||0;this._yF32=new Float32Array(c,e+Float32Array.BYTES_PER_ELEMENT,1);this._yF32[0]=h||0;this._zF32=new Float32Array(c,e+Float32Array.BYTES_PER_ELEMENT*2,1);this._zF32[0]=g||0;};cc.Vertex3F.BYTES_PER_ELEMENT=12;Object.defineProperties(cc.Vertex3F.prototype,{x:{get:function(){return this._xF32[0];},set:function(b){this._xF32[0]=b;},enumerable:true},y:{get:function(){return this._yF32[0];},set:function(b){this._yF32[0]=b;},enumerable:true},z:{get:function(){return this._zF32[0];},set:function(b){this._zF32[0]=b;},enumerable:true}});cc.Tex2F=function(c,b,d,e){this._arrayBuffer=d||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT);this._offset=e||0;this._uF32=new Float32Array(this._arrayBuffer,this._offset,1);this._vF32=new Float32Array(this._arrayBuffer,this._offset+4,1);this._uF32[0]=c||0;this._vF32[0]=b||0;};cc.Tex2F.BYTES_PER_ELEMENT=8;Object.defineProperties(cc.Tex2F.prototype,{u:{get:function(){return this._uF32[0];},set:function(b){this._uF32[0]=b;},enumerable:true},v:{get:function(){return this._vF32[0];},set:function(b){this._vF32[0]=b;},enumerable:true}});cc.Quad2=function(c,g,i,d,e,h){this._arrayBuffer=e||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT);this._offset=h||0;var b=this._arrayBuffer,f=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=c?new cc.Vertex2F(c.x,c.y,b,0):new cc.Vertex2F(0,0,b,0);this._tr=g?new cc.Vertex2F(g.x,g.y,b,f):new cc.Vertex2F(0,0,b,f);this._bl=i?new cc.Vertex2F(i.x,i.y,b,f*2):new cc.Vertex2F(0,0,b,f*2);this._br=d?new cc.Vertex2F(d.x,d.y,b,f*3):new cc.Vertex2F(0,0,b,f*3);};cc.Quad2.BYTES_PER_ELEMENT=32;cc.Quad3=function(c,d,e,b){this.bl=c||new cc.Vertex3F(0,0,0);this.br=d||new cc.Vertex3F(0,0,0);this.tl=e||new cc.Vertex3F(0,0,0);this.tr=b||new cc.Vertex3F(0,0,0);};Object.defineProperties(cc.Quad2.prototype,{tl:{get:function(){return this._tl;},set:function(b){this._tl.x=b.x;this._tl.y=b.y;},enumerable:true},tr:{get:function(){return this._tr;},set:function(b){this._tr.x=b.x;this._tr.y=b.y;},enumerable:true},bl:{get:function(){return this._bl;},set:function(b){this._bl.x=b.x;this._bl.y=b.y;},enumerable:true},br:{get:function(){return this._br;},set:function(b){this._br.x=b.x;this._br.y=b.y;},enumerable:true}});cc.V3F_C4B_T2F=function(d,c,g,e,i){this._arrayBuffer=e||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT);this._offset=i||0;var b=this._arrayBuffer,h=this._offset,f=cc.Vertex3F.BYTES_PER_ELEMENT;this._vertices=d?new cc.Vertex3F(d.x,d.y,d.z,b,h):new cc.Vertex3F(0,0,0,b,h);this._colors=c?cc.color(c.r,c.g,c.b,c.a,b,h+f):cc.color(0,0,0,0,b,h+f);this._texCoords=g?new cc.Tex2F(g.u,g.v,b,h+f+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,b,h+f+cc.Color.BYTES_PER_ELEMENT);};cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24;Object.defineProperties(cc.V3F_C4B_T2F.prototype,{vertices:{get:function(){return this._vertices;},set:function(c){var b=this._vertices;b.x=c.x;b.y=c.y;b.z=c.z;},enumerable:true},colors:{get:function(){return this._colors;},set:function(b){var c=this._colors;c.r=b.r;c.g=b.g;c.b=b.b;c.a=b.a;},enumerable:true},texCoords:{get:function(){return this._texCoords;},set:function(b){this._texCoords.u=b.u;this._texCoords.v=b.v;},enumerable:true}});cc.V3F_C4B_T2F_Quad=function(j,d,h,i,f,e){this._arrayBuffer=f||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT);this._offset=e||0;var g=this._arrayBuffer,c=this._offset,b=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=j?new cc.V3F_C4B_T2F(j.vertices,j.colors,j.texCoords,g,c):new cc.V3F_C4B_T2F(null,null,null,g,c);this._bl=d?new cc.V3F_C4B_T2F(d.vertices,d.colors,d.texCoords,g,c+b):new cc.V3F_C4B_T2F(null,null,null,g,c+b);this._tr=h?new cc.V3F_C4B_T2F(h.vertices,h.colors,h.texCoords,g,c+b*2):new cc.V3F_C4B_T2F(null,null,null,g,c+b*2);this._br=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,g,c+b*3):new cc.V3F_C4B_T2F(null,null,null,g,c+b*3);};cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96;Object.defineProperties(cc.V3F_C4B_T2F_Quad.prototype,{tl:{get:function(){return this._tl;},set:function(c){var b=this._tl;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true},bl:{get:function(){return this._bl;},set:function(b){var c=this._bl;c.vertices=b.vertices;c.colors=b.colors;c.texCoords=b.texCoords;},enumerable:true},tr:{get:function(){return this._tr;},set:function(c){var b=this._tr;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true},br:{get:function(){return this._br;},set:function(c){var b=this._br;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true},arrayBuffer:{get:function(){return this._arrayBuffer;},enumerable:true}});cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad();};cc.V3F_C4B_T2F_QuadCopy=function(b){if(!b){return cc.V3F_C4B_T2F_QuadZero();}var f=b.tl,e=b.bl,d=b.tr,c=b.br;return{tl:{vertices:{x:f.vertices.x,y:f.vertices.y,z:f.vertices.z},colors:{r:f.colors.r,g:f.colors.g,b:f.colors.b,a:f.colors.a},texCoords:{u:f.texCoords.u,v:f.texCoords.v}},bl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},tr:{vertices:{x:d.vertices.x,y:d.vertices.y,z:d.vertices.z},colors:{r:d.colors.r,g:d.colors.g,b:d.colors.b,a:d.colors.a},texCoords:{u:d.texCoords.u,v:d.texCoords.v}},br:{vertices:{x:c.vertices.x,y:c.vertices.y,z:c.vertices.z},colors:{r:c.colors.r,g:c.colors.g,b:c.colors.b,a:c.colors.a},texCoords:{u:c.texCoords.u,v:c.texCoords.v}}};};cc.V3F_C4B_T2F_QuadsCopy=function(c){if(!c){return[];}var d=[];for(var b=0;b<c.length;b++){d.push(cc.V3F_C4B_T2F_QuadCopy(c[b]));}return d;};cc.V2F_C4B_T2F=function(d,c,g,e,i){this._arrayBuffer=e||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT);this._offset=i||0;var b=this._arrayBuffer,h=this._offset,f=cc.Vertex2F.BYTES_PER_ELEMENT;this._vertices=d?new cc.Vertex2F(d.x,d.y,b,h):new cc.Vertex2F(0,0,b,h);this._colors=c?cc.color(c.r,c.g,c.b,c.a,b,h+f):cc.color(0,0,0,0,b,h+f);this._texCoords=g?new cc.Tex2F(g.u,g.v,b,h+f+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,b,h+f+cc.Color.BYTES_PER_ELEMENT);};cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20;Object.defineProperties(cc.V2F_C4B_T2F.prototype,{vertices:{get:function(){return this._vertices;},set:function(b){this._vertices.x=b.x;this._vertices.y=b.y;},enumerable:true},colors:{get:function(){return this._colors;},set:function(b){var c=this._colors;c.r=b.r;c.g=b.g;c.b=b.b;c.a=b.a;},enumerable:true},texCoords:{get:function(){return this._texCoords;},set:function(b){this._texCoords.u=b.u;this._texCoords.v=b.v;},enumerable:true}});cc.V2F_C4B_T2F_Triangle=function(f,d,k,g,j){this._arrayBuffer=g||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT);this._offset=j||0;var e=this._arrayBuffer,i=this._offset,h=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=f?new cc.V2F_C4B_T2F(f.vertices,f.colors,f.texCoords,e,i):new cc.V2F_C4B_T2F(null,null,null,e,i);this._b=d?new cc.V2F_C4B_T2F(d.vertices,d.colors,d.texCoords,e,i+h):new cc.V2F_C4B_T2F(null,null,null,e,i+h);this._c=k?new cc.V2F_C4B_T2F(k.vertices,k.colors,k.texCoords,e,i+h*2):new cc.V2F_C4B_T2F(null,null,null,e,i+h*2);};cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60;Object.defineProperties(cc.V2F_C4B_T2F_Triangle.prototype,{a:{get:function(){return this._a;},set:function(c){var b=this._a;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true},b:{get:function(){return this._b;},set:function(c){var b=this._b;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true},c:{get:function(){return this._c;},set:function(c){var b=this._c;b.vertices=c.vertices;b.colors=c.colors;b.texCoords=c.texCoords;},enumerable:true}});};cc.Color=function(f,e,c,d){this.r=f||0;this.g=e||0;this.b=c||0;this.a=(d==null)?255:d;};cc.color=function(f,e,c,d){if(f===undefined){return{r:0,g:0,b:0,a:255};}if(cc.isString(f)){return cc.hexToColor(f);}if(cc.isObject(f)){return{r:f.r,g:f.g,b:f.b,a:(f.a==null)?255:f.a};}return{r:f,g:e,b:c,a:(d==null?255:d)};};cc.colorEqual=function(b,a){return b.r===a.r&&b.g===a.g&&b.b===a.b;};cc.Acceleration=function(a,d,c,b){this.x=a||0;this.y=d||0;this.z=c||0;this.timestamp=b||0;};cc.Vertex2F=function(a,b){this.x=a||0;this.y=b||0;};cc.vertex2=function(a,b){return new cc.Vertex2F(a,b);};cc.Vertex3F=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0;};cc.vertex3=function(a,c,b){return new cc.Vertex3F(a,c,b);};cc.Tex2F=function(a,b){this.u=a||0;this.v=b||0;};cc.tex2=function(b,a){return new cc.Tex2F(b,a);};cc.BlendFunc=function(b,a){this.src=b;this.dst=a;};cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO);};cc.hexToColor=function(f){f=f.replace(/^#?/,"0x");var h=parseInt(f);var e=h>>16;var d=(h>>8)%256;var a=h%256;return cc.color(e,d,a);};cc.colorToHex=function(a){var c=a.r.toString(16),b=a.g.toString(16),d=a.b.toString(16);return"#"+(a.r<16?("0"+c):c)+(a.g<16?("0"+b):b)+(a.b<16?("0"+d):d);};cc.TEXT_ALIGNMENT_LEFT=0;cc.TEXT_ALIGNMENT_CENTER=1;cc.TEXT_ALIGNMENT_RIGHT=2;cc.VERTICAL_TEXT_ALIGNMENT_TOP=0;cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1;cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2;cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={};this._valueMapTb={};this.__currId=2<<(0|(Math.random()*10));},__getKey:function(){this.__currId++;return"key_"+this.__currId;},setObject:function(b,a){if(a==null){return;}var c=this.__getKey();this._keyMapTb[c]=a;this._valueMapTb[c]=b;},objectForKey:function(a){if(a==null){return null;}var b=this._keyMapTb;for(var c in b){if(b[c]===a){return this._valueMapTb[c];}}return null;},valueForKey:function(a){return this.objectForKey(a);},removeObjectForKey:function(a){if(a==null){return;}var b=this._keyMapTb;for(var c in b){if(b[c]===a){delete this._valueMapTb[c];delete b[c];return;}}},removeObjectsForKeys:function(b){if(b==null){return;}for(var a=0;a<b.length;a++){this.removeObjectForKey(b[a]);}},allKeys:function(){var a=[],c=this._keyMapTb;for(var b in c){a.push(c[b]);}return a;},removeAllObjects:function(){this._keyMapTb={};this._valueMapTb={};},count:function(){return this.allKeys().length;}});cc.FontDefinition=function(){var a=this;a.fontName="Arial";a.fontSize=12;a.textAlign=cc.TEXT_ALIGNMENT_CENTER;a.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP;a.fillStyle=cc.color(255,255,255,255);a.boundingWidth=0;a.boundingHeight=0;a.strokeEnabled=false;a.strokeStyle=cc.color(255,255,255,255);a.lineWidth=1;a.shadowEnabled=false;a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=0;a.shadowOpacity=1;};if(cc._renderType===cc._RENDER_TYPE_WEBGL){cc.assert(cc.isFunction(cc._tmp.WebGLColor),cc._LogInfos.MissingFile,"CCTypesWebGL.js");cc._tmp.WebGLColor();delete cc._tmp.WebGLColor;}cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js");cc._tmp.PrototypeColor();delete cc._tmp.PrototypeColor;cc.Touches=[];cc.TouchesIntergerDict={};cc.DENSITYDPI_DEVICE="device-dpi";cc.DENSITYDPI_HIGH="high-dpi";cc.DENSITYDPI_MEDIUM="medium-dpi";cc.DENSITYDPI_LOW="low-dpi";cc.__BrowserGetter={init:function(){this.html=document.getElementsByTagName("html")[0];},availWidth:function(a){if(!a||a===this.html){return window.innerWidth;}else{return a.clientWidth;}},availHeight:function(a){if(!a||a===this.html){return window.innerHeight;}else{return a.clientHeight;}},meta:{"width":"device-width","user-scalable":"no"}};switch(cc.sys.browserType){case cc.sys.BROWSER_TYPE_SAFARI:cc.__BrowserGetter.meta["minimal-ui"]="true";cc.__BrowserGetter.availWidth=function(a){return a.clientWidth;};cc.__BrowserGetter.availHeight=function(a){return a.clientHeight;};break;case cc.sys.BROWSER_TYPE_CHROME:cc.__BrowserGetter.__defineGetter__("target-densitydpi",function(){return cc.view._targetDensityDPI;});case cc.sys.BROWSER_TYPE_UC:cc.__BrowserGetter.availWidth=function(a){return a.clientWidth;};cc.__BrowserGetter.availHeight=function(a){return a.clientHeight;};break;case cc.sys.BROWSER_TYPE_MIUI:cc.__BrowserGetter.init=function(a){if(a.__resizeWithBrowserSize){return;}var b=function(){a.setDesignResolutionSize(a._designResolutionSize.width,a._designResolutionSize.height,a._resolutionPolicy);window.removeEventListener("resize",b,false);};window.addEventListener("resize",b,false);};break;}cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:false,_autoFullScreen:true,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_indexBitsUsed:0,_maxTouches:5,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:false,_captured:false,_wnd:null,_hDC:null,_hRC:null,_supportTouch:false,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:false,_isAdjustViewPort:true,_targetDensityDPI:null,ctor:function(){var f=this,g=document,e=cc.ContainerStrategy,i=cc.ContentStrategy;cc.__BrowserGetter.init(this);f._frame=(cc.container.parentNode===g.body)?g.documentElement:cc.container.parentNode;f._frameSize=cc.size(0,0);f._initFrameSize();var a=cc._canvas.width,b=cc._canvas.height;f._designResolutionSize=cc.size(a,b);f._originalDesignResolutionSize=cc.size(a,b);f._viewPortRect=cc.rect(0,0,a,b);f._visibleRect=cc.rect(0,0,a,b);f._contentTranslateLeftTop={left:0,top:0};f._viewName="Cocos2dHTML5";var c=cc.sys;f.enableRetina(c.os==c.OS_IOS||c.os==c.OS_OSX);cc.visibleRect&&cc.visibleRect.init(f._visibleRect);f._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.EXACT_FIT);f._rpShowAll=new cc.ResolutionPolicy(e.PROPORTION_TO_FRAME,i.SHOW_ALL);f._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.NO_BORDER);f._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_HEIGHT);f._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_WIDTH);f._hDC=cc._canvas;f._hRC=cc._renderContext;f._targetDensityDPI=cc.DENSITYDPI_HIGH;},_resizeEvent:function(){var b;if(this.setDesignResolutionSize){b=this;}else{b=cc.view;}var c=b._frameSize.width,e=b._frameSize.height;b._initFrameSize();if(b._frameSize.width==c&&b._frameSize.height==e){return;}if(b._resizeCallback){b._resizeCallback.call();}var d=b._originalDesignResolutionSize.width;var a=b._originalDesignResolutionSize.height;if(d>0){b.setDesignResolutionSize(d,a,b._resolutionPolicy);}},setTargetDensityDPI:function(a){this._targetDensityDPI=a;this._setViewPortMeta();},getTargetDensityDPI:function(){return this._targetDensityDPI;},resizeWithBrowserSize:function(a){if(a){if(!this.__resizeWithBrowserSize){this.__resizeWithBrowserSize=true;cc._addEventListener(window,"resize",this._resizeEvent);cc._addEventListener(window,"orientationchange",this._resizeEvent);}}else{if(this.__resizeWithBrowserSize){this.__resizeWithBrowserSize=false;window.removeEventListener("resize",this._resizeEvent);window.removeEventListener("orientationchange",this._resizeEvent);}}},setResizeCallback:function(a){if(cc.isFunction(a)||a==null){this._resizeCallback=a;}},_initFrameSize:function(){var a=this._frameSize;a.width=cc.__BrowserGetter.availWidth(this._frame);a.height=cc.__BrowserGetter.availHeight(this._frame);},_adjustSizeKeepCanvasSize:function(){var b=this._originalDesignResolutionSize.width;var a=this._originalDesignResolutionSize.height;if(b>0){this.setDesignResolutionSize(b,a,this._resolutionPolicy);}},_setViewPortMeta:function(){if(this._isAdjustViewPort){var c=document.getElementById("cocosMetaElement");if(c){document.head.removeChild(c);}var e,b=document.getElementsByName("viewport"),a=b?b[0]:null,f;c=cc.newElement("meta");c.id="cocosMetaElement";c.name="viewport";c.content="";e=cc.__BrowserGetter.meta;f=a?a.content:"";for(var d in e){var g=new RegExp(d);if(!g.test(f)){f+=","+d+"="+e[d];}}if(/^,/.test(f)){f=f.substr(1);}c.content=f;if(a){a.content=f;}document.head.appendChild(c);}},_setScaleXYForRenderTexture:function(){var a=cc.contentScaleFactor();this._scaleX=a;this._scaleY=a;},_resetScale:function(){this._scaleX=this._originalScaleX;this._scaleY=this._originalScaleY;},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=true;},adjustViewPort:function(a){this._isAdjustViewPort=a;},enableRetina:function(a){this._retinaEnabled=a?true:false;},isRetinaEnabled:function(){return this._retinaEnabled;},enableAutoFullScreen:function(a){this._autoFullScreen=a?true:false;},isAutoFullScreenEnabled:function(){return this._autoFullScreen;},end:function(){},isOpenGLReady:function(){return(this._hDC!=null&&this._hRC!=null);},setFrameZoomFactor:function(a){this._frameZoomFactor=a;this.centerWindow();cc.director.setProjection(cc.director.getProjection());},swapBuffers:function(){},setIMEKeyboardState:function(a){},setContentTranslateLeftTop:function(b,a){this._contentTranslateLeftTop={left:b,top:a};},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop;},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height);},setFrameSize:function(b,a){this._frameSize.width=b;this._frameSize.height=a;this._frame.style.width=b+"px";this._frame.style.height=a+"px";this._resizeEvent();cc.director.setProjection(cc.director.getProjection());},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height);},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y);},canSetContentScaleFactor:function(){return true;},getResolutionPolicy:function(){return this._resolutionPolicy;},setResolutionPolicy:function(c){var b=this;if(c instanceof cc.ResolutionPolicy){b._resolutionPolicy=c;}else{var a=cc.ResolutionPolicy;if(c===a.EXACT_FIT){b._resolutionPolicy=b._rpExactFit;}if(c===a.SHOW_ALL){b._resolutionPolicy=b._rpShowAll;}if(c===a.NO_BORDER){b._resolutionPolicy=b._rpNoBorder;}if(c===a.FIXED_HEIGHT){b._resolutionPolicy=b._rpFixedHeight;}if(c===a.FIXED_WIDTH){b._resolutionPolicy=b._rpFixedWidth;}}},setDesignResolutionSize:function(c,h,e){if(!(c>0||h>0)){cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);return;}this.setResolutionPolicy(e);var f=this._resolutionPolicy;if(!f){cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);return;}f.preApply(this);if(cc.sys.isMobile){this._setViewPortMeta();}this._initFrameSize();this._originalDesignResolutionSize.width=this._designResolutionSize.width=c;this._originalDesignResolutionSize.height=this._designResolutionSize.height=h;var i=f.apply(this,this._designResolutionSize);if(i.scale&&i.scale.length==2){this._scaleX=i.scale[0];this._scaleY=i.scale[1];}if(i.viewport){var a=this._viewPortRect,g=this._visibleRect,d=i.viewport;a.x=d.x;a.y=d.y;a.width=d.width;a.height=d.height;g.x=-a.x/this._scaleX;g.y=-a.y/this._scaleY;g.width=cc._canvas.width/this._scaleX;g.height=cc._canvas.height/this._scaleY;cc._renderContext.setOffset&&cc._renderContext.setOffset(a.x,-a.y);}var b=cc.director;b._winSizeInPoints.width=this._designResolutionSize.width;b._winSizeInPoints.height=this._designResolutionSize.height;f.postApply(this);cc.winSize.width=b._winSizeInPoints.width;cc.winSize.height=b._winSizeInPoints.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){b._createStatsLabel();b.setGLDefaultValues();}this._originalScaleX=this._scaleX;this._originalScaleY=this._scaleY;if(cc.DOM){cc.DOM._resetEGLViewDiv();}cc.visibleRect&&cc.visibleRect.init(this._visibleRect);},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height);},setViewPortInPoints:function(b,g,d,e){var f=this._frameZoomFactor,c=this._scaleX,a=this._scaleY;cc._renderContext.viewport((b*c*f+this._viewPortRect.x*f),(g*a*f+this._viewPortRect.y*f),(d*c*f),(e*a*f));},setScissorInPoints:function(b,g,d,e){var f=this._frameZoomFactor,c=this._scaleX,a=this._scaleY;cc._renderContext.scissor((b*c*f+this._viewPortRect.x*f),(g*a*f+this._viewPortRect.y*f),(d*c*f),(e*a*f));},isScissorEnabled:function(){var a=cc._renderContext;return a.isEnabled(a.SCISSOR_TEST);},getScissorRect:function(){var d=cc._renderContext,b=this._scaleX,a=this._scaleY;var c=d.getParameter(d.SCISSOR_BOX);return cc.rect((c[0]-this._viewPortRect.x)/b,(c[1]-this._viewPortRect.y)/a,c[2]/b,c[3]/a);},setViewName:function(a){if(a!=null&&a.length>0){this._viewName=a;}},getViewName:function(){return this._viewName;},getViewPortRect:function(){return this._viewPortRect;},getScaleX:function(){return this._scaleX;},getScaleY:function(){return this._scaleY;},getDevicePixelRatio:function(){return this._devicePixelRatio;},convertToLocationInView:function(b,a,c){return{x:this._devicePixelRatio*(b-c.left),y:this._devicePixelRatio*(c.top+c.height-a)};},_convertMouseToLocationInView:function(a,b){var d=this._viewPortRect,c=this;a.x=((c._devicePixelRatio*(a.x-b.left))-d.x)/c._scaleX;a.y=(c._devicePixelRatio*(b.top+b.height-a.y)-d.y)/c._scaleY;},_convertTouchesWithScale:function(f){var e=this._viewPortRect,b=this._scaleX,a=this._scaleY,g,h,d;for(var c=0;c<f.length;c++){g=f[c];h=g._point;d=g._prevPoint;g._setPoint((h.x-e.x)/b,(h.y-e.y)/a);g._setPrevPoint((d.x-e.x)/b,(d.y-e.y)/a);}}});cc.EGLView._getInstance=function(){if(!this._instance){this._instance=this._instance||new cc.EGLView();this._instance.initialize();}return this._instance;};cc.ContainerStrategy=cc.Class.extend({preApply:function(a){},apply:function(a,b){},postApply:function(a){},_setupContainer:function(f,g,c){var b=f._frame;if(cc.view._autoFullScreen&&cc.sys.isMobile&&b==document.documentElement){cc.screen.autoFullScreen(b);}var j=cc._canvas,e=cc.container;e.style.width=j.style.width=g+"px";e.style.height=j.style.height=c+"px";var i=f._devicePixelRatio=1;if(f.isRetinaEnabled()){i=f._devicePixelRatio=window.devicePixelRatio||1;}j.width=g*i;j.height=c*i;cc._renderContext.resetCache&&cc._renderContext.resetCache();var d=document.body,a;if(d&&(a=d.style)){a.paddingTop=a.paddingTop||"0px";a.paddingRight=a.paddingRight||"0px";a.paddingBottom=a.paddingBottom||"0px";a.paddingLeft=a.paddingLeft||"0px";a.borderTop=a.borderTop||"0px";a.borderRight=a.borderRight||"0px";a.borderBottom=a.borderBottom||"0px";a.borderLeft=a.borderLeft||"0px";a.marginTop=a.marginTop||"0px";a.marginRight=a.marginRight||"0px";a.marginBottom=a.marginBottom||"0px";a.marginLeft=a.marginLeft||"0px";}},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var a=document.body.style;a.width=window.innerWidth+"px";a.height=window.innerHeight+"px";a.overflow="hidden";var b=cc.container.style;b.position="fixed";b.left=b.top="0px";document.body.scrollTop=0;}});cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(d,g,b,f,e,c){Math.abs(d-b)<2&&(b=d);Math.abs(g-f)<2&&(f=g);var a=cc.rect(Math.round((d-b)/2),Math.round((g-f)/2),b,f);if(cc._renderType==cc._RENDER_TYPE_CANVAS){}this._result.scale=[e,c];this._result.viewport=a;return this._result;},preApply:function(a){},apply:function(a,b){return{"scale":[1,1]};},postApply:function(a){}});(function(){var g=cc.ContainerStrategy.extend({apply:function(k){this._setupContainer(k,k._frameSize.width,k._frameSize.height);}});var h=cc.ContainerStrategy.extend({apply:function(t,r){var w=t._frameSize.width,q=t._frameSize.height,s=cc.container.style,m=r.width,u=r.height,x=w/m,v=q/u,n,k;x<v?(n=w,k=u*x):(n=m*v,k=q);var p=Math.round((w-n)/2);var o=Math.round((q-k)/2);n=w-2*p;k=q-2*o;this._setupContainer(t,n,k);s.marginLeft=p+"px";s.marginRight=p+"px";s.marginTop=o+"px";s.marginBottom=o+"px";}});var c=g.extend({preApply:function(k){this._super(k);k._frame=document.documentElement;},apply:function(k){this._super(k);this._fixContainer();}});var e=h.extend({preApply:function(k){this._super(k);k._frame=document.documentElement;},apply:function(k,m){this._super(k,m);this._fixContainer();}});var d=cc.ContainerStrategy.extend({apply:function(k){this._setupContainer(k,cc._canvas.width,cc._canvas.height);}});cc.ContainerStrategy.EQUAL_TO_FRAME=new g();cc.ContainerStrategy.PROPORTION_TO_FRAME=new h();cc.ContainerStrategy.ORIGINAL_CONTAINER=new d();var b=cc.ContentStrategy.extend({apply:function(k,q){var n=cc._canvas.width,p=cc._canvas.height,o=n/q.width,m=p/q.height;return this._buildResult(n,p,n,p,o,m);}});var a=cc.ContentStrategy.extend({apply:function(s,r){var p=cc._canvas.width,k=cc._canvas.height,n=r.width,t=r.height,v=p/n,u=k/t,o=0,q,m;v<u?(o=v,q=p,m=t*o):(o=u,q=n*o,m=k);return this._buildResult(p,k,q,m,o,o);}});var f=cc.ContentStrategy.extend({apply:function(s,r){var p=cc._canvas.width,k=cc._canvas.height,n=r.width,t=r.height,v=p/n,u=k/t,o,q,m;v<u?(o=u,q=n*o,m=k):(o=v,q=p,m=t*o);return this._buildResult(p,k,q,m,o,o);}});var j=cc.ContentStrategy.extend({apply:function(m,r){var n=cc._canvas.width,p=cc._canvas.height,q=r.height,s=p/q,k=n,o=p;return this._buildResult(n,p,k,o,s,s);},postApply:function(k){cc.director._winSizeInPoints=k.getVisibleSize();}});var i=cc.ContentStrategy.extend({apply:function(m,r){var n=cc._canvas.width,q=cc._canvas.height,o=r.width,s=n/o,k=n,p=q;return this._buildResult(n,q,k,p,s,s);},postApply:function(k){cc.director._winSizeInPoints=k.getVisibleSize();}});cc.ContentStrategy.EXACT_FIT=new b();cc.ContentStrategy.SHOW_ALL=new a();cc.ContentStrategy.NO_BORDER=new f();cc.ContentStrategy.FIXED_HEIGHT=new j();cc.ContentStrategy.FIXED_WIDTH=new i();})();cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(b,a){this.setContainerStrategy(b);this.setContentStrategy(a);},preApply:function(a){this._containerStrategy.preApply(a);this._contentStrategy.preApply(a);},apply:function(a,b){this._containerStrategy.apply(a,b);return this._contentStrategy.apply(a,b);},postApply:function(a){this._containerStrategy.postApply(a);this._contentStrategy.postApply(a);},setContainerStrategy:function(a){if(a instanceof cc.ContainerStrategy){this._containerStrategy=a;}},setContentStrategy:function(a){if(a instanceof cc.ContentStrategy){this._contentStrategy=a;}}});cc.ResolutionPolicy.EXACT_FIT=0;cc.ResolutionPolicy.NO_BORDER=1;cc.ResolutionPolicy.SHOW_ALL=2;cc.ResolutionPolicy.FIXED_HEIGHT=3;cc.ResolutionPolicy.FIXED_WIDTH=4;cc.ResolutionPolicy.UNKNOWN=5;cc.screen={_supportsFullScreen:false,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var b,d,c=this._fnMap,a;for(b=0,l=c.length;b<l;b++){d=c[b];if(d&&d[1] in document){for(b=0,a=d.length;b<a;b++){this._fn[c[0][b]]=d[b];}break;}}this._supportsFullScreen=(this._fn.requestFullscreen!=undefined);this._touchEvent=("ontouchstart" in window)?"touchstart":"mousedown";},fullScreen:function(){return this._supportsFullScreen&&document[this._fn.fullscreenEnabled];},requestFullScreen:function(c,a){if(!this._supportsFullScreen){return;}c=c||document.documentElement;c[this._fn.requestFullscreen]();if(a){var b=this._fn.fullscreenchange;if(this._preOnFullScreenChange){document.removeEventListener(b,this._preOnFullScreenChange);}this._preOnFullScreenChange=a;cc._addEventListener(document,b,a,false);}return c[this._fn.requestFullscreen]();},exitFullScreen:function(){return this._supportsFullScreen?document[this._fn.exitFullscreen]():true;},autoFullScreen:function(c,a){c=c||document.body;var e=cc._canvas||c;var b=this;function d(){b.requestFullScreen(c,a);e.removeEventListener(b._touchEvent,d);}this.requestFullScreen(c,a);cc._addEventListener(e,this._touchEvent,d);}};cc.screen.init();cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(i){var d=this.width=i.width;var f=this.height=i.height;var c=i.x,a=i.y,e=a+f,g=c+d;this.topLeft.x=c;this.topLeft.y=e;this.topRight.x=g;this.topRight.y=e;this.top.x=c+d/2;this.top.y=e;this.bottomLeft.x=c;this.bottomLeft.y=a;this.bottomRight.x=g;this.bottomRight.y=a;this.bottom.x=c+d/2;this.bottom.y=a;this.center.x=c+d/2;this.center.y=a+f/2;this.left.x=c;this.left.y=a+f/2;this.right.x=g;this.right.y=a+f/2;}};cc.UIInterfaceOrientationLandscapeLeft=-90;cc.UIInterfaceOrientationLandscapeRight=90;cc.UIInterfaceOrientationPortraitUpsideDown=180;cc.UIInterfaceOrientationPortrait=0;cc.inputManager={_mousePressed:false,_isRegisterEvent:false,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:false,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){var a=this._indexBitsUsed;for(var b=0;b<this._maxTouches;b++){if(!(a&1)){this._indexBitsUsed|=(1<<b);return b;}a>>=1;}return -1;},_removeUsedIndexBit:function(b){if(b<0||b>=this._maxTouches){return;}var a=1<<b;a=~a;this._indexBitsUsed&=a;},_glView:null,handleTouchesBegin:function(f){var e,h,m,c,j=[],k=this._touchesIntegerDict;for(var d=0,g=f.length;d<g;d++){e=f[d];c=e.getID();h=k[c];if(h==null){var b=this._getUnUsedIndex();if(b==-1){cc.log(cc._LogInfos.inputManager_handleTouchesBegin,b);continue;}m=this._touches[b]=new cc.Touch(e._point.x,e._point.y,e.getID());m._setPrevPoint(e._prevPoint);k[c]=b;j.push(m);}}if(j.length>0){this._glView._convertTouchesWithScale(j);var a=new cc.EventTouch(j);a._eventCode=cc.EventTouch.EventCode.BEGAN;cc.eventManager.dispatchEvent(a);}},handleTouchesMove:function(e){var d,f,b,j=[],h=this._touches;for(var c=0,g=e.length;c<g;c++){d=e[c];b=d.getID();f=this._touchesIntegerDict[b];if(f==null){continue;}if(h[f]){h[f]._setPoint(d._point);h[f]._setPrevPoint(d._prevPoint);j.push(h[f]);}}if(j.length>0){this._glView._convertTouchesWithScale(j);var a=new cc.EventTouch(j);a._eventCode=cc.EventTouch.EventCode.MOVED;cc.eventManager.dispatchEvent(a);}},handleTouchesEnd:function(b){var c=this.getSetOfTouchesEndOrCancel(b);if(c.length>0){this._glView._convertTouchesWithScale(c);var a=new cc.EventTouch(c);a._eventCode=cc.EventTouch.EventCode.ENDED;cc.eventManager.dispatchEvent(a);}},handleTouchesCancel:function(b){var c=this.getSetOfTouchesEndOrCancel(b);if(c.length>0){this._glView._convertTouchesWithScale(c);var a=new cc.EventTouch(c);a._eventCode=cc.EventTouch.EventCode.CANCELLED;cc.eventManager.dispatchEvent(a);}},getSetOfTouchesEndOrCancel:function(d){var c,f,a,h=[],g=this._touches,j=this._touchesIntegerDict;for(var b=0,e=d.length;b<e;b++){c=d[b];a=c.getID();f=j[a];if(f==null){continue;}if(g[f]){g[f]._setPoint(c._point);g[f]._setPrevPoint(c._prevPoint);h.push(g[f]);this._removeUsedIndexBit(f);delete j[a];}}return h;},getHTMLElementPosition:function(b){var a=document.documentElement;var d=window;var c=null;if(cc.isFunction(b.getBoundingClientRect)){c=b.getBoundingClientRect();}else{if(b instanceof HTMLCanvasElement){c={left:0,top:0,width:b.width,height:b.height};}else{c={left:0,top:0,width:parseInt(b.style.width),height:parseInt(b.style.height)};}}return{left:c.left+d.pageXOffset-a.clientLeft,top:c.top+d.pageYOffset-a.clientTop,width:c.width,height:c.height};},getPreTouch:function(e){var d=null;var b=this._preTouchPool;var c=e.getID();for(var a=b.length-1;a>=0;a--){if(b[a].getID()==c){d=b[a];break;}}if(!d){d=e;}return d;},setPreTouch:function(e){var c=false;var b=this._preTouchPool;var d=e.getID();for(var a=b.length-1;a>=0;a--){if(b[a].getID()==d){b[a]=e;c=true;break;}}if(!c){if(b.length<=50){b.push(e);}else{b[this._preTouchPoolPointer]=e;this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50;}}},getTouchByXY:function(c,a,f){var d=this._preTouchPoint;var b=this._glView.convertToLocationInView(c,a,f);var e=new cc.Touch(b.x,b.y);e._setPrevPoint(d.x,d.y);d.x=b.x;d.y=b.y;return e;},getMouseEvent:function(b,e,c){var a=this._prevMousePoint;this._glView._convertMouseToLocationInView(b,e);var d=new cc.EventMouse(c);d.setLocation(b.x,b.y);d._setPrevCursor(a.x,a.y);a.x=b.x;a.y=b.y;return d;},getPointByEvent:function(a,b){if(a.pageX!=null){return{x:a.pageX,y:a.pageY};}b.left-=document.body.scrollLeft;b.top-=document.body.scrollTop;return{x:a.clientX,y:a.clientY};},getTouchesByEvent:function(b,h){var a=[],d=this._glView;var g,f,m;var k=this._preTouchPoint;var c=b.changedTouches.length;for(var e=0;e<c;e++){g=b.changedTouches[e];if(g){var j;if(cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType){j=d.convertToLocationInView(g.pageX,g.pageY,h);}else{j=d.convertToLocationInView(g.clientX,g.clientY,h);}if(g.identifier!=null){f=new cc.Touch(j.x,j.y,g.identifier);m=this.getPreTouch(f).getLocation();f._setPrevPoint(m.x,m.y);this.setPreTouch(f);}else{f=new cc.Touch(j.x,j.y);f._setPrevPoint(k.x,k.y);}k.x=j.x;k.y=j.y;a.push(f);}}return a;},registerSystemEvent:function(d){if(this._isRegisterEvent){return;}var g=this._glView=cc.view;var f=this;var h=("mouse" in cc.sys.capabilities),c=("touches" in cc.sys.capabilities);var e=false;if(cc.sys.isMobile){e=true;}if(h){cc._addEventListener(window,"mousedown",function(){f._mousePressed=true;},false);cc._addEventListener(window,"mouseup",function(j){if(e){return;}var k=f._mousePressed;f._mousePressed=false;if(!k){return;}var n=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,n);if(!cc.rectContainsPoint(new cc.Rect(n.left,n.top,n.width,n.height),i)){f.handleTouchesEnd([f.getTouchByXY(i.x,i.y,n)]);var m=f.getMouseEvent(i,n,cc.EventMouse.UP);m.setButton(j.button);cc.eventManager.dispatchEvent(m);}},false);cc._addEventListener(d,"mousedown",function(j){if(e){return;}f._mousePressed=true;var m=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,m);f.handleTouchesBegin([f.getTouchByXY(i.x,i.y,m)]);var k=f.getMouseEvent(i,m,cc.EventMouse.DOWN);k.setButton(j.button);cc.eventManager.dispatchEvent(k);j.stopPropagation();j.preventDefault();d.focus();},false);cc._addEventListener(d,"mouseup",function(j){if(e){return;}f._mousePressed=false;var m=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,m);f.handleTouchesEnd([f.getTouchByXY(i.x,i.y,m)]);var k=f.getMouseEvent(i,m,cc.EventMouse.UP);k.setButton(j.button);cc.eventManager.dispatchEvent(k);j.stopPropagation();j.preventDefault();},false);cc._addEventListener(d,"mousemove",function(j){if(e){return;}var m=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,m);f.handleTouchesMove([f.getTouchByXY(i.x,i.y,m)]);var k=f.getMouseEvent(i,m,cc.EventMouse.MOVE);if(f._mousePressed){k.setButton(j.button);}else{k.setButton(null);}cc.eventManager.dispatchEvent(k);j.stopPropagation();j.preventDefault();},false);cc._addEventListener(d,"mousewheel",function(j){var m=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,m);var k=f.getMouseEvent(i,m,cc.EventMouse.SCROLL);k.setButton(j.button);k.setScrollData(0,j.wheelDelta);cc.eventManager.dispatchEvent(k);j.stopPropagation();j.preventDefault();},false);cc._addEventListener(d,"DOMMouseScroll",function(j){var m=f.getHTMLElementPosition(d);var i=f.getPointByEvent(j,m);var k=f.getMouseEvent(i,m,cc.EventMouse.SCROLL);k.setButton(j.button);k.setScrollData(0,j.detail*-120);cc.eventManager.dispatchEvent(k);j.stopPropagation();j.preventDefault();},false);}if(window.navigator.msPointerEnabled){var a={"MSPointerDown":f.handleTouchesBegin,"MSPointerMove":f.handleTouchesMove,"MSPointerUp":f.handleTouchesEnd,"MSPointerCancel":f.handleTouchesCancel};for(var b in a){(function(i,j){cc._addEventListener(d,i,function(k){var m=f.getHTMLElementPosition(d);m.left-=document.documentElement.scrollLeft;m.top-=document.documentElement.scrollTop;j.call(f,[f.getTouchByXY(k.clientX,k.clientY,m)]);k.stopPropagation();},false);})(b,a[b]);}}if(c){cc._addEventListener(d,"touchstart",function(i){if(!i.changedTouches){return;}var j=f.getHTMLElementPosition(d);j.left-=document.body.scrollLeft;j.top-=document.body.scrollTop;f.handleTouchesBegin(f.getTouchesByEvent(i,j));i.stopPropagation();i.preventDefault();d.focus();},false);cc._addEventListener(d,"touchmove",function(i){if(!i.changedTouches){return;}var j=f.getHTMLElementPosition(d);j.left-=document.body.scrollLeft;j.top-=document.body.scrollTop;f.handleTouchesMove(f.getTouchesByEvent(i,j));i.stopPropagation();i.preventDefault();},false);cc._addEventListener(d,"touchend",function(i){if(!i.changedTouches){return;}var j=f.getHTMLElementPosition(d);j.left-=document.body.scrollLeft;j.top-=document.body.scrollTop;f.handleTouchesEnd(f.getTouchesByEvent(i,j));i.stopPropagation();i.preventDefault();},false);cc._addEventListener(d,"touchcancel",function(i){if(!i.changedTouches){return;}var j=f.getHTMLElementPosition(d);j.left-=document.body.scrollLeft;j.top-=document.body.scrollTop;f.handleTouchesCancel(f.getTouchesByEvent(i,j));i.stopPropagation();i.preventDefault();},false);}this._registerKeyboardEvent();this._registerAccelerometerEvent();this._isRegisterEvent=true;},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(a){if(this._accelCurTime>this._accelInterval){this._accelCurTime-=this._accelInterval;cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration));}this._accelCurTime+=a;}};cc.AffineTransform=function(h,f,j,i,g,e){this.a=h;this.b=f;this.c=j;this.d=i;this.tx=g;this.ty=e;};cc.affineTransformMake=function(h,f,j,i,g,e){return{a:h,b:f,c:j,d:i,tx:g,ty:e};};cc.pointApplyAffineTransform=function(a,b){return{x:b.a*a.x+b.c*a.y+b.tx,y:b.b*a.x+b.d*a.y+b.ty};};cc._pointApplyAffineTransform=function(a,c,b){return{x:b.a*a+b.c*c+b.tx,y:b.b*a+b.d*c+b.ty};};cc.sizeApplyAffineTransform=function(b,a){return{width:a.a*b.width+a.c*b.height,height:a.b*b.width+a.d*b.height};};cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0};};cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0};};cc.rectApplyAffineTransform=function(m,g){var k=cc.rectGetMinY(m);var e=cc.rectGetMinX(m);var o=cc.rectGetMaxX(m);var b=cc.rectGetMaxY(m);var n=cc._pointApplyAffineTransform(e,k,g);var h=cc._pointApplyAffineTransform(o,k,g);var j=cc._pointApplyAffineTransform(e,b,g);var i=cc._pointApplyAffineTransform(o,b,g);var f=Math.min(n.x,h.x,j.x,i.x);var c=Math.max(n.x,h.x,j.x,i.x);var d=Math.min(n.y,h.y,j.y,i.y);var a=Math.max(n.y,h.y,j.y,i.y);return cc.rect(f,d,(c-f),(a-d));};cc._rectApplyAffineTransformIn=function(m,g){var k=cc.rectGetMinY(m);var e=cc.rectGetMinX(m);var o=cc.rectGetMaxX(m);var b=cc.rectGetMaxY(m);var n=cc._pointApplyAffineTransform(e,k,g);var h=cc._pointApplyAffineTransform(o,k,g);var j=cc._pointApplyAffineTransform(e,b,g);var i=cc._pointApplyAffineTransform(o,b,g);var f=Math.min(n.x,h.x,j.x,i.x);var c=Math.max(n.x,h.x,j.x,i.x);var d=Math.min(n.y,h.y,j.y,i.y);var a=Math.max(n.y,h.y,j.y,i.y);m.x=f;m.y=d;m.width=c-f;m.height=a-d;return m;};cc.affineTransformTranslate=function(c,b,a){return{a:c.a,b:c.b,c:c.c,d:c.d,tx:c.tx+c.a*b+c.c*a,ty:c.ty+c.b*b+c.d*a};};cc.affineTransformScale=function(a,c,b){return{a:a.a*c,b:a.b*c,c:a.c*b,d:a.d*b,tx:a.tx,ty:a.ty};};cc.affineTransformRotate=function(d,c){var a=Math.sin(c);var b=Math.cos(c);return{a:d.a*b+d.c*a,b:d.b*b+d.d*a,c:d.c*b-d.a*a,d:d.d*b-d.b*a,tx:d.tx,ty:d.ty};};cc.affineTransformConcat=function(b,a){return{a:b.a*a.a+b.b*a.c,b:b.a*a.b+b.b*a.d,c:b.c*a.a+b.d*a.c,d:b.c*a.b+b.d*a.d,tx:b.tx*a.a+b.ty*a.c+a.tx,ty:b.tx*a.b+b.ty*a.d+a.ty};};cc.affineTransformEqualToTransform=function(b,a){return((b.a===a.a)&&(b.b===a.b)&&(b.c===a.c)&&(b.d===a.d)&&(b.tx===a.tx)&&(b.ty===a.ty));};cc.affineTransformInvert=function(b){var a=1/(b.a*b.d-b.b*b.c);return{a:a*b.d,b:-a*b.b,c:-a*b.c,d:a*b.a,tx:a*(b.c*b.ty-b.d*b.tx),ty:a*(b.b*b.tx-b.a*b.ty)};};cc.POINT_EPSILON=parseFloat("1.192092896e-07F");cc.pNeg=function(a){return cc.p(-a.x,-a.y);};cc.pAdd=function(b,a){return cc.p(b.x+a.x,b.y+a.y);};cc.pSub=function(b,a){return cc.p(b.x-a.x,b.y-a.y);};cc.pMult=function(a,b){return cc.p(a.x*b,a.y*b);};cc.pMidpoint=function(b,a){return cc.pMult(cc.pAdd(b,a),0.5);};cc.pDot=function(b,a){return b.x*a.x+b.y*a.y;};cc.pCross=function(b,a){return b.x*a.y-b.y*a.x;};cc.pPerp=function(a){return cc.p(-a.y,a.x);};cc.pRPerp=function(a){return cc.p(a.y,-a.x);};cc.pProject=function(b,a){return cc.pMult(a,cc.pDot(b,a)/cc.pDot(a,a));};cc.pRotate=function(b,a){return cc.p(b.x*a.x-b.y*a.y,b.x*a.y+b.y*a.x);};cc.pUnrotate=function(b,a){return cc.p(b.x*a.x+b.y*a.y,b.y*a.x-b.x*a.y);};cc.pLengthSQ=function(a){return cc.pDot(a,a);};cc.pDistanceSQ=function(b,a){return cc.pLengthSQ(cc.pSub(b,a));};cc.pLength=function(a){return Math.sqrt(cc.pLengthSQ(a));};cc.pDistance=function(b,a){return cc.pLength(cc.pSub(b,a));};cc.pNormalize=function(a){var b=cc.pLength(a);return b===0?cc.p(a):cc.pMult(a,1/b);};cc.pForAngle=function(b){return cc.p(Math.cos(b),Math.sin(b));};cc.pToAngle=function(a){return Math.atan2(a.y,a.x);};cc.clampf=function(d,b,c){if(b>c){var a=b;b=c;c=a;}return d<b?b:d<c?d:c;};cc.pClamp=function(c,a,b){return cc.p(cc.clampf(c.x,a.x,b.x),cc.clampf(c.y,a.y,b.y));};cc.pFromSize=function(a){return cc.p(a.width,a.height);};cc.pCompOp=function(b,a){return cc.p(a(b.x),a(b.y));};cc.pLerp=function(d,c,e){return cc.pAdd(cc.pMult(d,1-e),cc.pMult(c,e));};cc.pFuzzyEqual=function(d,c,e){if(d.x-e<=c.x&&c.x<=d.x+e){if(d.y-e<=c.y&&c.y<=d.y+e){return true;}}return false;};cc.pCompMult=function(d,c){return cc.p(d.x*c.x,d.y*c.y);};cc.pAngleSigned=function(e,d){var c=cc.pNormalize(e);var f=cc.pNormalize(d);var g=Math.atan2(c.x*f.y-c.y*f.x,cc.pDot(c,f));if(Math.abs(g)<cc.POINT_EPSILON){return 0;}return g;};cc.pAngle=function(d,c){var e=Math.acos(cc.pDot(cc.pNormalize(d),cc.pNormalize(c)));if(Math.abs(e)<cc.POINT_EPSILON){return 0;}return e;};cc.pRotateByAngle=function(b,a,g){var e=cc.pSub(b,a);var f=Math.cos(g),d=Math.sin(g);var c=e.x;e.x=c*f-e.y*d+a.x;e.y=c*d+e.y*f+a.y;return e;};cc.pLineIntersect=function(d,c,b,a,g){if((d.x==c.x&&d.y==c.y)||(b.x==a.x&&b.y==a.y)){return false;}var j=c.x-d.x;var h=c.y-d.y;var f=a.x-b.x;var e=a.y-b.y;var m=d.x-b.x;var k=d.y-b.y;var i=e*j-f*h;g.x=f*k-e*m;g.y=j*k-h*m;if(i==0){if(g.x==0||g.y==0){return true;}return false;}g.x=g.x/i;g.y=g.y/i;return true;};cc.pSegmentIntersect=function(a,e,c,b){var d=cc.p(0,0);if(cc.pLineIntersect(a,e,c,b,d)){if(d.x>=0&&d.x<=1&&d.y>=0&&d.y<=1){return true;}}return false;};cc.pIntersectPoint=function(a,f,d,c){var e=cc.p(0,0);if(cc.pLineIntersect(a,f,d,c,e)){var b=cc.p(0,0);b.x=a.x+e.x*(f.x-a.x);b.y=a.y+e.x*(f.y-a.y);return b;}return cc.p(0,0);};cc.pSameAs=function(a,b){if((a!=null)&&(b!=null)){return(a.x==b.x&&a.y==b.y);}return false;};cc.pZeroIn=function(a){a.x=0;a.y=0;};cc.pIn=function(b,a){b.x=a.x;b.y=a.y;};cc.pMultIn=function(a,b){a.x*=b;a.y*=b;};cc.pSubIn=function(b,a){b.x-=a.x;b.y-=a.y;};cc.pAddIn=function(b,a){b.x+=a.x;b.y+=a.y;};cc.pNormalizeIn=function(a){cc.pMultIn(a,1/Math.sqrt(a.x*a.x+a.y*a.y));};cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:false,_startPoint:null,ctor:function(a,c,b){this._point=cc.p(a||0,c||0);this._id=b||0;},getLocation:function(){return{x:this._point.x,y:this._point.y};},getLocationX:function(){return this._point.x;},getLocationY:function(){return this._point.y;},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y};},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y};},getDelta:function(){return cc.pSub(this._point,this._prevPoint);},getLocationInView:function(){return{x:this._point.x,y:this._point.y};},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y};},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y};},getID:function(){return this._id;},getId:function(){cc.log("getId is deprecated. Please use getID instead.");return this._id;},setTouchInfo:function(c,a,b){this._prevPoint=this._point;this._point=cc.p(a||0,b||0);this._id=c;if(!this._startPointCaptured){this._startPoint=cc.p(this._point);this._startPointCaptured=true;}},_setPoint:function(a,b){if(b===undefined){this._point.x=a.x;this._point.y=a.y;}else{this._point.x=a;this._point.y=b;}},_setPrevPoint:function(a,b){if(b===undefined){this._prevPoint=cc.p(a.x,a.y);}else{this._prevPoint=cc.p(a||0,b||0);}}});cc.Event=cc.Class.extend({_type:0,_isStopped:false,_currentTarget:null,_setCurrentTarget:function(a){this._currentTarget=a;},ctor:function(a){this._type=a;},getType:function(){return this._type;},stopPropagation:function(){this._isStopped=true;},isStopped:function(){return this._isStopped;},getCurrentTarget:function(){return this._currentTarget;}});cc.Event.TOUCH=0;cc.Event.KEYBOARD=1;cc.Event.ACCELERATION=2;cc.Event.MOUSE=3;cc.Event.FOCUS=4;cc.Event.CUSTOM=6;cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM);this._eventName=a;},setUserData:function(a){this._userData=a;},getUserData:function(){return this._userData;},getEventName:function(){return this._eventName;}});cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE);this._eventType=a;},setScrollData:function(b,a){this._scrollX=b;this._scrollY=a;},getScrollX:function(){return this._scrollX;},getScrollY:function(){return this._scrollY;},setLocation:function(a,b){this._x=a;this._y=b;},getLocation:function(){return{x:this._x,y:this._y};},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y};},_setPrevCursor:function(a,b){this._prevX=a;this._prevY=b;},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY};},getDeltaX:function(){return this._x-this._prevX;},getDeltaY:function(){return this._y-this._prevY;},setButton:function(a){this._button=a;},getButton:function(){return this._button;},getLocationX:function(){return this._x;},getLocationY:function(){return this._y;}});cc.EventMouse.NONE=0;cc.EventMouse.DOWN=1;cc.EventMouse.UP=2;cc.EventMouse.MOVE=3;cc.EventMouse.SCROLL=4;cc.EventMouse.BUTTON_LEFT=0;cc.EventMouse.BUTTON_RIGHT=2;cc.EventMouse.BUTTON_MIDDLE=1;cc.EventMouse.BUTTON_4=3;cc.EventMouse.BUTTON_5=4;cc.EventMouse.BUTTON_6=5;cc.EventMouse.BUTTON_7=6;cc.EventMouse.BUTTON_8=7;cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH);this._touches=a||[];},getEventCode:function(){return this._eventCode;},getTouches:function(){return this._touches;},_setEventCode:function(a){this._eventCode=a;},_setTouches:function(a){this._touches=a;}});cc.EventTouch.MAX_TOUCHES=5;cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3};cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(a,b){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS);this._widgetGetFocus=b;this._widgetLoseFocus=a;}});cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:false,_fixedPriority:0,_node:null,_paused:true,_isEnabled:true,ctor:function(b,a,c){this._onEvent=c;this._type=b||0;this._listenerID=a||"";},_setPaused:function(a){this._paused=a;},_isPaused:function(){return this._paused;},_setRegistered:function(a){this._registered=a;},_isRegistered:function(){return this._registered;},_getType:function(){return this._type;},_getListenerID:function(){return this._listenerID;},_setFixedPriority:function(a){this._fixedPriority=a;},_getFixedPriority:function(){return this._fixedPriority;},_setSceneGraphPriority:function(a){this._node=a;},_getSceneGraphPriority:function(){return this._node;},checkAvailable:function(){return this._onEvent!=null;},clone:function(){return null;},setEnabled:function(a){this._isEnabled=a;},isEnabled:function(){return this._isEnabled;},retain:function(){},release:function(){}});cc.EventListener.UNKNOWN=0;cc.EventListener.TOUCH_ONE_BY_ONE=1;cc.EventListener.TOUCH_ALL_AT_ONCE=2;cc.EventListener.KEYBOARD=3;cc.EventListener.MOUSE=4;cc.EventListener.ACCELERATION=5;cc.EventListener.ACCELERATION=6;cc.EventListener.CUSTOM=8;cc.EventListener.FOCUS=7;cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(a,d){this._onCustomEvent=d;var c=this;var b=function(e){if(c._onCustomEvent!=null){c._onCustomEvent(e);}};cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,a,b);},checkAvailable:function(){return(cc.EventListener.prototype.checkAvailable.call(this)&&this._onCustomEvent!=null);},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent);}});cc._EventListenerCustom.create=function(a,b){return new cc._EventListenerCustom(a,b);};cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var b=this;var a=function(d){var c=cc.EventMouse;switch(d._eventType){case c.DOWN:if(b.onMouseDown){b.onMouseDown(d);}break;case c.UP:if(b.onMouseUp){b.onMouseUp(d);}break;case c.MOVE:if(b.onMouseMove){b.onMouseMove(d);}break;case c.SCROLL:if(b.onMouseScroll){b.onMouseScroll(d);}break;default:break;}};cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,a);},clone:function(){var a=new cc._EventListenerMouse();a.onMouseDown=this.onMouseDown;a.onMouseUp=this.onMouseUp;a.onMouseMove=this.onMouseMove;a.onMouseScroll=this.onMouseScroll;return a;},checkAvailable:function(){return true;}});cc._EventListenerMouse.LISTENER_ID="__cc_mouse";cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse();};cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:false,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null);this._claimedTouches=[];},setSwallowTouches:function(a){this.swallowTouches=a;},isSwallowTouches:function(){return this.swallowTouches;},clone:function(){var a=new cc._EventListenerTouchOneByOne();a.onTouchBegan=this.onTouchBegan;a.onTouchMoved=this.onTouchMoved;a.onTouchEnded=this.onTouchEnded;a.onTouchCancelled=this.onTouchCancelled;a.swallowTouches=this.swallowTouches;return a;},checkAvailable:function(){if(!this.onTouchBegan){cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable);return false;}return true;}});cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one";cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne();};cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null);},clone:function(){var a=new cc._EventListenerTouchAllAtOnce();a.onTouchesBegan=this.onTouchesBegan;a.onTouchesMoved=this.onTouchesMoved;a.onTouchesEnded=this.onTouchesEnded;a.onTouchesCancelled=this.onTouchesCancelled;return a;},checkAvailable:function(){if(this.onTouchesBegan==null&&this.onTouchesMoved==null&&this.onTouchesEnded==null&&this.onTouchesCancelled==null){cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable);return false;}return true;}});cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once";cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce();};cc.EventListener.create=function(d){cc.assert(d&&d.event,cc._LogInfos.EventListener_create);var c=d.event;delete d.event;var b=null;if(c===cc.EventListener.TOUCH_ONE_BY_ONE){b=new cc._EventListenerTouchOneByOne();}else{if(c===cc.EventListener.TOUCH_ALL_AT_ONCE){b=new cc._EventListenerTouchAllAtOnce();}else{if(c===cc.EventListener.MOUSE){b=new cc._EventListenerMouse();}else{if(c===cc.EventListener.CUSTOM){b=new cc._EventListenerCustom(d.eventName,d.callback);delete d.eventName;delete d.callback;}else{if(c===cc.EventListener.KEYBOARD){b=new cc._EventListenerKeyboard();}else{if(c===cc.EventListener.ACCELERATION){b=new cc._EventListenerAcceleration(d.callback);delete d.callback;}else{if(c===cc.EventListener.FOCUS){b=new cc._EventListenerFocus();}}}}}}}for(var a in d){b[a]=d[a];}return b;};cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var a=new cc._EventListenerFocus();a.onFocusChanged=this.onFocusChanged;return a;},checkAvailable:function(){if(!this.onFocusChanged){cc.log("Invalid EventListenerFocus!");return false;}return true;},onFocusChanged:null,ctor:function(){var a=function(b){if(this.onFocusChanged){this.onFocusChanged(b._widgetLoseFocus,b._widgetGetFocus);}};cc.EventListener.prototype.ctor.call(this,cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,a);}});cc._EventListenerFocus.LISTENER_ID="__cc_focus_event";cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[];this._sceneGraphListeners=[];},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length;},empty:function(){return(this._fixedListeners.length===0)&&(this._sceneGraphListeners.length===0);},push:function(a){if(a._getFixedPriority()==0){this._sceneGraphListeners.push(a);}else{this._fixedListeners.push(a);}},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0;},clearFixedListeners:function(){this._fixedListeners.length=0;},clear:function(){this._sceneGraphListeners.length=0;this._fixedListeners.length=0;},getFixedPriorityListeners:function(){return this._fixedListeners;},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners;}});cc.__getListenerID=function(b){var a=cc.Event,c=b.getType();if(c===a.ACCELERATION){return cc._EventListenerAcceleration.LISTENER_ID;}if(c===a.CUSTOM){return b.getEventName();}if(c===a.KEYBOARD){return cc._EventListenerKeyboard.LISTENER_ID;}if(c===a.MOUSE){return cc._EventListenerMouse.LISTENER_ID;}if(c===a.FOCUS){return cc._EventListenerFocus.LISTENER_ID;}if(c===a.TOUCH){cc.log(cc._LogInfos.__getListenerID);}return"";};cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1<<0,DIRTY_SCENE_GRAPH_PRIORITY:1<<1,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:false,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(d){if(this._nodeListenersMap[d.__instanceId]!=null){this._dirtyNodes.push(d);}var c=d.getChildren();for(var b=0,a=c.length;b<a;b++){this._setDirtyForNode(c[b]);}},pauseTarget:function(f,c){var e=this._nodeListenersMap[f.__instanceId],d,a;if(e){for(d=0,a=e.length;d<a;d++){e[d]._setPaused(true);}}if(c===true){var b=f.getChildren();for(d=0,a=b.length;d<a;d++){this.pauseTarget(b[d],true);}}},resumeTarget:function(f,c){var e=this._nodeListenersMap[f.__instanceId],d,a;if(e){for(d=0,a=e.length;d<a;d++){e[d]._setPaused(false);}}this._setDirtyForNode(f);if(c===true){var b=f.getChildren();for(d=0,a=b.length;d<a;d++){this.resumeTarget(b[d],true);}}},_addListener:function(a){if(this._inDispatch===0){this._forceAddEventListener(a);}else{this._toAddedListeners.push(a);}},_forceAddEventListener:function(d){var a=d._getListenerID();var b=this._listenersMap[a];if(!b){b=new cc._EventListenerVector();this._listenersMap[a]=b;}b.push(d);if(d._getFixedPriority()==0){this._setDirty(a,this.DIRTY_SCENE_GRAPH_PRIORITY);var c=d._getSceneGraphPriority();if(c==null){cc.log(cc._LogInfos.eventManager__forceAddEventListener);}this._associateNodeAndEventListener(c,d);if(c.isRunning()){this.resumeTarget(c);}}else{this._setDirty(a,this.DIRTY_FIXED_PRIORITY);}},_getListeners:function(a){return this._listenersMap[a];},_updateDirtyFlagForSceneGraph:function(){if(this._dirtyNodes.length==0){return;}var h=this._dirtyNodes,b,e,f=this._nodeListenersMap;for(var d=0,a=h.length;d<a;d++){b=f[h[d].__instanceId];if(b){for(var c=0,g=b.length;c<g;c++){e=b[c];if(e){this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);}}}}this._dirtyNodes.length=0;},_removeAllListenersInVector:function(a){if(!a){return;}var c;for(var b=0;b<a.length;){c=a[b];c._setRegistered(false);if(c._getSceneGraphPriority()!=null){this._dissociateNodeAndEventListener(c._getSceneGraphPriority(),c);c._setSceneGraphPriority(null);}if(this._inDispatch===0){cc.arrayRemoveObject(a,c);}else{++b;}}},_removeListenersForListenerID:function(c){var d=this._listenersMap[c],b;if(d){var g=d.getFixedPriorityListeners();var e=d.getSceneGraphPriorityListeners();this._removeAllListenersInVector(e);this._removeAllListenersInVector(g);delete this._priorityDirtyFlagMap[c];if(!this._inDispatch){d.clear();delete this._listenersMap[c];}}var a=this._toAddedListeners,f;for(b=0;b<a.length;){f=a[b];if(f&&f._getListenerID()==c){cc.arrayRemoveObject(a,f);}else{++b;}}},_sortEventListeners:function(c){var d=this.DIRTY_NONE,b=this._priorityDirtyFlagMap;if(b[c]){d=b[c];}if(d!=this.DIRTY_NONE){b[c]=this.DIRTY_NONE;if(d&this.DIRTY_FIXED_PRIORITY){this._sortListenersOfFixedPriority(c);}if(d&this.DIRTY_SCENE_GRAPH_PRIORITY){var a=cc.director.getRunningScene();if(a){this._sortListenersOfSceneGraphPriority(c,a);}else{b[c]=this.DIRTY_SCENE_GRAPH_PRIORITY;}}}},_sortListenersOfSceneGraphPriority:function(b,a){var c=this._getListeners(b);if(!c){return;}var d=c.getSceneGraphPriorityListeners();if(!d||d.length===0){return;}this._nodePriorityIndex=0;this._nodePriorityMap={};this._visitTarget(a,true);c.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes);},_sortEventListenersOfSceneGraphPriorityDes:function(b,a){var c=cc.eventManager._nodePriorityMap;if(!b||!a||!b._getSceneGraphPriority()||!a._getSceneGraphPriority()){return -1;}return c[a._getSceneGraphPriority().__instanceId]-c[b._getSceneGraphPriority().__instanceId];},_sortListenersOfFixedPriority:function(d){var e=this._listenersMap[d];if(!e){return;}var b=e.getFixedPriorityListeners();if(!b||b.length===0){return;}b.sort(this._sortListenersOfFixedPriorityAsc);var c=0;for(var a=b.length;c<a;){if(b[c]._getFixedPriority()>=0){break;}++c;}e.gt0Index=c;},_sortListenersOfFixedPriorityAsc:function(b,a){return b._getFixedPriority()-a._getFixedPriority();},_onUpdateListeners:function(c){var d=this._listenersMap[c];if(!d){return;}var f=d.getFixedPriorityListeners();var e=d.getSceneGraphPriorityListeners();var b,a;if(e){for(b=0;b<e.length;){a=e[b];if(!a._isRegistered()){cc.arrayRemoveObject(e,a);}else{++b;}}}if(f){for(b=0;b<f.length;){a=f[b];if(!a._isRegistered()){cc.arrayRemoveObject(f,a);}else{++b;}}}if(e&&e.length===0){d.clearSceneGraphListeners();}if(f&&f.length===0){d.clearFixedListeners();}},_updateListeners:function(h){var f=this._inDispatch;cc.assert(f>0,cc._LogInfos.EventManager__updateListeners);if(h.getType()==cc.Event.TOUCH){this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);}else{this._onUpdateListeners(cc.__getListenerID(h));}if(f>1){return;}cc.assert(f==1,cc._LogInfos.EventManager__updateListeners_2);var c=this._listenersMap,g=this._priorityDirtyFlagMap;for(var e in c){if(c[e].empty()){delete g[e];delete c[e];}}var b=this._toAddedListeners;if(b.length!==0){for(var d=0,a=b.length;d<a;d++){this._forceAddEventListener(b[d]);}this._toAddedListeners.length=0;}},_onTouchEventCallback:function(d,h){if(!d._isRegistered){return false;}var c=h.event,e=h.selTouch;c._setCurrentTarget(d._node);var a=false,g;var f=c.getEventCode(),b=cc.EventTouch.EventCode;if(f==b.BEGAN){if(d.onTouchBegan){a=d.onTouchBegan(e,c);if(a&&d._registered){d._claimedTouches.push(e);}}}else{if(d._claimedTouches.length>0&&((g=d._claimedTouches.indexOf(e))!=-1)){a=true;if(f===b.MOVED&&d.onTouchMoved){d.onTouchMoved(e,c);}else{if(f===b.ENDED){if(d.onTouchEnded){d.onTouchEnded(e,c);}if(d._registered){d._claimedTouches.splice(g,1);}}else{if(f===b.CANCELLED){if(d.onTouchCancelled){d.onTouchCancelled(e,c);}if(d._registered){d._claimedTouches.splice(g,1);}}}}}}if(c.isStopped()){cc.eventManager._updateListeners(c);return true;}if(a&&d._registered&&d.swallowTouches){if(h.needsMutableSet){h.touches.splice(e,1);}return true;}return false;},_dispatchTouchEvent:function(f){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var g=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);var a=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null==g&&null==a){return;}var e=f.getTouches(),b=cc.copyArray(e);var d={event:f,needsMutableSet:(g&&a),touches:b,selTouch:null};if(g){for(var c=0;c<e.length;c++){d.selTouch=e[c];this._dispatchEventToListeners(g,this._onTouchEventCallback,d);if(f.isStopped()){return;}}}if(a&&b.length>0){this._dispatchEventToListeners(a,this._onTouchesEventCallback,{event:f,touches:b});if(f.isStopped()){return;}}this._updateListeners(f);},_onTouchesEventCallback:function(d,a){if(!d._registered){return false;}var b=cc.EventTouch.EventCode,c=a.event,e=a.touches,f=c.getEventCode();c._setCurrentTarget(d._node);if(f==b.BEGAN&&d.onTouchesBegan){d.onTouchesBegan(e,c);}else{if(f==b.MOVED&&d.onTouchesMoved){d.onTouchesMoved(e,c);}else{if(f==b.ENDED&&d.onTouchesEnded){d.onTouchesEnded(e,c);}else{if(f==b.CANCELLED&&d.onTouchesCancelled){d.onTouchesCancelled(e,c);}}}}if(c.isStopped()){cc.eventManager._updateListeners(c);return true;}return false;},_associateNodeAndEventListener:function(b,c){var a=this._nodeListenersMap[b.__instanceId];if(!a){a=[];this._nodeListenersMap[b.__instanceId]=a;}a.push(c);},_dissociateNodeAndEventListener:function(b,c){var a=this._nodeListenersMap[b.__instanceId];if(a){cc.arrayRemoveObject(a,c);if(a.length===0){delete this._nodeListenersMap[b.__instanceId];}}},_dispatchEventToListeners:function(h,k,a){var f=false;var c=h.getFixedPriorityListeners();var g=h.getSceneGraphPriorityListeners();var e=0,d,b;if(c){if(c.length!==0){for(;e<h.gt0Index;++e){b=c[e];if(b.isEnabled()&&!b._isPaused()&&b._isRegistered()&&k(b,a)){f=true;break;}}}}if(g&&!f){for(d=0;d<g.length;d++){b=g[d];if(b.isEnabled()&&!b._isPaused()&&b._isRegistered()&&k(b,a)){f=true;break;}}}if(c&&!f){for(;e<c.length;++e){b=c[e];if(b.isEnabled()&&!b._isPaused()&&b._isRegistered()&&k(b,a)){f=true;break;}}}},_setDirty:function(c,a){var b=this._priorityDirtyFlagMap;if(b[c]==null){b[c]=a;}else{b[c]=a|b[c];}},_visitTarget:function(e,q){var b=e.getChildren(),g=0;var h=b.length,k=this._globalZOrderNodeMap,m=this._nodeListenersMap;if(h>0){var a;for(;g<h;g++){a=b[g];if(a&&a.getLocalZOrder()<0){this._visitTarget(a,false);}else{break;}}if(m[e.__instanceId]!=null){if(!k[e.getGlobalZOrder()]){k[e.getGlobalZOrder()]=[];}k[e.getGlobalZOrder()].push(e.__instanceId);}for(;g<h;g++){a=b[g];if(a){this._visitTarget(a,false);}}}else{if(m[e.__instanceId]!=null){if(!k[e.getGlobalZOrder()]){k[e.getGlobalZOrder()]=[];}k[e.getGlobalZOrder()].push(e.__instanceId);}}if(q){var d=[];for(var c in k){d.push(c);}d.sort(this._sortNumberAsc);var o=d.length,p,f,n=this._nodePriorityMap;for(g=0;g<o;g++){p=k[d[g]];for(f=0;f<p.length;f++){n[p[f]]=++this._nodePriorityIndex;}}this._globalZOrderNodeMap={};}},_sortNumberAsc:function(d,c){return d-c;},addListener:function(b,a){cc.assert(b&&a,cc._LogInfos.eventManager_addListener_2);if(!(b instanceof cc.EventListener)){cc.assert(!cc.isNumber(a),cc._LogInfos.eventManager_addListener_3);b=cc.EventListener.create(b);}else{if(b._isRegistered()){cc.log(cc._LogInfos.eventManager_addListener_4);return;}}if(!b.checkAvailable()){return;}if(cc.isNumber(a)){if(a==0){cc.log(cc._LogInfos.eventManager_addListener);return;}b._setSceneGraphPriority(null);b._setFixedPriority(a);b._setRegistered(true);b._setPaused(false);this._addListener(b);}else{b._setSceneGraphPriority(a);b._setFixedPriority(0);b._setRegistered(true);this._addListener(b);}return b;},addCustomListener:function(a,c){var b=new cc._EventListenerCustom(a,c);this.addListener(b,1);return b;},removeListener:function(d){if(d==null){return;}var m,a=this._listenersMap;for(var e in a){var k=a[e];var c=k.getFixedPriorityListeners(),j=k.getSceneGraphPriorityListeners();m=this._removeListenerInVector(j,d);if(m){this._setDirty(d._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);}else{m=this._removeListenerInVector(c,d);if(m){this._setDirty(d._getListenerID(),this.DIRTY_FIXED_PRIORITY);}}if(k.empty()){delete this._priorityDirtyFlagMap[d._getListenerID()];delete a[e];}if(m){break;}}if(!m){var g=this._toAddedListeners;for(var f=0,h=g.length;f<h;f++){var b=g[f];if(b==d){cc.arrayRemoveObject(g,b);b._setRegistered(false);break;}}}},_removeListenerInVector:function(d,e){if(d==null){return false;}for(var c=0,a=d.length;c<a;c++){var b=d[c];if(b==e){b._setRegistered(false);if(b._getSceneGraphPriority()!=null){this._dissociateNodeAndEventListener(b._getSceneGraphPriority(),b);b._setSceneGraphPriority(null);}if(this._inDispatch==0){cc.arrayRemoveObject(d,b);}return true;}}return false;},removeListeners:function(c,d){var k=this;if(c instanceof cc.Node){delete k._nodePriorityMap[c.__instanceId];cc.arrayRemoveObject(k._dirtyNodes,c);var j=k._nodeListenersMap[c.__instanceId],e;if(j){var g=cc.copyArray(j);for(e=0;e<g.length;e++){k.removeListener(g[e]);}g.length=0;}var f=k._toAddedListeners;for(e=0;e<f.length;){var b=f[e];if(b._getSceneGraphPriority()==c){b._setSceneGraphPriority(null);b._setRegistered(false);f.splice(e,1);}else{++e;}}if(d===true){var a=c.getChildren(),h;for(e=0,h=a.length;e<h;e++){k.removeListeners(a[e],true);}}}else{if(c==cc.EventListener.TOUCH_ONE_BY_ONE){k._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID);}else{if(c==cc.EventListener.TOUCH_ALL_AT_ONCE){k._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID);}else{if(c==cc.EventListener.MOUSE){k._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID);}else{if(c==cc.EventListener.ACCELERATION){k._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID);}else{if(c==cc.EventListener.KEYBOARD){k._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID);}else{cc.log(cc._LogInfos.eventManager_removeListeners);}}}}}}},removeCustomListeners:function(a){this._removeListenersForListenerID(a);},removeAllListeners:function(){var c=this._listenersMap,b=this._internalCustomListenerIDs;for(var a in c){if(b.indexOf(a)===-1){this._removeListenersForListenerID(a);}}},setPriority:function(d,f){if(d==null){return;}var e=this._listenersMap;for(var b in e){var a=e[b];var g=a.getFixedPriorityListeners();if(g){var c=g.indexOf(d);if(c!=-1){if(d._getSceneGraphPriority()!=null){cc.log(cc._LogInfos.eventManager_setPriority);}if(d._getFixedPriority()!==f){d._setFixedPriority(f);this._setDirty(d._getListenerID(),this.DIRTY_FIXED_PRIORITY);}return;}}}},setEnabled:function(a){this._isEnabled=a;},isEnabled:function(){return this._isEnabled;},dispatchEvent:function(c){if(!this._isEnabled){return;}this._updateDirtyFlagForSceneGraph();this._inDispatch++;if(!c||!c.getType){throw"event is undefined";}if(c.getType()==cc.Event.TOUCH){this._dispatchTouchEvent(c);this._inDispatch--;return;}var b=cc.__getListenerID(c);this._sortEventListeners(b);var a=this._listenersMap[b];if(a!=null){this._dispatchEventToListeners(a,this._onListenerCallback,c);}this._updateListeners(c);this._inDispatch--;},_onListenerCallback:function(b,a){a._setCurrentTarget(b._getSceneGraphPriority());b._onEvent(a);return a.isStopped();},dispatchCustomEvent:function(a,b){var c=new cc.EventCustom(a);c.setUserData(b);this.dispatchEvent(c);}};cc.EventHelper=function(){};cc.EventHelper.prototype={constructor:cc.EventHelper,apply:function(a){a.addEventListener=cc.EventHelper.prototype.addEventListener;a.hasEventListener=cc.EventHelper.prototype.hasEventListener;a.removeEventListener=cc.EventHelper.prototype.removeEventListener;a.dispatchEvent=cc.EventHelper.prototype.dispatchEvent;},addEventListener:function(b,c,d){if(b==="load"&&this._textureLoaded){setTimeout(function(){c.call(d);},0);return;}if(this._listeners===undefined){this._listeners={};}var a=this._listeners;if(a[b]===undefined){a[b]=[];}if(!this.hasEventListener(b,c,d)){a[b].push({callback:c,eventTarget:d});}},hasEventListener:function(e,f,g){if(this._listeners===undefined){return false;}var d=this._listeners;if(d[e]!==undefined){for(var c=0,a=d.length;c<a;c++){var b=d[c];if(b.callback==f&&b.eventTarget==g){return true;}}}return false;},removeEventListener:function(e,f){if(this._listeners===undefined){return;}var d=this._listeners;var a=d[e];if(a!==undefined){for(var c=0;c<a.length;){var b=a[c];if(b.eventTarget==f){a.splice(c,1);}else{c++;}}}},dispatchEvent:function(f,b){if(this._listeners===undefined){return;}if(b==null){b=true;}var d=this._listeners;var a=d[f];if(a!==undefined){var g=[];var e=a.length;for(var c=0;c<e;c++){g[c]=a[c];}for(c=0;c<e;c++){g[c].callback.call(g[c].eventTarget,this);}if(b){a.length=0;}}}};cc._tmp.PrototypeCCNode=function(){var a=cc.Node.prototype;cc.defineGetterSetter(a,"x",a.getPositionX,a.setPositionX);cc.defineGetterSetter(a,"y",a.getPositionY,a.setPositionY);a.width;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);a.height;cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight);a.anchorX;cc.defineGetterSetter(a,"anchorX",a._getAnchorX,a._setAnchorX);a.anchorY;cc.defineGetterSetter(a,"anchorY",a._getAnchorY,a._setAnchorY);a.skewX;cc.defineGetterSetter(a,"skewX",a.getSkewX,a.setSkewX);a.skewY;cc.defineGetterSetter(a,"skewY",a.getSkewY,a.setSkewY);a.zIndex;cc.defineGetterSetter(a,"zIndex",a.getLocalZOrder,a.setLocalZOrder);a.vertexZ;cc.defineGetterSetter(a,"vertexZ",a.getVertexZ,a.setVertexZ);a.rotation;cc.defineGetterSetter(a,"rotation",a.getRotation,a.setRotation);a.rotationX;cc.defineGetterSetter(a,"rotationX",a.getRotationX,a.setRotationX);a.rotationY;cc.defineGetterSetter(a,"rotationY",a.getRotationY,a.setRotationY);a.scale;cc.defineGetterSetter(a,"scale",a.getScale,a.setScale);a.scaleX;cc.defineGetterSetter(a,"scaleX",a.getScaleX,a.setScaleX);a.scaleY;cc.defineGetterSetter(a,"scaleY",a.getScaleY,a.setScaleY);a.children;cc.defineGetterSetter(a,"children",a.getChildren);a.childrenCount;cc.defineGetterSetter(a,"childrenCount",a.getChildrenCount);a.parent;cc.defineGetterSetter(a,"parent",a.getParent,a.setParent);a.visible;cc.defineGetterSetter(a,"visible",a.isVisible,a.setVisible);a.running;cc.defineGetterSetter(a,"running",a.isRunning);a.ignoreAnchor;cc.defineGetterSetter(a,"ignoreAnchor",a.isIgnoreAnchorPointForPosition,a.ignoreAnchorPointForPosition);a.tag;a.userData;a.userObject;a.arrivalOrder;a.actionManager;cc.defineGetterSetter(a,"actionManager",a.getActionManager,a.setActionManager);a.scheduler;cc.defineGetterSetter(a,"scheduler",a.getScheduler,a.setScheduler);a.shaderProgram;cc.defineGetterSetter(a,"shaderProgram",a.getShaderProgram,a.setShaderProgram);a.opacity;cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.opacityModifyRGB;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB);a.cascadeOpacity;cc.defineGetterSetter(a,"cascadeOpacity",a.isCascadeOpacityEnabled,a.setCascadeOpacityEnabled);a.color;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.cascadeColor;cc.defineGetterSetter(a,"cascadeColor",a.isCascadeColorEnabled,a.setCascadeColorEnabled);};cc.NODE_TAG_INVALID=-1;cc.s_globalOrderOfArrival=1;cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:false,_normalizedPositionDirty:false,_skewX:0,_skewY:0,_children:null,_visible:true,_anchorPoint:null,_contentSize:null,_running:false,_parent:null,_ignoreAnchorPointForPosition:false,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:false,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,_additionalTransformDirty:false,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:false,_className:"Node",_showNode:false,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:false,_cascadeOpacityEnabled:false,_renderCmd:null,ctor:function(){this._initNode();this._initRendererCmd();},_initNode:function(){var b=this;b._anchorPoint=cc.p(0,0);b._contentSize=cc.size(0,0);b._position=cc.p(0,0);b._normalizedPosition=cc.p(0,0);b._children=[];var a=cc.director;b._actionManager=a.getActionManager();b._scheduler=a.getScheduler();b._additionalTransform=cc.affineTransformMakeIdentity();if(cc.ComponentContainer){b._componentContainer=new cc.ComponentContainer(b);}this._realOpacity=255;this._realColor=cc.color(255,255,255,255);this._cascadeColorEnabled=false;this._cascadeOpacityEnabled=false;},init:function(){return true;},_arrayMakeObjectsPerformSelector:function(f,e){if(!f||f.length===0){return;}var b,a=f.length,d;var c=cc.Node._stateCallbackType;switch(e){case c.onEnter:for(b=0;b<a;b++){d=f[b];if(d){d.onEnter();}}break;case c.onExit:for(b=0;b<a;b++){d=f[b];if(d){d.onExit();}}break;case c.onEnterTransitionDidFinish:for(b=0;b<a;b++){d=f[b];if(d){d.onEnterTransitionDidFinish();}}break;case c.cleanup:for(b=0;b<a;b++){d=f[b];if(d){d.cleanup();}}break;case c.updateTransform:for(b=0;b<a;b++){d=f[b];if(d){d.updateTransform();}}break;case c.onExitTransitionDidStart:for(b=0;b<a;b++){d=f[b];if(d){d.onExitTransitionDidStart();}}break;case c.sortAllChildren:for(b=0;b<a;b++){d=f[b];if(d){d.sortAllChildren();}}break;default:cc.assert(0,cc._LogInfos.Node__arrayMakeObjectsPerformSelector);break;}},attr:function(a){for(var b in a){this[b]=a[b];}},getSkewX:function(){return this._skewX;},setSkewX:function(a){this._skewX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getSkewY:function(){return this._skewY;},setSkewY:function(a){this._skewY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},setLocalZOrder:function(a){this._localZOrder=a;if(this._parent){this._parent.reorderChild(this,a);}cc.eventManager._setDirtyForNode(this);},_setLocalZOrder:function(a){this._localZOrder=a;},getLocalZOrder:function(){return this._localZOrder;},getZOrder:function(){cc.log(cc._LogInfos.Node_getZOrder);return this.getLocalZOrder();},setZOrder:function(a){cc.log(cc._LogInfos.Node_setZOrder);this.setLocalZOrder(a);},setGlobalZOrder:function(a){if(this._globalZOrder!=a){this._globalZOrder=a;cc.eventManager._setDirtyForNode(this);}},getGlobalZOrder:function(){return this._globalZOrder;},getVertexZ:function(){return this._vertexZ;},setVertexZ:function(a){this._vertexZ=a;},getRotation:function(){if(this._rotationX!==this._rotationY){cc.log(cc._LogInfos.Node_getRotation);}return this._rotationX;},setRotation:function(a){this._rotationX=this._rotationY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getRotationX:function(){return this._rotationX;},setRotationX:function(a){this._rotationX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getRotationY:function(){return this._rotationY;},setRotationY:function(a){this._rotationY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getScale:function(){if(this._scaleX!==this._scaleY){cc.log(cc._LogInfos.Node_getScale);}return this._scaleX;},setScale:function(b,a){this._scaleX=b;this._scaleY=(a||a===0)?a:b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getScaleX:function(){return this._scaleX;},setScaleX:function(a){this._scaleX=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getScaleY:function(){return this._scaleY;},setScaleY:function(a){this._scaleY=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},setPosition:function(a,b){var c=this._position;if(b===undefined){if(c.x===a.x&&c.y===a.y){return;}c.x=a.x;c.y=a.y;}else{if(c.x===a.x&&c.y===b){return;}c.x=a;c.y=b;}this._usingNormalizedPosition=false;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},setNormalizedPosition:function(a,c){var b=this._normalizedPosition;if(c===undefined){b.x=a.x;b.y=a.y;}else{b.x=a;b.y=c;}this._normalizedPositionDirty=this._usingNormalizedPosition=true;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getPosition:function(){return cc.p(this._position);},getNormalizedPosition:function(){return cc.p(this._normalizedPosition);},getPositionX:function(){return this._position.x;},setPositionX:function(a){this._position.x=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getPositionY:function(){return this._position.y;},setPositionY:function(a){this._position.y=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},getChildrenCount:function(){return this._children.length;},getChildren:function(){return this._children;},isVisible:function(){return this._visible;},setVisible:function(a){if(this._visible!==a){this._visible=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);cc.renderer.childrenOrderDirty=true;}},getAnchorPoint:function(){return cc.p(this._anchorPoint);},setAnchorPoint:function(a,c){var b=this._anchorPoint;if(c===undefined){if((a.x===b.x)&&(a.y===b.y)){return;}b.x=a.x;b.y=a.y;}else{if((a===b.x)&&(c===b.y)){return;}b.x=a;b.y=c;}this._renderCmd._updateAnchorPointInPoint();},_getAnchorX:function(){return this._anchorPoint.x;},_setAnchorX:function(a){if(this._anchorPoint.x===a){return;}this._anchorPoint.x=a;this._renderCmd._updateAnchorPointInPoint();},_getAnchorY:function(){return this._anchorPoint.y;},_setAnchorY:function(a){if(this._anchorPoint.y===a){return;}this._anchorPoint.y=a;this._renderCmd._updateAnchorPointInPoint();},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints();},_getWidth:function(){return this._contentSize.width;},_setWidth:function(a){this._contentSize.width=a;this._renderCmd._updateAnchorPointInPoint();},_getHeight:function(){return this._contentSize.height;},_setHeight:function(a){this._contentSize.height=a;this._renderCmd._updateAnchorPointInPoint();},getContentSize:function(){return cc.size(this._contentSize);},setContentSize:function(b,a){var c=this._contentSize;if(a===undefined){if((b.width===c.width)&&(b.height===c.height)){return;}c.width=b.width;c.height=b.height;}else{if((b===c.width)&&(a===c.height)){return;}c.width=b;c.height=a;}this._renderCmd._updateAnchorPointInPoint();},isRunning:function(){return this._running;},getParent:function(){return this._parent;},setParent:function(a){this._parent=a;},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition;},ignoreAnchorPointForPosition:function(a){if(a!=this._ignoreAnchorPointForPosition){this._ignoreAnchorPointForPosition=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);}},getTag:function(){return this.tag;},setTag:function(a){this.tag=a;},setName:function(a){this._name=a;},getName:function(){return this._name;},getUserData:function(){return this.userData;},setUserData:function(a){this.userData=a;},getUserObject:function(){return this.userObject;},setUserObject:function(a){if(this.userObject!=a){this.userObject=a;}},getOrderOfArrival:function(){return this.arrivalOrder;},setOrderOfArrival:function(a){this.arrivalOrder=a;},getActionManager:function(){if(!this._actionManager){this._actionManager=cc.director.getActionManager();}return this._actionManager;},setActionManager:function(a){if(this._actionManager!=a){this.stopAllActions();this._actionManager=a;}},getScheduler:function(){if(!this._scheduler){this._scheduler=cc.director.getScheduler();}return this._scheduler;},setScheduler:function(a){if(this._scheduler!=a){this.unscheduleAllCallbacks();this._scheduler=a;}},boundingBox:function(){cc.log(cc._LogInfos.Node_boundingBox);return this.getBoundingBox();},getBoundingBox:function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(a,this.getNodeToParentTransform());},cleanup:function(){this.stopAllActions();this.unscheduleAllCallbacks();cc.eventManager.removeListeners(this);this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup);},getChildByTag:function(a){var d=this._children;if(d!=null){for(var b=0;b<d.length;b++){var c=d[b];if(c&&c.tag==a){return c;}}}return null;},getChildByName:function(c){if(!c){cc.log("Invalid name");return null;}var b=this._children;for(var d=0,a=b.length;d<a;d++){if(b[d]._name==c){return b[d];}}return null;},addChild:function(e,c,a){c=c===undefined?e._localZOrder:c;var b,d=false;if(cc.isUndefined(a)){a=undefined;b=e._name;}else{if(cc.isString(a)){b=a;a=undefined;}else{if(cc.isNumber(a)){d=true;b="";}}}cc.assert(e,cc._LogInfos.Node_addChild_3);cc.assert(e._parent===null,"child already added. It can't be added again");this._addChildHelper(e,c,a,b,d);},_addChildHelper:function(e,c,a,b,d){if(!this._children){this._children=[];}this._insertChild(e,c);if(d){e.setTag(a);}else{e.setName(b);}e.setParent(this);e.setOrderOfArrival(cc.s_globalOrderOfArrival++);if(this._running){e.onEnter();if(this._isTransitionFinished){e.onEnterTransitionDidFinish();}}if(this._cascadeColorEnabled){e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);}if(this._cascadeOpacityEnabled){e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);}},removeFromParent:function(a){if(this._parent){if(a==null){a=true;}this._parent.removeChild(this,a);}},removeFromParentAndCleanup:function(a){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup);this.removeFromParent(a);},removeChild:function(b,a){if(this._children.length===0){return;}if(a==null){a=true;}if(this._children.indexOf(b)>-1){this._detachChild(b,a);}cc.renderer.childrenOrderDirty=true;},removeChildByTag:function(a,b){if(a===cc.NODE_TAG_INVALID){cc.log(cc._LogInfos.Node_removeChildByTag);}var c=this.getChildByTag(a);if(c==null){cc.log(cc._LogInfos.Node_removeChildByTag_2,a);}else{this.removeChild(c,b);}},removeAllChildrenWithCleanup:function(a){this.removeAllChildren(a);},removeAllChildren:function(b){var d=this._children;if(d!=null){if(b==null){b=true;}for(var a=0;a<d.length;a++){var c=d[a];if(c){if(this._running){c.onExitTransitionDidStart();c.onExit();}if(b){c.cleanup();}c.parent=null;}}this._children.length=0;}},_detachChild:function(b,a){if(this._running){b.onExitTransitionDidStart();b.onExit();}if(a){b.cleanup();}b.parent=null;b._renderCmd.detachFromParent();cc.arrayRemoveObject(this._children,b);},_insertChild:function(b,a){cc.renderer.childrenOrderDirty=this._reorderChildDirty=true;this._children.push(b);b._setLocalZOrder(a);},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},reorderChild:function(b,a){cc.assert(b,cc._LogInfos.Node_reorderChild);cc.renderer.childrenOrderDirty=this._reorderChildDirty=true;b.arrivalOrder=cc.s_globalOrderOfArrival;cc.s_globalOrderOfArrival++;b._setLocalZOrder(a);},sortAllChildren:function(){if(this._reorderChildDirty){var e=this._children;var a=e.length,d,b,c;for(d=1;d<a;d++){c=e[d];b=d-1;while(b>=0){if(c._localZOrder<e[b]._localZOrder){e[b+1]=e[b];}else{if(c._localZOrder===e[b]._localZOrder&&c.arrivalOrder<e[b].arrivalOrder){e[b+1]=e[b];}else{break;}}b--;}e[b+1]=c;}this._reorderChildDirty=false;}},draw:function(a){},transformAncestors:function(){if(this._parent!=null){this._parent.transformAncestors();this._parent.transform();}},onEnter:function(){this._isTransitionFinished=false;this._running=true;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnter);this.resume();},onEnterTransitionDidFinish:function(){this._isTransitionFinished=true;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnterTransitionDidFinish);},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExitTransitionDidStart);},onExit:function(){this._running=false;this.pause();this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExit);this.removeAllComponents();},runAction:function(a){cc.assert(a,cc._LogInfos.Node_runAction);this.actionManager.addAction(a,this,!this._running);return a;},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this);},stopAction:function(a){this.actionManager.removeAction(a);},stopActionByTag:function(a){if(a===cc.ACTION_TAG_INVALID){cc.log(cc._LogInfos.Node_stopActionByTag);return;}this.actionManager.removeActionByTag(a,this);},getActionByTag:function(a){if(a===cc.ACTION_TAG_INVALID){cc.log(cc._LogInfos.Node_getActionByTag);return null;}return this.actionManager.getActionByTag(a,this);},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this);},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0);},scheduleUpdateWithPriority:function(a){this.scheduler.scheduleUpdateForTarget(this,a,!this._running);},unscheduleUpdate:function(){this.scheduler.unscheduleUpdateForTarget(this);},schedule:function(d,a,c,b){a=a||0;cc.assert(d,cc._LogInfos.Node_schedule);cc.assert(a>=0,cc._LogInfos.Node_schedule_2);c=(c==null)?cc.REPEAT_FOREVER:c;b=b||0;this.scheduler.scheduleCallbackForTarget(this,d,a,c,b,!this._running);},scheduleOnce:function(b,a){this.schedule(b,0,0,a);},unschedule:function(a){if(!a){return;}this.scheduler.unscheduleCallbackForTarget(this,a);},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllCallbacksForTarget(this);},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions);this.resume();},resume:function(){this.scheduler.resumeTarget(this);this.actionManager&&this.actionManager.resumeTarget(this);cc.eventManager.resumeTarget(this);},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions);this.pause();},pause:function(){this.scheduler.pauseTarget(this);this.actionManager&&this.actionManager.pauseTarget(this);cc.eventManager.pauseTarget(this);},setAdditionalTransform:function(a){this._additionalTransform=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);this._additionalTransformDirty=true;},getParentToNodeTransform:function(){this._renderCmd.getParentToNodeTransform();},parentToNodeTransform:function(){return this.getParentToNodeTransform();},getNodeToWorldTransform:function(){var a=this.getNodeToParentTransform();for(var b=this._parent;b!=null;b=b.parent){a=cc.affineTransformConcat(a,b.getNodeToParentTransform());}return a;},nodeToWorldTransform:function(){return this.getNodeToWorldTransform();},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform());},worldToNodeTransform:function(){return this.getWorldToNodeTransform();},convertToNodeSpace:function(a){return cc.pointApplyAffineTransform(a,this.getWorldToNodeTransform());},convertToWorldSpace:function(a){a=a||cc.p(0,0);return cc.pointApplyAffineTransform(a,this.getNodeToWorldTransform());},convertToNodeSpaceAR:function(a){return cc.pSub(this.convertToNodeSpace(a),this._renderCmd.getAnchorPointInPoints());},convertToWorldSpaceAR:function(a){a=a||cc.p(0,0);var b=cc.pAdd(a,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(b);},_convertToWindowSpace:function(b){var a=this.convertToWorldSpace(b);return cc.director.convertToUI(a);},convertTouchToNodeSpace:function(b){var a=b.getLocation();return this.convertToNodeSpace(a);},convertTouchToNodeSpaceAR:function(b){var a=cc.director.convertToGL(b.getLocation());return this.convertToNodeSpaceAR(a);},update:function(a){if(this._componentContainer&&!this._componentContainer.isEmpty()){this._componentContainer.visit(a);}},updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.updateTransform);},retain:function(){},release:function(){},getComponent:function(a){if(this._componentContainer){return this._componentContainer.getComponent(a);}return null;},addComponent:function(a){if(this._componentContainer){this._componentContainer.add(a);}},removeComponent:function(a){if(this._componentContainer){return this._componentContainer.remove(a);}return false;},removeAllComponents:function(){if(this._componentContainer){this._componentContainer.removeAll();}},grid:null,visit:function(a){this._renderCmd.visit(a);},transform:function(b,a){this._renderCmd.transform(b,a);},nodeToParentTransform:function(){return this.getNodeToParentTransform();},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform();},getCamera:function(){if(!this._camera){this._camera=new cc.Camera();}return this._camera;},getGrid:function(){return this.grid;},setGrid:function(a){this.grid=a;},getShaderProgram:function(){return this._renderCmd.getShaderProgram();},setShaderProgram:function(a){this._renderCmd.setShaderProgram(a);},getGLServerState:function(){return 0;},setGLServerState:function(a){},getBoundingBoxToWorld:function(){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height);var d=this.getNodeToWorldTransform();e=cc.rectApplyAffineTransform(e,d);if(!this._children){return e;}var a=this._children;for(var c=0;c<a.length;c++){var f=a[c];if(f&&f._visible){var b=f._getBoundingBoxToCurrentNode(d);if(b){e=cc.rectUnion(e,b);}}}return e;},_getBoundingBoxToCurrentNode:function(a){var f=cc.rect(0,0,this._contentSize.width,this._contentSize.height);var e=(a==null)?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),a);f=cc.rectApplyAffineTransform(f,e);if(!this._children){return f;}var b=this._children;for(var d=0;d<b.length;d++){var g=b[d];if(g&&g._visible){var c=g._getBoundingBoxToCurrentNode(e);if(c){f=cc.rectUnion(f,c);}}}return f;},getOpacity:function(){return this._realOpacity;},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity();},setOpacity:function(a){this._realOpacity=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);},updateDisplayedOpacity:function(a){this._renderCmd._updateDisplayOpacity(a);},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled;},setCascadeOpacityEnabled:function(a){if(this._cascadeOpacityEnabled===a){return;}this._cascadeOpacityEnabled=a;this._renderCmd.setCascadeOpacityEnabledDirty();},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a);},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor();},setColor:function(a){var b=this._realColor;b.r=a.r;b.g=a.g;b.b=a.b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);},updateDisplayedColor:function(a){this._renderCmd._updateDisplayColor(a);},isCascadeColorEnabled:function(){return this._cascadeColorEnabled;},setCascadeColorEnabled:function(a){if(this._cascadeColorEnabled===a){return;}this._cascadeColorEnabled=a;this._renderCmd.setCascadeColorEnabledDirty();},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return false;},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.Node.CanvasRenderCmd(this);}else{return new cc.Node.WebGLRenderCmd(this);}}});cc.Node.create=function(){return new cc.Node();};cc.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7};cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js");cc._tmp.PrototypeCCNode();delete cc._tmp.PrototypeCCNode;cc.CustomRenderCmd=function(b,a){this._needDraw=true;this._target=b;this._callback=a;this.rendering=function(c,e,d){if(!this._callback){return;}this._callback.call(this._target,c,e,d);};};cc.Node._dirtyFlags={transformDirty:1<<0,visibleDirty:1<<1,colorDirty:1<<2,opacityDirty:1<<3,cacheDirty:1<<4,orderDirty:1<<5,textDirty:1<<6,gradientDirty:1<<7,all:(1<<8)-1};cc.Node.RenderCmd=function(a){this._dirtyFlag=1;this._node=a;this._needDraw=false;this._anchorPointInPoints=new cc.Point(0,0);this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0};this._displayedOpacity=255;this._displayedColor=cc.color(255,255,255,255);this._cascadeColorEnabledDirty=false;this._cascadeOpacityEnabledDirty=false;this._curLevel=-1;};cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints);},getDisplayedColor:function(){var a=this._displayedColor;return cc.color(a.r,a.g,a.b,a.a);},getDisplayedOpacity:function(){return this._displayedOpacity;},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=true;this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=true;this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);},getParentToNodeTransform:function(){if(this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform());}return this._inverse;},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var c=this._anchorPointInPoints,a=this._node._contentSize,b=this._node._anchorPoint;c.x=a.width*b.x;c.y=a.height*b.y;this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);},setDirtyFlag:function(a){if(this._dirtyFlag===0&&a!==0){cc.renderer.pushDirtyNode(this);}this._dirtyFlag|=a;},getParentRenderCmd:function(){if(this._node&&this._node._parent&&this._node._parent._renderCmd){return this._node._parent._renderCmd;}return null;},_updateDisplayColor:function(a){var d=this._node;var j=this._displayedColor,g=d._realColor;var e,h,b,k;if(this._cascadeColorEnabledDirty&&!d._cascadeColorEnabled){j.r=g.r;j.g=g.g;j.b=g.b;var c=new cc.Color(255,255,255,255);b=d._children;for(e=0,h=b.length;e<h;e++){k=b[e];if(k&&k._renderCmd){k._renderCmd._updateDisplayColor(c);}}this._cascadeColorEnabledDirty=false;}else{if(a===undefined){var f=d._parent;if(f&&f._cascadeColorEnabled){a=f.getDisplayedColor();}else{a=cc.color.WHITE;}}j.r=0|(g.r*a.r/255);j.g=0|(g.g*a.g/255);j.b=0|(g.b*a.b/255);if(d._cascadeColorEnabled){b=d._children;for(e=0,h=b.length;e<h;e++){k=b[e];if(k&&k._renderCmd){k._renderCmd._updateDisplayColor(j);k._renderCmd._updateColor();}}}}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty^this._dirtyFlag;},_updateDisplayOpacity:function(b){var g=this._node;var e,a,c,f;if(this._cascadeOpacityEnabledDirty&&!g._cascadeOpacityEnabled){this._displayedOpacity=g._realOpacity;c=g._children;for(e=0,a=c.length;e<a;e++){f=c[e];if(f&&f._renderCmd){f._renderCmd._updateDisplayOpacity(255);}}this._cascadeOpacityEnabledDirty=false;}else{if(b===undefined){var d=g._parent;b=255;if(d&&d._cascadeOpacityEnabled){b=d.getDisplayedOpacity();}}this._displayedOpacity=g._realOpacity*b/255;if(g._cascadeOpacityEnabled){c=g._children;for(e=0,a=c.length;e<a;e++){f=c[e];if(f&&f._renderCmd){f._renderCmd._updateDisplayOpacity(this._displayedOpacity);f._renderCmd._updateColor();}}}}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty^this._dirtyFlag;},_syncDisplayColor:function(a){var c=this._node,d=this._displayedColor,e=c._realColor;if(a===undefined){var b=c._parent;if(b&&b._cascadeColorEnabled){a=b.getDisplayedColor();}else{a=cc.color.WHITE;}}d.r=0|(e.r*a.r/255);d.g=0|(e.g*a.g/255);d.b=0|(e.b*a.b/255);},_syncDisplayOpacity:function(a){var c=this._node;if(a===undefined){var b=c._parent;a=255;if(b&&b._cascadeOpacityEnabled){a=b.getDisplayedOpacity();}}this._displayedOpacity=c._realOpacity*a/255;},_updateColor:function(){},updateStatus:function(){var b=cc.Node._dirtyFlags,c=this._dirtyFlag;var a=c&b.colorDirty,d=c&b.opacityDirty;if(a){this._updateDisplayColor();}if(d){this._updateDisplayOpacity();}if(a||d){this._updateColor();}if(c&b.transformDirty){this.transform(this.getParentRenderCmd(),true);this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag;}}};(function(){cc.Node.CanvasRenderCmd=function(b){cc.Node.RenderCmd.call(this,b);this._cachedParent=null;this._cacheDirty=false;};var a=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);a.constructor=cc.Node.CanvasRenderCmd;a.transform=function(d,e){var m=this.getNodeToParentTransform(),c=this._worldTransform;if(d){var n=d._worldTransform;c.a=m.a*n.a+m.b*n.c;c.b=m.a*n.b+m.b*n.d;c.c=m.c*n.a+m.d*n.c;c.d=m.c*n.b+m.d*n.d;var k=d._transform;var j=-(k.b+k.c)*m.ty;var f=-(k.b+k.c)*m.tx;c.tx=(m.tx*n.a+m.ty*n.c+n.tx+j);c.ty=(m.tx*n.b+m.ty*n.d+n.ty+f);}else{c.a=m.a;c.b=m.b;c.c=m.c;c.d=m.d;c.tx=m.tx;c.ty=m.ty;}if(e){var b=this._node._children;if(!b||b.length===0){return;}var g,h;for(g=0,h=b.length;g<h;g++){b[g]._renderCmd.transform(this,e);}}};a.getNodeToParentTransform=function(){var e=this._node,h=false;if(e._usingNormalizedPosition&&e._parent){var k=e._parent._contentSize;e._position.x=e._normalizedPosition.x*k.width;e._position.y=e._normalizedPosition.y*k.height;e._normalizedPositionDirty=false;h=true;}if(h||(this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)){var r=this._transform;r.tx=e._position.x;r.ty=e._position.y;var s=1,p=0;if(e._rotationX){var m=e._rotationX*0.017453292519943295;s=Math.cos(m);p=Math.sin(m);}r.a=r.d=s;r.b=-p;r.c=p;var j=e._scaleX,g=e._scaleY;var d=this._anchorPointInPoints.x,c=this._anchorPointInPoints.y;var q=(j<0.000001&&j>-0.000001)?0.000001:j,o=(g<0.000001&&g>-0.000001)?0.000001:g;if(e._skewX||e._skewY){var i=Math.tan(-e._skewX*Math.PI/180);var f=Math.tan(-e._skewY*Math.PI/180);if(i===Infinity){i=99999999;}if(f===Infinity){f=99999999;}var b=c*i*q;var n=d*f*o;r.a=s+-p*f;r.b=s*i+-p;r.c=p+s*f;r.d=p*i+s;r.tx+=s*b+-p*n;r.ty+=p*b+s*n;}if(j!==1||g!==1){r.a*=q;r.c*=q;r.b*=o;r.d*=o;}r.tx+=s*-d*q+-p*c*o;r.ty-=p*-d*q+s*c*o;if(e._ignoreAnchorPointForPosition){r.tx+=d;r.ty+=c;}if(e._additionalTransformDirty){this._transform=cc.affineTransformConcat(r,e._additionalTransform);e._additionalTransformDirty=false;}}return this._transform;};a.visit=function(f){var e=this._node;if(!e._visible){return;}f=f||this.getParentRenderCmd();if(f){this._curLevel=f._curLevel+1;}var d,c=e._children,g;this._syncStatus(f);var b=c.length;if(b>0){e.sortAllChildren();for(d=0;d<b;d++){g=c[d];if(g._localZOrder<0){g._renderCmd.visit(this);}else{break;}}cc.renderer.pushRenderCommand(this);for(;d<b;d++){c[d]._renderCmd.visit(this);}}else{cc.renderer.pushRenderCommand(this);}this._dirtyFlag=0;};a._syncStatus=function(f){var d=cc.Node._dirtyFlags,g=this._dirtyFlag;var b=f?f._node:null;if(b&&b._cascadeColorEnabled&&(f._dirtyFlag&d.colorDirty)){g|=d.colorDirty;}if(b&&b._cascadeOpacityEnabled&&(f._dirtyFlag&d.opacityDirty)){g|=d.opacityDirty;}if(f&&(f._dirtyFlag&d.transformDirty)){g|=d.transformDirty;}var c=g&d.colorDirty,h=g&d.opacityDirty,e=g&d.transformDirty;this._dirtyFlag=g;if(c){this._syncDisplayColor();}if(h){this._syncDisplayOpacity();}if(c){this._updateColor();}if(e){this.transform(f);}};a.setDirtyFlag=function(b){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,b);this._setCacheDirty();if(this._cachedParent){this._cachedParent.setDirtyFlag(b);}};a._setCacheDirty=function(){if(this._cacheDirty===false){this._cacheDirty=true;var b=this._cachedParent;b&&b!=this&&b._setNodeDirtyForCache&&b._setNodeDirtyForCache();}};a._setCachedParent=function(e){if(this._cachedParent==e){return;}this._cachedParent=e;var d=this._node._children;for(var c=0,b=d.length;c<b;c++){d[c]._renderCmd._setCachedParent(e);}};a.detachFromParent=function(){this._cachedParent=null;var c=this._node._children,e;for(var d=0,b=c.length;d<b;d++){e=c[d];if(e&&e._renderCmd){e._renderCmd.detachFromParent();}}};a.setShaderProgram=function(b){};a.getShaderProgram=function(){return null;};cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(b){if(!b){return"source-over";}else{if((b.src==cc.SRC_ALPHA&&b.dst==cc.ONE)||(b.src==cc.ONE&&b.dst==cc.ONE)){return"lighter";}else{if(b.src==cc.ZERO&&b.dst==cc.SRC_ALPHA){return"destination-in";}else{if(b.src==cc.ZERO&&b.dst==cc.ONE_MINUS_SRC_ALPHA){return"destination-out";}else{return"source-over";}}}}};})();cc._tmp.PrototypeTexture2D=function(){var d=cc.Texture2D;d.PVRImagesHavePremultipliedAlpha=function(e){cc.PVRHaveAlphaPremultiplied_=e;};d.PIXEL_FORMAT_RGBA8888=2;d.PIXEL_FORMAT_RGB888=3;d.PIXEL_FORMAT_RGB565=4;d.PIXEL_FORMAT_A8=5;d.PIXEL_FORMAT_I8=6;d.PIXEL_FORMAT_AI88=7;d.PIXEL_FORMAT_RGBA4444=8;d.PIXEL_FORMAT_RGB5A1=7;d.PIXEL_FORMAT_PVRTC4=9;d.PIXEL_FORMAT_PVRTC2=10;d.PIXEL_FORMAT_DEFAULT=d.PIXEL_FORMAT_RGBA8888;var c=cc.Texture2D._M={};c[d.PIXEL_FORMAT_RGBA8888]="RGBA8888";c[d.PIXEL_FORMAT_RGB888]="RGB888";c[d.PIXEL_FORMAT_RGB565]="RGB565";c[d.PIXEL_FORMAT_A8]="A8";c[d.PIXEL_FORMAT_I8]="I8";c[d.PIXEL_FORMAT_AI88]="AI88";c[d.PIXEL_FORMAT_RGBA4444]="RGBA4444";c[d.PIXEL_FORMAT_RGB5A1]="RGB5A1";c[d.PIXEL_FORMAT_PVRTC4]="PVRTC4";c[d.PIXEL_FORMAT_PVRTC2]="PVRTC2";var b=cc.Texture2D._B={};b[d.PIXEL_FORMAT_RGBA8888]=32;b[d.PIXEL_FORMAT_RGB888]=24;b[d.PIXEL_FORMAT_RGB565]=16;b[d.PIXEL_FORMAT_A8]=8;b[d.PIXEL_FORMAT_I8]=8;b[d.PIXEL_FORMAT_AI88]=16;b[d.PIXEL_FORMAT_RGBA4444]=16;b[d.PIXEL_FORMAT_RGB5A1]=16;b[d.PIXEL_FORMAT_PVRTC4]=4;b[d.PIXEL_FORMAT_PVRTC2]=3;var a=cc.Texture2D.prototype;a.name;cc.defineGetterSetter(a,"name",a.getName);a.pixelFormat;cc.defineGetterSetter(a,"pixelFormat",a.getPixelFormat);a.pixelsWidth;cc.defineGetterSetter(a,"pixelsWidth",a.getPixelsWide);a.pixelsHeight;cc.defineGetterSetter(a,"pixelsHeight",a.getPixelsHigh);a.width;cc.defineGetterSetter(a,"width",a._getWidth);a.height;cc.defineGetterSetter(a,"height",a._getHeight);d.defaultPixelFormat=d.PIXEL_FORMAT_DEFAULT;};cc._tmp.PrototypeTextureAtlas=function(){var a=cc.TextureAtlas.prototype;a.totalQuads;cc.defineGetterSetter(a,"totalQuads",a.getTotalQuads);a.capacity;cc.defineGetterSetter(a,"capacity",a.getCapacity);a.quads;cc.defineGetterSetter(a,"quads",a.getQuads,a.setQuads);};cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:true,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:false,_hasMipmaps:false,shaderProgram:null,_textureLoaded:false,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=cc.size(0,0);this._pixelFormat=cc.Texture2D.defaultPixelFormat;},releaseTexture:function(){if(this._webTextureObj){cc._renderContext.deleteTexture(this._webTextureObj);}cc.loader.release(this.url);},getPixelFormat:function(){return this._pixelFormat;},getPixelsWide:function(){return this._pixelsWide;},getPixelsHigh:function(){return this._pixelsHigh;},getName:function(){return this._webTextureObj;},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),this._contentSize.height/cc.contentScaleFactor());},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor();},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor();},getContentSizeInPixels:function(){return this._contentSize;},getMaxS:function(){return this.maxS;},setMaxS:function(a){this.maxS=a;},getMaxT:function(){return this.maxT;},setMaxT:function(a){this.maxT=a;},getShaderProgram:function(){return this.shaderProgram;},setShaderProgram:function(a){this.shaderProgram=a;},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha;},hasMipmaps:function(){return this._hasMipmaps;},description:function(){var a=this;return"<cc.Texture2D | Name = "+a._name+" | Dimensions = "+a._pixelsWide+" x "+a._pixelsHigh+" | Coordinates = ("+a.maxS+", "+a.maxT+")>";},releaseData:function(a){a=null;},keepData:function(b,a){return b;},initWithData:function(e,b,g,c,a){var m=this,k=cc.Texture2D;var f=cc._renderContext;var i=f.RGBA,h=f.UNSIGNED_BYTE;var j=cc.Texture2D._B[b];var d=g*j/8;if(d%8===0){f.pixelStorei(f.UNPACK_ALIGNMENT,8);}else{if(d%4===0){f.pixelStorei(f.UNPACK_ALIGNMENT,4);}else{if(d%2===0){f.pixelStorei(f.UNPACK_ALIGNMENT,2);}else{f.pixelStorei(f.UNPACK_ALIGNMENT,1);}}}m._webTextureObj=f.createTexture();cc.glBindTexture2D(m);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);switch(b){case k.PIXEL_FORMAT_RGBA8888:i=f.RGBA;break;case k.PIXEL_FORMAT_RGB888:i=f.RGB;break;case k.PIXEL_FORMAT_RGBA4444:h=f.UNSIGNED_SHORT_4_4_4_4;break;case k.PIXEL_FORMAT_RGB5A1:h=f.UNSIGNED_SHORT_5_5_5_1;break;case k.PIXEL_FORMAT_RGB565:h=f.UNSIGNED_SHORT_5_6_5;break;case k.PIXEL_FORMAT_AI88:i=f.LUMINANCE_ALPHA;break;case k.PIXEL_FORMAT_A8:i=f.ALPHA;break;case k.PIXEL_FORMAT_I8:i=f.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData);}f.texImage2D(f.TEXTURE_2D,0,i,g,c,0,i,h,e);m._contentSize.width=a.width;m._contentSize.height=a.height;m._pixelsWide=g;m._pixelsHigh=c;m._pixelFormat=b;m.maxS=a.width/g;m.maxT=a.height/c;m._hasPremultipliedAlpha=false;m._hasMipmaps=false;m.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE);m._textureLoaded=true;return true;},drawAtPoint:function(b){var c=this;var g=[0,c.maxT,c.maxS,c.maxT,0,0,c.maxS,0];var e=c._pixelsWide*c.maxS,a=c._pixelsHigh*c.maxT;var d=[b.x,b.y,0,e+b.x,b.y,0,b.x,a+b.y,0,e+b.x,a+b.y,0];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);c._shaderProgram.use();c._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(c);var f=cc._renderContext;f.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,f.FLOAT,false,0,d);f.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,f.FLOAT,false,0,g);f.drawArrays(f.TRIANGLE_STRIP,0,4);},drawInRect:function(c){var a=this;var e=[0,a.maxT,a.maxS,a.maxT,0,0,a.maxS,0];var b=[c.x,c.y,c.x+c.width,c.y,c.x,c.y+c.height,c.x+c.width,c.y+c.height];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);a._shaderProgram.use();a._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(a);var d=cc._renderContext;d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,false,0,b);d.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,d.FLOAT,false,0,e);d.drawArrays(d.TRIANGLE_STRIP,0,4);},initWithImage:function(d){if(d==null){cc.log(cc._LogInfos.Texture2D_initWithImage);return false;}var c=d.getWidth();var a=d.getHeight();var b=cc.configuration.getMaxTextureSize();if(c>b||a>b){cc.log(cc._LogInfos.Texture2D_initWithImage_2,c,a,b,b);return false;}this._textureLoaded=true;return this._initPremultipliedATextureWithImage(d,c,a);},initWithElement:function(a){if(!a){return;}this._webTextureObj=cc._renderContext.createTexture();this._htmlElementObj=a;this._textureLoaded=true;},getHtmlElementObj:function(){return this._htmlElementObj;},isLoaded:function(){return this._textureLoaded;},handleLoadedTexture:function(){var c=this;if(!cc._rendererInitialized){return;}if(!c._htmlElementObj){var b=cc.loader.getRes(c.url);if(!b){return;}c.initWithElement(b);}if(!c._htmlElementObj.width||!c._htmlElementObj.height){return;}var e=cc._renderContext;cc.glBindTexture2D(c);e.pixelStorei(e.UNPACK_ALIGNMENT,4);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,c._htmlElementObj);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);c.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE);cc.glBindTexture2D(null);var d=c._htmlElementObj.width;var a=c._htmlElementObj.height;c._pixelsWide=c._contentSize.width=d;c._pixelsHigh=c._contentSize.height=a;c._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888;c.maxS=1;c.maxT=1;c._hasPremultipliedAlpha=false;c._hasMipmaps=false;c.dispatchEvent("load");},initWithString:function(f,b,d,a,e,c){cc.log(cc._LogInfos.Texture2D_initWithString);return null;},initWithETCFile:function(a){cc.log(cc._LogInfos.Texture2D_initWithETCFile_2);return false;},initWithPVRFile:function(a){cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2);return false;},initWithPVRTCData:function(e,f,c,b,d,a){cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2);return false;},setTexParameters:function(f,d,b,a){var c=this;var e=cc._renderContext;if(d!==undefined){f={minFilter:f,magFilter:d,wrapS:b,wrapT:a};}cc.assert((c._pixelsWide==cc.NextPOT(c._pixelsWide)&&c._pixelsHigh==cc.NextPOT(c._pixelsHigh))||(f.wrapS==e.CLAMP_TO_EDGE&&f.wrapT==e.CLAMP_TO_EDGE),"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures");cc.glBindTexture2D(c);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,f.minFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,f.magFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,f.wrapS);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,f.wrapT);},setAntiAliasTexParameters:function(){var a=cc._renderContext;cc.glBindTexture2D(this);if(!this._hasMipmaps){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);}else{a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);}a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);},setAliasTexParameters:function(){var a=cc._renderContext;cc.glBindTexture2D(this);if(!this._hasMipmaps){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);}else{a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_NEAREST);}a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);},generateMipmap:function(){var a=this;cc.assert(a._pixelsWide==cc.NextPOT(a._pixelsWide)&&a._pixelsHigh==cc.NextPOT(a._pixelsHigh),"Mimpap texture only works in POT textures");cc.glBindTexture2D(a);cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D);a._hasMipmaps=true;},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat];},bitsPerPixelForFormat:function(b){b=b||this._pixelFormat;var a=cc.Texture2D._B[b];if(a!=null){return a;}cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,b);return -1;},_initPremultipliedATextureWithImage:function(m,b,o){var p=cc.Texture2D;var j=m.getData();var a=null;var n=null;var f=null;var h=m.hasAlpha();var k=cc.size(m.getWidth(),m.getHeight());var d=p.defaultPixelFormat;var g=m.getBitsPerComponent();var e;if(!h){if(g>=8){d=p.PIXEL_FORMAT_RGB888;}else{cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage);d=p.PIXEL_FORMAT_RGB565;}}var c=b*o;if(d==p.PIXEL_FORMAT_RGB565){if(h){j=new Uint16Array(b*o);a=m.getData();for(e=0;e<c;++e){j[e]=((((a[e]>>0)&255)>>3)<<11)|((((a[e]>>8)&255)>>2)<<5)|((((a[e]>>16)&255)>>3)<<0);}}else{j=new Uint16Array(b*o);n=m.getData();for(e=0;e<c;++e){j[e]=(((n[e]&255)>>3)<<11)|(((n[e]&255)>>2)<<5)|(((n[e]&255)>>3)<<0);}}}else{if(d==p.PIXEL_FORMAT_RGBA4444){j=new Uint16Array(b*o);a=m.getData();for(e=0;e<c;++e){j[e]=((((a[e]>>0)&255)>>4)<<12)|((((a[e]>>8)&255)>>4)<<8)|((((a[e]>>16)&255)>>4)<<4)|((((a[e]>>24)&255)>>4)<<0);}}else{if(d==p.PIXEL_FORMAT_RGB5A1){j=new Uint16Array(b*o);a=m.getData();for(e=0;e<c;++e){j[e]=((((a[e]>>0)&255)>>3)<<11)|((((a[e]>>8)&255)>>3)<<6)|((((a[e]>>16)&255)>>3)<<1)|((((a[e]>>24)&255)>>7)<<0);}}else{if(d==p.PIXEL_FORMAT_A8){j=new Uint8Array(b*o);a=m.getData();for(e=0;e<c;++e){j[e]=(a>>24)&255;}}}}}if(h&&d==p.PIXEL_FORMAT_RGB888){a=m.getData();j=new Uint8Array(b*o*3);for(e=0;e<c;++e){j[e*3]=(a>>0)&255;j[e*3+1]=(a>>8)&255;j[e*3+2]=(a>>16)&255;}}this.initWithData(j,d,b,o,k);if(j!=m.getData()){j=null;}this._hasPremultipliedAlpha=m.isPremultipliedAlpha();return true;},addLoadedEventListener:function(b,a){this.addEventListener("load",b,a);},removeLoadedEventListener:function(a){this.removeEventListener("load",a);}});};cc._tmp.WebGLTextureAtlas=function(){var a=cc.TextureAtlas.prototype;a._setupVBO=function(){var b=this;var c=cc._renderContext;b._buffersVBO[0]=c.createBuffer();b._buffersVBO[1]=c.createBuffer();b._quadsWebBuffer=c.createBuffer();b._mapBuffers();};a._mapBuffers=function(){var b=this;var c=cc._renderContext;c.bindBuffer(c.ARRAY_BUFFER,b._quadsWebBuffer);c.bufferData(c.ARRAY_BUFFER,b._quadsArrayBuffer,c.DYNAMIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b._buffersVBO[1]);c.bufferData(c.ELEMENT_ARRAY_BUFFER,b._indices,c.STATIC_DRAW);};a.drawNumberOfQuads=function(e,d){var b=this;d=d||0;if(0===e||!b.texture||!b.texture.isLoaded()){return;}var c=cc._renderContext;cc.glBindTexture2D(b.texture);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);c.bindBuffer(c.ARRAY_BUFFER,b._quadsWebBuffer);if(b.dirty){c.bufferData(c.ARRAY_BUFFER,b._quadsArrayBuffer,c.DYNAMIC_DRAW);b.dirty=false;}c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,c.FLOAT,false,24,0);c.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,c.UNSIGNED_BYTE,true,24,12);c.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,c.FLOAT,false,24,16);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b._buffersVBO[1]);if(cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP){c.drawElements(c.TRIANGLE_STRIP,e*6,c.UNSIGNED_SHORT,d*6*b._indices.BYTES_PER_ELEMENT);}else{c.drawElements(c.TRIANGLES,e*6,c.UNSIGNED_SHORT,d*6*b._indices.BYTES_PER_ELEMENT);}cc.g_NumberOfDraws++;};};cc._tmp.WebGLTextureCache=function(){var a=cc.textureCache;a.handleLoadedTexture=function(c){var d=this._textures;if(!cc._rendererInitialized){d=this._loadedTexturesBefore;}var b=d[c];if(!b){b=d[c]=new cc.Texture2D();b.url=c;}b.handleLoadedTexture();};a.addImage=function(d,b,f){cc.assert(d,cc._LogInfos.Texture2D_addImage_2);var e=this._textures;if(!cc._rendererInitialized){e=this._loadedTexturesBefore;}var c=e[d]||e[cc.loader._aliases[d]];if(c){b&&b.call(f,c);return c;}c=e[d]=new cc.Texture2D();c.url=d;var g=cc.loader._checkIsImageURL(d)?cc.loader.load:cc.loader.loadImg;g.call(cc.loader,d,function(j,i){if(j){return b&&b.call(f,j);}cc.textureCache.handleLoadedTexture(d);var h=e[d];b&&b.call(f,h);});return c;};a=null;};cc.ALIGN_CENTER=51;cc.ALIGN_TOP=19;cc.ALIGN_TOP_RIGHT=18;cc.ALIGN_RIGHT=50;cc.ALIGN_BOTTOM_RIGHT=34;cc.ALIGN_BOTTOM=35;cc.ALIGN_BOTTOM_LEFT=33;cc.ALIGN_LEFT=49;cc.ALIGN_TOP_LEFT=17;cc.PVRHaveAlphaPremultiplied_=false;if(cc._renderType===cc._RENDER_TYPE_CANVAS){cc.Texture2D=cc.Class.extend({_contentSize:null,_textureLoaded:false,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0);this._textureLoaded=false;this._htmlElementObj=null;this._pattern="";},getPixelsWide:function(){return this._contentSize.width;},getPixelsHigh:function(){return this._contentSize.height;},getContentSize:function(){var a=cc.contentScaleFactor();return cc.size(this._contentSize.width/a,this._contentSize.height/a);},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor();},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor();},getContentSizeInPixels:function(){return this._contentSize;},initWithElement:function(a){if(!a){return;}this._htmlElementObj=a;this._contentSize.width=a.width;this._contentSize.height=a.height;this._textureLoaded=true;},getHtmlElementObj:function(){return this._htmlElementObj;},isLoaded:function(){return this._textureLoaded;},handleLoadedTexture:function(){var b=this;if(b._textureLoaded){return;}if(!b._htmlElementObj){var a=cc.loader.getRes(b.url);if(!a){return;}b.initWithElement(a);}var c=b._htmlElementObj;b._contentSize.width=c.width;b._contentSize.height=c.height;b.dispatchEvent("load");},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">";},initWithData:function(d,b,c,a,e){return false;},initWithImage:function(a){return false;},initWithString:function(f,b,d,a,e,c){return false;},releaseTexture:function(){cc.loader.release(this.url);},getName:function(){return null;},getMaxS:function(){return 1;},setMaxS:function(a){},getMaxT:function(){return 1;},setMaxT:function(a){},getPixelFormat:function(){return null;},getShaderProgram:function(){return null;},setShaderProgram:function(a){},hasPremultipliedAlpha:function(){return false;},hasMipmaps:function(){return false;},releaseData:function(a){a=null;},keepData:function(b,a){return b;},drawAtPoint:function(a){},drawInRect:function(a){},initWithETCFile:function(a){cc.log(cc._LogInfos.Texture2D_initWithETCFile);return false;},initWithPVRFile:function(a){cc.log(cc._LogInfos.Texture2D_initWithPVRFile);return false;},initWithPVRTCData:function(e,f,c,b,d,a){cc.log(cc._LogInfos.Texture2D_initWithPVRTCData);return false;},setTexParameters:function(d,c,b,a){if(c!==undefined){d={minFilter:d,magFilter:c,wrapS:b,wrapT:a};}if(d.wrapS===cc.REPEAT&&d.wrapT===cc.REPEAT){this._pattern="repeat";return;}if(d.wrapS===cc.REPEAT){this._pattern="repeat-x";return;}if(d.wrapT===cc.REPEAT){this._pattern="repeat-y";return;}this._pattern="";},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return"";},bitsPerPixelForFormat:function(a){return -1;},addLoadedEventListener:function(b,a){this.addEventListener("load",b,a);},removeLoadedEventListener:function(a){this.removeEventListener("load",a);},_grayElementObj:null,_backupElement:null,_isGray:false,_switchToGray:function(a){if(!this._textureLoaded||this._isGray==a){return;}this._isGray=a;if(this._isGray){this._backupElement=this._htmlElementObj;if(!this._grayElementObj){this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj);}this._htmlElementObj=this._grayElementObj;}else{if(this._backupElement!=null){this._htmlElementObj=this._backupElement;}}}});cc.Texture2D._generateGrayTexture=function(f,e,b){if(f===null){return null;}b=b||cc.newElement("canvas");e=e||cc.rect(0,0,f.width,f.height);b.width=e.width;b.height=e.height;var d=b.getContext("2d");d.drawImage(f,e.x,e.y,e.width,e.height,0,0,e.width,e.height);var h=d.getImageData(0,0,e.width,e.height);var g=h.data;for(var c=0,a=g.length;c<a;c+=4){g[c]=g[c+1]=g[c+2]=0.34*g[c]+0.5*g[c+1]+0.16*g[c+2];}d.putImageData(h,0,0);return b;};}else{cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js");cc._tmp.WebGLTexture2D();delete cc._tmp.WebGLTexture2D;}cc.EventHelper.prototype.apply(cc.Texture2D.prototype);cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js");cc._tmp.PrototypeTexture2D();delete cc._tmp.PrototypeTexture2D;cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:(0|Math.random()*1000),_loadedTexturesBefore:{},_initializingRenderer:function(){var d;var c=this._loadedTexturesBefore,b=this._textures;for(d in c){var a=c[d];a.handleLoadedTexture();b[d]=a;}this._loadedTexturesBefore={};},addPVRTCImage:function(a){cc.log(cc._LogInfos.textureCache_addPVRTCImage);},addETCImage:function(a){cc.log(cc._LogInfos.textureCache_addETCImage);},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">";},textureForKey:function(a){cc.log(cc._LogInfos.textureCache_textureForKey);return this.getTextureForKey(a);},getTextureForKey:function(a){return this._textures[a]||this._textures[cc.loader._aliases[a]];},getKeyByTexture:function(b){for(var a in this._textures){if(this._textures[a]==b){return a;}}return null;},_generalTextureKey:function(){this._textureKeySeq++;return"_textureKey_"+this._textureKeySeq;},getTextureColors:function(b){var a=this.getKeyByTexture(b);if(!a){if(b instanceof HTMLImageElement){a=b.src;}else{a=this._generalTextureKey();}}if(!this._textureColorsCache[a]){this._textureColorsCache[a]=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor(b);}return this._textureColorsCache[a];},addPVRImage:function(a){cc.log(cc._LogInfos.textureCache_addPVRImage);},removeAllTextures:function(){var b=this._textures;for(var a in b){if(b[a]){b[a].releaseTexture();}}this._textures={};},removeTexture:function(b){if(!b){return;}var c=this._textures;for(var a in c){if(c[a]==b){c[a].releaseTexture();delete (c[a]);}}},removeTextureForKey:function(a){if(a==null){return;}if(this._textures[a]){delete (this._textures[a]);}},cacheImage:function(c,a){if(a instanceof cc.Texture2D){this._textures[c]=a;return;}var b=new cc.Texture2D();b.initWithElement(a);b.handleLoadedTexture();this._textures[c]=b;},addUIImage:function(c,a){cc.assert(c,cc._LogInfos.textureCache_addUIImage_2);if(a){if(this._textures[a]){return this._textures[a];}}var b=new cc.Texture2D();b.initWithImage(c);if((a!=null)&&(b!=null)){this._textures[a]=b;}else{cc.log(cc._LogInfos.textureCache_addUIImage);}return b;},dumpCachedTextureInfo:function(){var c=0;var a=0,f=this._textures;for(var h in f){var g=f[h];c++;if(g.getHtmlElementObj() instanceof HTMLImageElement){cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,h,g.getHtmlElementObj().src,g.pixelsWidth,g.pixelsHeight);}else{cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,h,g.pixelsWidth,g.pixelsHeight);}a+=g.pixelsWidth*g.pixelsHeight*4;}var e=this._textureColorsCache;for(h in e){var i=e[h];for(var d in i){var b=i[d];c++;cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,h,b.width,b.height);a+=b.width*b.height*4;}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,c,a/1024,(a/(1024*1024)).toFixed(2));},_clear:function(){this._textures={};this._textureColorsCache={};this._textureKeySeq=(0|Math.random()*1000);this._loadedTexturesBefore={};}};if(cc._renderType===cc._RENDER_TYPE_CANVAS){var _p=cc.textureCache;_p.handleLoadedTexture=function(b){var c=this._textures;var a=c[b];if(!a){a=c[b]=new cc.Texture2D();a.url=b;}a.handleLoadedTexture();};_p.addImage=function(c,a,e){cc.assert(c,cc._LogInfos.Texture2D_addImage);var d=this._textures;var b=d[c]||d[cc.loader._aliases[c]];if(b){a&&a.call(e,b);return b;}b=d[c]=new cc.Texture2D();b.url=c;var f=cc.loader._checkIsImageURL(c)?cc.loader.load:cc.loader.loadImg;f.call(cc.loader,c,function(i,h){if(i){return a&&a.call(e,i);}cc.textureCache.handleLoadedTexture(c);var g=d[c];a&&a.call(e,g);});return b;};_p=null;}else{cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),cc._LogInfos.MissingFile,"TexturesWebGL.js");cc._tmp.WebGLTextureCache();delete cc._tmp.WebGLTextureCache;}cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this);this._ignoreAnchorPointForPosition=true;this.setAnchorPoint(0.5,0.5);this.setContentSize(cc.director.getWinSize());}});cc.Scene.create=function(){return new cc.Scene();};cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",init:function(){var c=this;var b=160;var a=200;var g=c._bgLayer=new cc.LayerColor(cc.color(32,32,32,255));c.addChild(g,0);var f=24,e=-a/2+100;if(cc._loaderImage){cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:false},function(i,h){b=h.width;a=h.height;c._initStage(h,cc.visibleRect.center);});f=14;e=-a/2-10;}var d=c._label=new cc.LabelTTF("Loading... 0%","Arial",f);d.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,e)));d.setColor(cc.color(180,180,180));g.addChild(this._label,10);return true;},_initStage:function(b,e){var a=this;var d=a._texture2d=new cc.Texture2D();d.initWithElement(b);d.handleLoadedTexture();var c=a._logo=new cc.Sprite(d);c.setScale(cc.contentScaleFactor());c.x=e.x;c.y=e.y;a._bgLayer.addChild(c,10);},onEnter:function(){var a=this;cc.Node.prototype.onEnter.call(a);a.schedule(a._startLoading,0.3);},onExit:function(){cc.Node.prototype.onExit.call(this);var a="Loading... 0%";this._label.setString(a);},initWithResources:function(b,a){if(cc.isString(b)){b=[b];}this.resources=b||[];this.cb=a;},_startLoading:function(){var a=this;a.unschedule(a._startLoading);var b=a.resources;cc.loader.load(b,function(c,e,f){var d=(f/e*100)|0;d=Math.min(d,100);a._label.setString("Loading... "+d+"%");},function(){if(a.cb){a.cb();}});}});cc.LoaderScene.preload=function(c,a){var b=cc;if(!b.loaderScene){b.loaderScene=new cc.LoaderScene();b.loaderScene.init();}b.loaderScene.initWithResources(c,a);cc.director.runScene(b.loaderScene);return b.loaderScene;};cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){var a=cc.Node.prototype;a.ctor.call(this);this._ignoreAnchorPointForPosition=true;a.setAnchorPoint.call(this,0.5,0.5);a.setContentSize.call(this,cc.winSize);},init:function(){var a=this;a._ignoreAnchorPointForPosition=true;a.setAnchorPoint(0.5,0.5);a.setContentSize(cc.winSize);a._cascadeColorEnabled=false;a._cascadeOpacityEnabled=false;return true;},bake:function(){this._renderCmd.bake();},unbake:function(){this._renderCmd.unbake();},isBaked:function(){return this._isBaked;},addChild:function(c,b,a){cc.Node.prototype.addChild.call(this,c,b,a);this._renderCmd._bakeForAddChild(c);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.Layer.CanvasRenderCmd(this);}else{return new cc.Layer.WebGLRenderCmd(this);}}});cc.Layer.create=function(){return new cc.Layer();};cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc;},changeWidthAndHeight:function(a,b){this.width=a;this.height=b;},changeWidth:function(a){this.width=a;},changeHeight:function(a){this.height=a;},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return false;},ctor:function(b,c,a){cc.Layer.prototype.ctor.call(this);this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);cc.LayerColor.prototype.init.call(this,b,c,a);},init:function(b,d,a){if(cc._renderType!==cc._RENDER_TYPE_CANVAS){this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR);}var c=cc.director.getWinSize();b=b||cc.color(0,0,0,255);d=d===undefined?c.width:d;a=a===undefined?c.height:a;var e=this._realColor;e.r=b.r;e.g=b.g;e.b=b.b;this._realOpacity=b.a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty);cc.LayerColor.prototype.setContentSize.call(this,d,a);return true;},setBlendFunc:function(b,c){var a=this._blendFunc;if(c===undefined){a.src=b.src;a.dst=b.dst;}else{a.src=b;a.dst=c;}this._renderCmd.updateBlendFunc(a);},_setWidth:function(a){cc.Node.prototype._setWidth.call(this,a);this._renderCmd._updateSquareVerticesWidth(a);},_setHeight:function(a){cc.Node.prototype._setHeight.call(this,a);this._renderCmd._updateSquareVerticesHeight(a);},setContentSize:function(b,a){cc.Layer.prototype.setContentSize.call(this,b,a);this._renderCmd._updateSquareVertices(b,a);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.LayerColor.CanvasRenderCmd(this);}else{return new cc.LayerColor.WebGLRenderCmd(this);}}});cc.LayerColor.create=function(b,c,a){return new cc.LayerColor(b,c,a);};(function(){var a=cc.LayerColor.prototype;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight);})();cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:false,_className:"LayerGradient",ctor:function(d,a,b){var c=this;cc.LayerColor.prototype.ctor.call(c);c._endColor=cc.color(0,0,0,255);c._alongVector=cc.p(0,-1);c._startOpacity=255;c._endOpacity=255;cc.LayerGradient.prototype.init.call(c,d,a,b);},init:function(e,a,b){e=e||cc.color(0,0,0,255);a=a||cc.color(0,0,0,255);b=b||cc.p(0,-1);var d=this;var c=d._endColor;d._startOpacity=e.a;c.r=a.r;c.g=a.g;c.b=a.b;d._endOpacity=a.a;d._alongVector=b;d._compressedInterpolation=true;cc.LayerColor.prototype.init.call(d,cc.color(e.r,e.g,e.b,255));this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty);return true;},setContentSize:function(b,a){cc.LayerColor.prototype.setContentSize.call(this,b,a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);},_setWidth:function(a){cc.LayerColor.prototype._setWidth.call(this,a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);},_setHeight:function(a){cc.LayerColor.prototype._setHeight.call(this,a);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);},getStartColor:function(){return this._realColor;},setStartColor:function(a){this.color=a;},setEndColor:function(a){this._endColor=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);},getEndColor:function(){return this._endColor;},setStartOpacity:function(a){this._startOpacity=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);},getStartOpacity:function(){return this._startOpacity;},setEndOpacity:function(a){this._endOpacity=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);},getEndOpacity:function(){return this._endOpacity;},setVector:function(a){this._alongVector.x=a.x;this._alongVector.y=a.y;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y);},isCompressedInterpolation:function(){return this._compressedInterpolation;},setCompressedInterpolation:function(a){this._compressedInterpolation=a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.LayerGradient.CanvasRenderCmd(this);}else{return new cc.LayerGradient.WebGLRenderCmd(this);}}});cc.LayerGradient.create=function(c,a,b){return new cc.LayerGradient(c,a,b);};(function(){var a=cc.LayerGradient.prototype;a.startColor;cc.defineGetterSetter(a,"startColor",a.getStartColor,a.setStartColor);a.endColor;cc.defineGetterSetter(a,"endColor",a.getEndColor,a.setEndColor);a.startOpacity;cc.defineGetterSetter(a,"startOpacity",a.getStartOpacity,a.setStartOpacity);a.endOpacity;cc.defineGetterSetter(a,"endOpacity",a.getEndOpacity,a.setEndOpacity);a.vector;cc.defineGetterSetter(a,"vector",a.getVector,a.setVector);})();cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(a){cc.Layer.prototype.ctor.call(this);if(a instanceof Array){cc.LayerMultiplex.prototype.initWithLayers.call(this,a);}else{cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments));}},initWithLayers:function(a){if((a.length>0)&&(a[a.length-1]==null)){cc.log(cc._LogInfos.LayerMultiplex_initWithLayers);}this._layers=a;this._enabledLayer=0;this.addChild(this._layers[this._enabledLayer]);return true;},switchTo:function(a){if(a>=this._layers.length){cc.log(cc._LogInfos.LayerMultiplex_switchTo);return;}this.removeChild(this._layers[this._enabledLayer],true);this._enabledLayer=a;this.addChild(this._layers[a]);},switchToAndReleaseMe:function(a){if(a>=this._layers.length){cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe);return;}this.removeChild(this._layers[this._enabledLayer],true);this._layers[this._enabledLayer]=null;this._enabledLayer=a;this.addChild(this._layers[a]);},addLayer:function(a){if(!a){cc.log(cc._LogInfos.LayerMultiplex_addLayer);return;}this._layers.push(a);}});cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments));};(function(){cc.Layer.CanvasRenderCmd=function(b){cc.Node.CanvasRenderCmd.call(this,b);this._isBaked=false;this._bakeSprite=null;};var a=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.Layer.CanvasRenderCmd;a.bake=function(){if(!this._isBaked){this._needDraw=true;cc.renderer.childrenOrderDirty=true;this._isBaked=this._cacheDirty=true;var d=this._node._children;for(var c=0,b=d.length;c<b;c++){d[c]._renderCmd._setCachedParent(this);}if(!this._bakeSprite){this._bakeSprite=new cc.BakeSprite();this._bakeSprite._parent=this._node;}}};a.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=true;this._needDraw=false;this._isBaked=false;this._cacheDirty=true;var d=this._node._children;for(var c=0,b=d.length;c<b;c++){d[c]._renderCmd._setCachedParent(null);}}};a.isBaked=function(){return this._isBaked;};a.rendering=function(){if(this._cacheDirty){var e=this._node;var d=e._children,o=this._bakeSprite;this.transform(this.getParentRenderCmd(),true);var f=this._getBoundingBoxForBake();f.width=0|(f.width+0.5);f.height=0|(f.height+0.5);var c=o.getCacheContext();var n=c.getContext();o.resetCanvasSize(f.width,f.height);var j=o.getAnchorPointInPoints(),h=e._position;if(e._ignoreAnchorPointForPosition){c.setOffset(0-f.x,n.canvas.height-f.height+f.y);o.setPosition(j.x+f.x-h.x,j.y+f.y-h.y);}else{var k=this.getAnchorPointInPoints();var b={x:h.x-k.x,y:h.y-k.y};c.setOffset(0-f.x,n.canvas.height-f.height+f.y);o.setPosition(j.x+f.x-b.x,j.y+f.y-b.y);}e.sortAllChildren();cc.renderer._turnToCacheMode(this.__instanceId);for(var g=0,m=d.length;g<m;g++){d[g].visit(this);}cc.renderer._renderingToCacheCanvas(c,this.__instanceId);o.transform(this);this._cacheDirty=false;}};a.visit=function(e){if(!this._isBaked){cc.Node.CanvasRenderCmd.prototype.visit.call(this,e);return;}var d=this._node,c=d._children;var b=c.length;if(!d._visible||b===0){return;}this._syncStatus(e);cc.renderer.pushRenderCommand(this);this._bakeSprite.visit(this);this._dirtyFlag=0;};a._bakeForAddChild=function(b){if(b._parent==this._node&&this._isBaked){b._renderCmd._setCachedParent(this);}};a._getBoundingBoxForBake=function(){var h=null,g=this._node;if(!g._children||g._children.length===0){return cc.rect(0,0,10,10);}var f=g.getNodeToWorldTransform();var c=g._children;for(var e=0,b=c.length;e<b;e++){var j=c[e];if(j&&j._visible){if(h){var d=j._getBoundingBoxToCurrentNode(f);if(d){h=cc.rectUnion(h,d);}}else{h=j._getBoundingBoxToCurrentNode(f);}}}return h;};})();(function(){cc.LayerColor.CanvasRenderCmd=function(b){cc.Layer.CanvasRenderCmd.call(this,b);this._needDraw=true;this._blendFuncStr="source-over";this._bakeRenderCmd=new cc.CustomRenderCmd(this,this._bakeRendering);};var a=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);a.constructor=cc.LayerColor.CanvasRenderCmd;a.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this);this._needDraw=true;};a.rendering=function(j,h,g){var b=j||cc._renderContext,c=b.getContext(),d=this._node,i=this._displayedColor,e=this._displayedOpacity/255,k=d._contentSize.width,f=d._contentSize.height;if(e===0){return;}b.setCompositeOperation(this._blendFuncStr);b.setGlobalAlpha(e);b.setFillStyle("rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b)+", 1)");b.setTransform(this._worldTransform,h,g);c.fillRect(0,0,k*h,-f*g);cc.g_NumberOfDraws++;};a.updateBlendFunc=function(b){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(b);};a._updateSquareVertices=a._updateSquareVerticesWidth=a._updateSquareVerticesHeight=function(){};a._bakeRendering=function(){if(this._cacheDirty){var f=this._node;var p=this._bakeSprite,e=f._children;var n=e.length,k;this.transform(this.getParentRenderCmd(),true);var g=this._getBoundingBoxForBake();g.width=0|(g.width+0.5);g.height=0|(g.height+0.5);var d=p.getCacheContext();var o=d.getContext();p.resetCanvasSize(g.width,g.height);var j=p.getAnchorPointInPoints(),h=f._position;if(f._ignoreAnchorPointForPosition){d.setOffset(0-g.x,o.canvas.height-g.height+g.y);p.setPosition(j.x+g.x-h.x,j.y+g.y-h.y);}else{var m=this.getAnchorPointInPoints();var b={x:h.x-m.x,y:h.y-m.y};d.setOffset(0-g.x,o.canvas.height-g.height+g.y);p.setPosition(j.x+g.x-b.x,j.y+g.y-b.y);}var c;cc.renderer._turnToCacheMode(this.__instanceId);if(n>0){f.sortAllChildren();for(k=0;k<n;k++){c=e[k];if(c._localZOrder<0){c._renderCmd.visit(this);}else{break;}}cc.renderer.pushRenderCommand(this);for(;k<n;k++){e[k]._renderCmd.visit(this);}}else{cc.renderer.pushRenderCommand(this);}cc.renderer._renderingToCacheCanvas(d,this.__instanceId);p.transform(this);this._cacheDirty=false;}};a.visit=function(c){if(!this._isBaked){cc.Node.CanvasRenderCmd.prototype.visit.call(this);return;}var b=this._node;if(!b._visible){return;}this._syncStatus(c);cc.renderer.pushRenderCommand(this._bakeRenderCmd);this._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);this._bakeSprite.visit(this);this._dirtyFlag=0;};a._getBoundingBoxForBake=function(){var g=this._node;var f=cc.rect(0,0,g._contentSize.width,g._contentSize.height);var e=g.getNodeToWorldTransform();f=cc.rectApplyAffineTransform(f,g.getNodeToWorldTransform());if(!g._children||g._children.length===0){return f;}var b=g._children;for(var d=0;d<b.length;d++){var h=b[d];if(h&&h._visible){var c=h._getBoundingBoxToCurrentNode(e);f=cc.rectUnion(f,c);}}return f;};})();(function(){cc.LayerGradient.RenderCmd={updateStatus:function(){var b=cc.Node._dirtyFlags,c=this._dirtyFlag;var a=c&b.colorDirty,d=c&b.opacityDirty;if(a){this._updateDisplayColor();}if(d){this._updateDisplayOpacity();}if(c&b.transformDirty){this.transform(null,true);}if(a||d||(c&b.gradientDirty)){this._updateColor();}this._dirtyFlag=0;}};})();(function(){cc.LayerGradient.CanvasRenderCmd=function(b){cc.LayerColor.CanvasRenderCmd.call(this,b);this._needDraw=true;this._startPoint=cc.p(0,0);this._endPoint=cc.p(0,0);this._startStopStr=null;this._endStopStr=null;};var a=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,a);a.constructor=cc.LayerGradient.CanvasRenderCmd;a.rendering=function(j,i,h){var b=j||cc._renderContext,c=b.getContext(),d=this._node,e=this._displayedOpacity/255;if(e===0){return;}var k=d._contentSize.width,f=d._contentSize.height;b.setCompositeOperation(this._blendFuncStr);b.setGlobalAlpha(e);var g=c.createLinearGradient(this._startPoint.x,this._startPoint.y,this._endPoint.x,this._endPoint.y);g.addColorStop(0,this._startStopStr);g.addColorStop(1,this._endStopStr);b.setFillStyle(g);b.setTransform(this._worldTransform,i,h);c.fillRect(0,0,k*i,-f*h);cc.g_NumberOfDraws++;};a._syncStatus=function(e){var d=cc.Node._dirtyFlags,f=this._dirtyFlag;var b=e?e._node:null;if(b&&b._cascadeColorEnabled&&(e._dirtyFlag&d.colorDirty)){f|=d.colorDirty;}if(b&&b._cascadeOpacityEnabled&&(e._dirtyFlag&d.opacityDirty)){f|=d.opacityDirty;}if(e&&(e._dirtyFlag&d.transformDirty)){f|=d.transformDirty;}var c=f&d.colorDirty,g=f&d.opacityDirty;this._dirtyFlag=f;if(c){this._syncDisplayColor();}if(g){this._syncDisplayOpacity();}if(f&d.transformDirty){this.transform(e);}if(c||g||(f&d.gradientDirty)){this._updateColor();}};a._updateColor=function(){var d=this._node;var c=d._contentSize;var g=d._alongVector,f=c.width*0.5,i=c.height*0.5;this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty^this._dirtyFlag;this._startPoint.x=f*(-g.x)+f;this._startPoint.y=i*g.y-i;this._endPoint.x=f*g.x+f;this._endPoint.y=i*(-g.y)-i;var h=this._displayedColor,b=d._endColor;var j=d._startOpacity/255,e=d._endOpacity/255;this._startStopStr="rgba("+Math.round(h.r)+","+Math.round(h.g)+","+Math.round(h.b)+","+j.toFixed(4)+")";this._endStopStr="rgba("+Math.round(b.r)+","+Math.round(b.g)+","+Math.round(b.b)+","+e.toFixed(4)+")";};})();cc._tmp.PrototypeSprite=function(){var a=cc.Sprite.prototype;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB,a.setOpacityModifyRGB);cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.dirty;a.flippedX;cc.defineGetterSetter(a,"flippedX",a.isFlippedX,a.setFlippedX);a.flippedY;cc.defineGetterSetter(a,"flippedY",a.isFlippedY,a.setFlippedY);a.offsetX;cc.defineGetterSetter(a,"offsetX",a._getOffsetX);a.offsetY;cc.defineGetterSetter(a,"offsetY",a._getOffsetY);a.atlasIndex;a.texture;cc.defineGetterSetter(a,"texture",a.getTexture,a.setTexture);a.textureRectRotated;cc.defineGetterSetter(a,"textureRectRotated",a.isTextureRectRotated);a.textureAtlas;a.batchNode;cc.defineGetterSetter(a,"batchNode",a.getBatchNode,a.setBatchNode);a.quad;cc.defineGetterSetter(a,"quad",a.getQuad);};cc.Sprite=cc.Node.extend({dirty:false,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:false,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:false,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:false,_flippedX:false,_flippedY:false,_textureLoaded:false,_className:"Sprite",ctor:function(d,c,b){var a=this;cc.Node.prototype.ctor.call(a);a._shouldBeHidden=false;a._offsetPosition=cc.p(0,0);a._unflippedOffsetPositionFromCenter=cc.p(0,0);a._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};a._rect=cc.rect(0,0,0,0);a._softInit(d,c,b);},textureLoaded:function(){return this._textureLoaded;},addLoadedEventListener:function(b,a){this.addEventListener("load",b,a);},isDirty:function(){return this.dirty;},setDirty:function(a){this.dirty=a;},isTextureRectRotated:function(){return this._rectRotated;},getAtlasIndex:function(){return this.atlasIndex;},setAtlasIndex:function(a){this.atlasIndex=a;},getTextureRect:function(){return cc.rect(this._rect);},getTextureAtlas:function(){return this.textureAtlas;},setTextureAtlas:function(a){this.textureAtlas=a;},getOffsetPosition:function(){return cc.p(this._offsetPosition);},_getOffsetX:function(){return this._offsetPosition.x;},_getOffsetY:function(){return this._offsetPosition.y;},getBlendFunc:function(){return this._blendFunc;},initWithSpriteFrame:function(c){cc.assert(c,cc._LogInfos.Sprite_initWithSpriteFrame);if(!c.textureLoaded()){this._textureLoaded=false;c.addEventListener("load",this._renderCmd._spriteFrameLoadedCallback,this);}var a=cc._renderType===cc._RENDER_TYPE_CANVAS?false:c._rotated;var b=this.initWithTexture(c.getTexture(),c.getRect(),a);this.setSpriteFrame(c);return b;},initWithSpriteFrameName:function(a){cc.assert(a,cc._LogInfos.Sprite_initWithSpriteFrameName);var b=cc.spriteFrameCache.getSpriteFrame(a);cc.assert(b,a+cc._LogInfos.Sprite_initWithSpriteFrameName1);return this.initWithSpriteFrame(b);},useBatchNode:function(a){this.textureAtlas=a.getTextureAtlas();this._batchNode=a;},setVertexRect:function(b){var a=this._rect;a.x=b.x;a.y=b.y;a.width=b.width;a.height=b.height;},sortAllChildren:function(){if(this._reorderChildDirty){var e=this._children;var a=e.length,d,b,c;for(d=1;d<a;d++){c=e[d];b=d-1;while(b>=0){if(c._localZOrder<e[b]._localZOrder){e[b+1]=e[b];}else{if(c._localZOrder===e[b]._localZOrder&&c.arrivalOrder<e[b].arrivalOrder){e[b+1]=e[b];}else{break;}}b--;}e[b+1]=c;}if(this._batchNode){this._arrayMakeObjectsPerformSelector(e,cc.Node._stateCallbackType.sortAllChildren);}this._reorderChildDirty=false;}},reorderChild:function(b,a){cc.assert(b,cc._LogInfos.Sprite_reorderChild_2);if(this._children.indexOf(b)===-1){cc.log(cc._LogInfos.Sprite_reorderChild);return;}if(a===b.zIndex){return;}if(this._batchNode&&!this._reorderChildDirty){this._setReorderChildDirtyRecursively();this._batchNode.reorderBatch(true);}cc.Node.prototype.reorderChild.call(this,b,a);},removeChild:function(b,a){if(this._batchNode){this._batchNode.removeSpriteFromAtlas(b);}cc.Node.prototype.removeChild.call(this,b,a);},setVisible:function(a){cc.Node.prototype.setVisible.call(this,a);this._renderCmd.setDirtyRecursively(true);},removeAllChildren:function(e){var c=this._children,b=this._batchNode;if(b&&c!=null){for(var d=0,a=c.length;d<a;d++){b.removeSpriteFromAtlas(c[d]);}}cc.Node.prototype.removeAllChildren.call(this,e);this._hasChildren=false;},ignoreAnchorPointForPosition:function(a){if(this._batchNode){cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition);return;}cc.Node.prototype.ignoreAnchorPointForPosition.call(this,a);},setFlippedX:function(a){if(this._flippedX!=a){this._flippedX=a;this.setTextureRect(this._rect,this._rectRotated,this._contentSize);this.setNodeDirty(true);}},setFlippedY:function(a){if(this._flippedY!=a){this._flippedY=a;this.setTextureRect(this._rect,this._rectRotated,this._contentSize);this.setNodeDirty(true);}},isFlippedX:function(){return this._flippedX;},isFlippedY:function(){return this._flippedY;},setOpacityModifyRGB:function(a){if(this._opacityModifyRGB!==a){this._opacityModifyRGB=a;this._renderCmd._setColorDirty();}},isOpacityModifyRGB:function(){return this._opacityModifyRGB;},setDisplayFrameWithAnimationName:function(b,d){cc.assert(b,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var a=cc.animationCache.getAnimation(b);if(!a){cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName);return;}var c=a.getFrames()[d];if(!c){cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2);return;}this.setSpriteFrame(c.getSpriteFrame());},getBatchNode:function(){return this._batchNode;},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=true;var a=this._parent;while(a&&a!=this._batchNode){a._setReorderChildDirtyRecursively();a=a.parent;}}},getTexture:function(){return this._texture;},_softInit:function(f,c,b){if(f===undefined){cc.Sprite.prototype.init.call(this);}else{if(cc.isString(f)){if(f[0]==="#"){var a=f.substr(1,f.length-1);var d=cc.spriteFrameCache.getSpriteFrame(a);this.initWithSpriteFrame(d);}else{cc.Sprite.prototype.init.call(this,f,c);}}else{if(cc.isObject(f)){if(f instanceof cc.Texture2D){this.initWithTexture(f,c,b);}else{if(f instanceof cc.SpriteFrame){this.initWithSpriteFrame(f);}else{if((f instanceof HTMLImageElement)||(f instanceof HTMLCanvasElement)){var e=new cc.Texture2D();e.initWithElement(f);e.handleLoadedTexture();this.initWithTexture(e);}}}}}}},getQuad:function(){return this._renderCmd.getQuad();},setBlendFunc:function(b,c){var a=this._blendFunc;if(c===undefined){a.src=b.src;a.dst=b.dst;}else{a.src=b;a.dst=c;}this._renderCmd.updateBlendFunc(a);},init:function(){var a=this;if(arguments.length>0){return a.initWithFile(arguments[0],arguments[1]);}cc.Node.prototype.init.call(a);a.dirty=a._recursiveDirty=false;a._blendFunc.src=cc.BLEND_SRC;a._blendFunc.dst=cc.BLEND_DST;a.texture=null;a._flippedX=a._flippedY=false;a.anchorX=0.5;a.anchorY=0.5;a._offsetPosition.x=0;a._offsetPosition.y=0;a._hasChildren=false;this._renderCmd._init();a.setTextureRect(cc.rect(0,0,0,0),false,cc.size(0,0));return true;},initWithFile:function(b,d){cc.assert(b,cc._LogInfos.Sprite_initWithFile);var a=cc.textureCache.getTextureForKey(b);if(!a){a=cc.textureCache.addImage(b);return this.initWithTexture(a,d||cc.rect(0,0,a._contentSize.width,a._contentSize.height));}else{if(!d){var c=a.getContentSize();d=cc.rect(0,0,c.width,c.height);}return this.initWithTexture(a,d);}},initWithTexture:function(e,d,b,c){var f=this;cc.assert(arguments.length!=0,cc._LogInfos.CCSpriteBatchNode_initWithTexture);b=b||false;e=this._renderCmd._handleTextureForRotatedTexture(e,d,b,c);if(!cc.Node.prototype.init.call(f)){return false;}f._batchNode=null;f._recursiveDirty=false;f.dirty=false;f._opacityModifyRGB=true;f._blendFunc.src=cc.BLEND_SRC;f._blendFunc.dst=cc.BLEND_DST;f._flippedX=f._flippedY=false;f.setAnchorPoint(0.5,0.5);f._offsetPosition.x=0;f._offsetPosition.y=0;f._hasChildren=false;this._renderCmd._init();var a=e.isLoaded();f._textureLoaded=a;if(!a){f._rectRotated=b;if(d){f._rect.x=d.x;f._rect.y=d.y;f._rect.width=d.width;f._rect.height=d.height;}if(f.texture){f.texture.removeEventListener("load",f);}e.addEventListener("load",f._renderCmd._textureLoadedCallback,f);f.texture=e;return true;}if(!d){d=cc.rect(0,0,e.width,e.height);}this._renderCmd._checkTextureBoundary(e,d,b);f.texture=e;f.setTextureRect(d,b);f.setBatchNode(null);return true;},setTextureRect:function(d,b,g,f){var e=this;e._rectRotated=b||false;e.setContentSize(g||d);e.setVertexRect(d);e._renderCmd._setTextureCoords(d,f);var c=e._unflippedOffsetPositionFromCenter;if(e._flippedX){c.x=-c.x;}if(e._flippedY){c.y=-c.y;}var a=e._rect;e._offsetPosition.x=c.x+(e._contentSize.width-a.width)/2;e._offsetPosition.y=c.y+(e._contentSize.height-a.height)/2;if(e._batchNode){e.dirty=true;}else{this._renderCmd._resetForBatchNode();}},updateTransform:function(){this._renderCmd.updateTransform();},addChild:function(c,b,a){cc.assert(c,cc._LogInfos.CCSpriteBatchNode_addChild_2);if(b==null){b=c._localZOrder;}if(a==null){a=c.tag;}if(this._renderCmd._setBatchNodeForAddChild(c)){cc.Node.prototype.addChild.call(this,c,b,a);this._hasChildren=true;}},setSpriteFrame:function(e){var d=this;if(cc.isString(e)){e=cc.spriteFrameCache.getSpriteFrame(e);cc.assert(e,cc._LogInfos.Sprite_setSpriteFrame);}this.setNodeDirty(true);var b=e.getOffset();d._unflippedOffsetPositionFromCenter.x=b.x;d._unflippedOffsetPositionFromCenter.y=b.y;var c=e.getTexture();var a=e.textureLoaded();if(!a){d._textureLoaded=false;e.addEventListener("load",function(g){d._textureLoaded=true;var f=g.getTexture();if(f!=d._texture){d.texture=f;}d.setTextureRect(g.getRect(),g.isRotated(),g.getOriginalSize());d.dispatchEvent("load");d.setColor(d.color);},d);}else{if(c!=d._texture){d.texture=c;}d.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize());}this._renderCmd._updateForSetSpriteFrame(c);},setDisplayFrame:function(a){cc.log(cc._LogInfos.Sprite_setDisplayFrame);this.setSpriteFrame(a);},isFrameDisplayed:function(a){return this._renderCmd.isFrameDisplayed(a);},displayFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize));},setBatchNode:function(b){var a=this;a._batchNode=b;if(!a._batchNode){a.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED;a.textureAtlas=null;a._recursiveDirty=false;a.dirty=false;this._renderCmd._resetForBatchNode();}else{a._transformToBatch=cc.affineTransformIdentity();a.textureAtlas=a._batchNode.getTextureAtlas();}},setTexture:function(a){if(!a){return this._renderCmd._setTexture(null);}if(cc.isString(a)){a=cc.textureCache.addImage(a);if(!a._textureLoaded){a.addEventListener("load",function(){this._renderCmd._setTexture(a);this._changeRectWithTexture(a.getContentSize());this.setColor(this._realColor);this._textureLoaded=true;},this);}else{this._renderCmd._setTexture(a);this._changeRectWithTexture(a.getContentSize());this.setColor(this._realColor);this._textureLoaded=true;}}else{cc.assert(a instanceof cc.Texture2D,cc._LogInfos.Sprite_setTexture_2);this._changeRectWithTexture(a.getContentSize());this._renderCmd._setTexture(a);}},_changeRectWithTexture:function(b){if(!b||(!b.width&&!b.height)){return;}var a=this.getTextureRect();if(a.height||a.width){return;}b.x=b.x||0;b.y=b.y||0;b.width=b.width||0;b.height=b.height||0;this.setTextureRect(b);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.Sprite.CanvasRenderCmd(this);}else{return new cc.Sprite.WebGLRenderCmd(this);}}});cc.Sprite.create=function(c,b,a){return new cc.Sprite(c,b,a);};cc.Sprite.createWithTexture=cc.Sprite.create;cc.Sprite.createWithSpriteFrameName=cc.Sprite.create;cc.Sprite.createWithSpriteFrame=cc.Sprite.create;cc.Sprite.INDEX_NOT_INITIALIZED=-1;cc.EventHelper.prototype.apply(cc.Sprite.prototype);cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js");cc._tmp.PrototypeSprite();delete cc._tmp.PrototypeSprite;(function(){cc.Sprite.CanvasRenderCmd=function(b){cc.Node.CanvasRenderCmd.call(this,b);this._needDraw=true;this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:false};this._blendFuncStr="source-over";this._colorized=false;this._originalTexture=null;};var a=cc.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.Sprite.CanvasRenderCmd;a._init=function(){};a._setBlendFuncStr=function(b){this._blendFuncStr=b;};a.setDirtyRecursively=function(b){};a._resetForBatchNode=function(){};a._setTexture=function(c){var b=this._node;if(b._texture!=c){if(c){if(c.getHtmlElementObj() instanceof HTMLImageElement){this._originalTexture=c;}b._textureLoaded=c._textureLoaded;}else{b._textureLoaded=false;}b._texture=c;}};a._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty);};a.isFrameDisplayed=function(c){var b=this._node;if(c.getTexture()!=b._texture){return false;}return cc.rectEqualToRect(c.getRect(),b._rect);};a.updateBlendFunc=function(b){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(b);};a._setBatchNodeForAddChild=function(b){return true;};a._handleTextureForRotatedTexture=function(g,f,d,e){if(d&&g.isLoaded()){var b=g.getHtmlElementObj();b=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(b,f,e);var c=new cc.Texture2D();c.initWithElement(b);c.handleLoadedTexture();g=c;f.x=f.y=0;this._node._rect=cc.rect(0,0,f.width,f.height);}return g;};a._checkTextureBoundary=function(f,e,c){if(f&&f.url){var d=e.x+e.width,b=e.y+e.height;if(d>f.width){cc.error(cc._LogInfos.RectWidth,f.url);}if(b>f.height){cc.error(cc._LogInfos.RectHeight,f.url);}}this._node._originalTexture=f;};a.rendering=function(o,n,k){var e=this._node;var q=this._textureCoord,g=(this._displayedOpacity/255);if((e._texture&&((q.width===0||q.height===0)||!e._texture._textureLoaded))||g===0){return;}var b=o||cc._renderContext,c=b.getContext();var j=e._offsetPosition.x,i=e._rect.height,p=e._rect.width,h=-e._offsetPosition.y-i,f;b.setTransform(this._worldTransform,n,k);b.setCompositeOperation(this._blendFuncStr);b.setGlobalAlpha(g);if(e._flippedX||e._flippedY){b.save();}if(e._flippedX){j=-j-p;c.scale(-1,1);}if(e._flippedY){h=e._offsetPosition.y;c.scale(1,-1);}if(e._texture){f=e._texture._htmlElementObj;if(e._texture._pattern!=""){b.setFillStyle(c.createPattern(f,e._texture._pattern));c.fillRect(j*n,h*k,p*n,i*k);}else{if(this._colorized){c.drawImage(f,0,0,q.width,q.height,j*n,h*k,p*n,i*k);}else{c.drawImage(f,q.renderX,q.renderY,q.width,q.height,j*n,h*k,p*n,i*k);}}}else{var d=e._contentSize;if(q.validRect){var m=this._displayedColor;b.setFillStyle("rgba("+m.r+","+m.g+","+m.b+",1)");c.fillRect(j*n,h*k,d.width*n,d.height*k);}}if(e._flippedX||e._flippedY){b.restore();}cc.g_NumberOfDraws++;};if(!cc.sys._supportCanvasNewBlendModes){a._updateColor=function(){var f=this._node,e=this._displayedColor;if(e.r===255&&e.g===255&&e.b===255){if(this._colorized){this._colorized=false;f.texture=this._originalTexture;}return;}var g,b=f._texture,c=this._textureCoord;if(b&&c.validRect&&this._originalTexture){g=b.getHtmlElementObj();if(!g){return;}var d=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());if(d){this._colorized=true;if(g instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor){cc.Sprite.CanvasRenderCmd._generateTintImage(g,d,e,c,g);}else{g=cc.Sprite.CanvasRenderCmd._generateTintImage(g,d,e,c);b=new cc.Texture2D();b.initWithElement(g);b.handleLoadedTexture();f.texture=b;}}}};}else{a._updateColor=function(){var e=this._node,d=this._displayedColor;if(d.r===255&&d.g===255&&d.b===255){if(this._colorized){this._colorized=false;e.texture=this._originalTexture;}return;}var f,b=e._texture,c=this._textureCoord;if(b&&c.validRect&&this._originalTexture){f=b.getHtmlElementObj();if(!f){return;}this._colorized=true;if(f instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor&&this._originalTexture._htmlElementObj!=f){cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,d,c,f);}else{f=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,d,c);b=new cc.Texture2D();b.initWithElement(f);b.handleLoadedTexture();e.texture=b;}}};}a.getQuad=function(){return null;};a._updateForSetSpriteFrame=function(d,e){var c=this._node;if(c._rectRotated){c._originalTexture=d;}this._colorized=false;this._textureCoord.renderX=this._textureCoord.x;this._textureCoord.renderY=this._textureCoord.y;if(e){var b=c.getColor();if(b.r!==255||b.g!==255||b.b!==255){this._updateColor();}}};a.updateTransform=function(){var d=this,c=this._node;if(c.dirty){var b=c._parent;if(!c._visible||(b&&b!=c._batchNode&&b._shouldBeHidden)){c._shouldBeHidden=true;}else{c._shouldBeHidden=false;if(!b||b==c._batchNode){c._transformToBatch=d.getNodeToParentTransform();}else{c._transformToBatch=cc.affineTransformConcat(d.getNodeToParentTransform(),b._transformToBatch);}}c._recursiveDirty=false;c.dirty=false;}if(c._hasChildren){c._arrayMakeObjectsPerformSelector(c._children,cc.Node._stateCallbackType.updateTransform);}};a._updateDisplayColor=function(b){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,b);};a._spriteFrameLoadedCallback=function(c){var b=this;b.setTextureRect(c.getRect(),c.isRotated(),c.getOriginalSize());b._renderCmd._updateColor();b.dispatchEvent("load");};a._textureLoadedCallback=function(c){var e=this;if(e._textureLoaded){return;}e._textureLoaded=true;var b=e._rect,d=this._renderCmd;if(!b){b=cc.rect(0,0,c.width,c.height);}else{if(cc._rectEqualToZero(b)){b.width=c.width;b.height=c.height;}}d._originalTexture=c;e.texture=c;e.setTextureRect(b,e._rectRotated);var f=d._displayedColor;if(f.r!=255||f.g!=255||f.b!=255){d._updateColor();}e.setBatchNode(e._batchNode);e.dispatchEvent("load");};a._setTextureCoords=function(d,e){if(e===undefined){e=true;}var b=this._textureCoord,c=e?cc.contentScaleFactor():1;b.renderX=b.x=0|(d.x*c);b.renderY=b.y=0|(d.y*c);b.width=0|(d.width*c);b.height=0|(d.height*c);b.validRect=!(b.width===0||b.height===0||b.x<0||b.y<0);if(this._colorized){this._node._texture=this._originalTexture;this._colorized=false;this._updateColor();}};cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply=function(f,c,e,b){b=b||cc.newElement("canvas");e=e||cc.rect(0,0,f.width,f.height);var d=b.getContext("2d");if(b.width!=e.width||b.height!=e.height){b.width=e.width;b.height=e.height;}else{d.globalCompositeOperation="source-over";}d.fillStyle="rgb("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+")";d.fillRect(0,0,e.width,e.height);d.globalCompositeOperation="multiply";d.drawImage(f,e.x,e.y,e.width,e.height,0,0,e.width,e.height);d.globalCompositeOperation="destination-atop";d.drawImage(f,e.x,e.y,e.width,e.height,0,0,e.width,e.height);return b;};cc.Sprite.CanvasRenderCmd._generateTintImage=function(k,f,e,m,d){if(!m){m=cc.rect(0,0,k.width,k.height);}var c=e.r/255,j=e.g/255,n=e.b/255;var p=Math.min(m.width,f[0].width);var i=Math.min(m.height,f[0].height);var s=d,q;if(!s){s=cc.newElement("canvas");s.width=p;s.height=i;q=s.getContext("2d");}else{q=s.getContext("2d");q.clearRect(0,0,p,i);}q.save();q.globalCompositeOperation="lighter";var o=q.globalAlpha;if(c>0){q.globalAlpha=c*o;q.drawImage(f[0],m.x,m.y,p,i,0,0,p,i);}if(j>0){q.globalAlpha=j*o;q.drawImage(f[1],m.x,m.y,p,i,0,0,p,i);}if(n>0){q.globalAlpha=n*o;q.drawImage(f[2],m.x,m.y,p,i,0,0,p,i);}if(c+j+n<1){q.globalAlpha=o;q.drawImage(f[3],m.x,m.y,p,i,0,0,p,i);}q.restore();return s;};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor=function(c){if(c.channelCache){return c.channelCache;}var f=[cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas")];function b(){var e=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor;var q=c.width;var m=c.height;f[0].width=q;f[0].height=m;f[1].width=q;f[1].height=m;f[2].width=q;f[2].height=m;f[3].width=q;f[3].height=m;e.canvas.width=q;e.canvas.height=m;var r=e.canvas.getContext("2d");r.drawImage(c,0,0);e.tempCanvas.width=q;e.tempCanvas.height=m;var g=r.getImageData(0,0,q,m).data;for(var j=0;j<4;j++){var o=f[j].getContext("2d");o.getImageData(0,0,q,m).data;e.tempCtx.drawImage(c,0,0);var p=e.tempCtx.getImageData(0,0,q,m);var n=p.data;for(var k=0;k<g.length;k+=4){n[k]=(j===0)?g[k]:0;n[k+1]=(j===1)?g[k+1]:0;n[k+2]=(j===2)?g[k+2]:0;n[k+3]=g[k+3];}o.putImageData(p,0,0);}c.onload=null;}try{b();}catch(d){c.onload=b;}c.channelCache=f;return f;};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.canvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCtx=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas.getContext("2d");cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(f,e,d){if(!f){return null;}if(!e){return f;}d=d==null?true:d;var c=cc.newElement("canvas");c.width=e.width;c.height=e.height;var b=c.getContext("2d");b.translate(c.width/2,c.height/2);if(d){b.rotate(-1.5707963267948966);}else{b.rotate(1.5707963267948966);}b.drawImage(f,e.x,e.y,e.height,e.width,-e.height/2,-e.width/2,e.height,e.width);return c;};})();cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var a=document.createElement("canvas");a.width=a.height=10;this._cacheCanvas=a;this._cacheContext=new cc.CanvasContextWrapper(a.getContext("2d"));var b=new cc.Texture2D();b.initWithElement(a);b.handleLoadedTexture();this.setTexture(b);},getCacheContext:function(){return this._cacheContext;},getCacheCanvas:function(){return this._cacheCanvas;},resetCanvasSize:function(c,a){if(a===undefined){a=c.height;c=c.width;}var b=this._cacheCanvas;b.width=c;b.height=a;this.getTexture().handleLoadedTexture();this.setTextureRect(cc.rect(0,0,c,a),false);}});cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(c,b,a){this._spriteFrame=c||null;this._delayPerUnit=b||0;this._userInfo=a||null;},clone:function(){var a=new cc.AnimationFrame();a.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo);return a;},copyWithZone:function(a){return cc.clone(this);},copy:function(b){var a=new cc.AnimationFrame();a.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo);return a;},initWithSpriteFrame:function(c,b,a){this._spriteFrame=c;this._delayPerUnit=b;this._userInfo=a;return true;},getSpriteFrame:function(){return this._spriteFrame;},setSpriteFrame:function(a){this._spriteFrame=a;},getDelayUnits:function(){return this._delayPerUnit;},setDelayUnits:function(a){this._delayPerUnit=a;},getUserInfo:function(){return this._userInfo;},setUserInfo:function(a){this._userInfo=a;}});cc.AnimationFrame.create=function(c,b,a){return new cc.AnimationFrame(c,b,a);};cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:false,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(c,b,a){this._frames=[];if(c===undefined){this.initWithSpriteFrames(null,0);}else{var d=c[0];if(d){if(d instanceof cc.SpriteFrame){this.initWithSpriteFrames(c,b,a);}else{if(d instanceof cc.AnimationFrame){this.initWithAnimationFrames(c,b,a);}}}}},getFrames:function(){return this._frames;},setFrames:function(a){this._frames=a;},addSpriteFrame:function(b){var a=new cc.AnimationFrame();a.initWithSpriteFrame(b,1,null);this._frames.push(a);this._totalDelayUnits++;},addSpriteFrameWithFile:function(d){var b=cc.textureCache.addImage(d);var a=cc.rect(0,0,0,0);a.width=b.width;a.height=b.height;var c=new cc.SpriteFrame(b,a);this.addSpriteFrame(c);},addSpriteFrameWithTexture:function(c,b){var a=new cc.SpriteFrame(c,b);this.addSpriteFrame(a);},initWithAnimationFrames:function(c,f,a){cc.arrayVerifyType(c,cc.AnimationFrame);this._delayPerUnit=f;this._loops=a===undefined?1:a;this._totalDelayUnits=0;var d=this._frames;d.length=0;for(var b=0;b<c.length;b++){var e=c[b];d.push(e);this._totalDelayUnits+=e.getDelayUnits();}return true;},clone:function(){var a=new cc.Animation();a.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops);a.setRestoreOriginalFrame(this._restoreOriginalFrame);return a;},copyWithZone:function(b){var a=new cc.Animation();a.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops);a.setRestoreOriginalFrame(this._restoreOriginalFrame);return a;},_copyFrames:function(){var b=[];for(var a=0;a<this._frames.length;a++){b.push(this._frames[a].clone());}return b;},copy:function(a){return this.copyWithZone(null);},getLoops:function(){return this._loops;},setLoops:function(a){this._loops=a;},setRestoreOriginalFrame:function(a){this._restoreOriginalFrame=a;},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame;},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit;},getDelayPerUnit:function(){return this._delayPerUnit;},setDelayPerUnit:function(a){this._delayPerUnit=a;},getTotalDelayUnits:function(){return this._totalDelayUnits;},initWithSpriteFrames:function(g,b,a){cc.arrayVerifyType(g,cc.SpriteFrame);this._loops=a===undefined?1:a;this._delayPerUnit=b||0;this._totalDelayUnits=0;var d=this._frames;d.length=0;if(g){for(var c=0;c<g.length;c++){var f=g[c];var e=new cc.AnimationFrame();e.initWithSpriteFrame(f,1,null);d.push(e);}this._totalDelayUnits+=g.length;}return true;},retain:function(){},release:function(){}});cc.Animation.create=function(c,b,a){return new cc.Animation(c,b,a);};cc.Animation.createWithAnimationFrames=cc.Animation.create;cc.animationCache={_animations:{},addAnimation:function(b,a){this._animations[a]=b;},removeAnimation:function(a){if(!a){return;}if(this._animations[a]){delete this._animations[a];}},getAnimation:function(a){if(this._animations[a]){return this._animations[a];}return null;},_addAnimationsWithDictionary:function(f,g){var h=f["animations"];if(!h){cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary);return;}var d=1;var e=f["properties"];if(e){d=(e["format"]!=null)?parseInt(e["format"]):d;var a=e["spritesheets"];var c=cc.spriteFrameCache;var j=cc.path;for(var b=0;b<a.length;b++){c.addSpriteFrames(j.changeBasename(g,a[b]));}}switch(d){case 1:this._parseVersion1(h);break;case 2:this._parseVersion2(h);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2);break;}},addAnimations:function(a){cc.assert(a,cc._LogInfos.animationCache_addAnimations_2);var b=cc.loader.getRes(a);if(!b){cc.log(cc._LogInfos.animationCache_addAnimations);return;}this._addAnimationsWithDictionary(b,a);},_parseVersion1:function(m){var g=cc.spriteFrameCache;for(var k in m){var j=m[k];var a=j["frames"];var e=parseFloat(j["delay"])||0;var c=null;if(!a){cc.log(cc._LogInfos.animationCache__parseVersion1,k);continue;}var h=[];for(var d=0;d<a.length;d++){var b=g.getSpriteFrame(a[d]);if(!b){cc.log(cc._LogInfos.animationCache__parseVersion1_2,k,a[d]);continue;}var f=new cc.AnimationFrame();f.initWithSpriteFrame(b,1,null);h.push(f);}if(h.length===0){cc.log(cc._LogInfos.animationCache__parseVersion1_3,k);continue;}else{if(h.length!=a.length){cc.log(cc._LogInfos.animationCache__parseVersion1_4,k);}}c=new cc.Animation(h,e,1);cc.animationCache.addAnimation(c,k);}},_parseVersion2:function(g){var m=cc.spriteFrameCache;for(var t in g){var k=g[t];var r=k["loop"];var a=parseInt(k["loops"]);var e=r?cc.REPEAT_FOREVER:((isNaN(a))?1:a);var p=(k["restoreOriginalFrame"]&&k["restoreOriginalFrame"]==true)?true:false;var h=k["frames"];if(!h){cc.log(cc._LogInfos.animationCache__parseVersion2,t);continue;}var b=[];for(var o=0;o<h.length;o++){var c=h[o];var u=c["spriteframe"];var d=m.getSpriteFrame(u);if(!d){cc.log(cc._LogInfos.animationCache__parseVersion2_2,t,u);continue;}var j=parseFloat(c["delayUnits"])||0;var f=c["notification"];var s=new cc.AnimationFrame();s.initWithSpriteFrame(d,j,f);b.push(s);}var n=parseFloat(k["delayPerUnit"])||0;var q=new cc.Animation();q.initWithAnimationFrames(b,n,e);q.setRestoreOriginalFrame(p);cc.animationCache.addAnimation(q,t);}},_clear:function(){this._animations={};}};cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:false,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:false,ctor:function(b,d,a,e,c){this._offset=cc.p(0,0);this._offsetInPixels=cc.p(0,0);this._originalSize=cc.size(0,0);this._rotated=false;this._originalSizeInPixels=cc.size(0,0);this._textureFilename="";this._texture=null;this._textureLoaded=false;if(b!==undefined&&d!==undefined){if(a===undefined||e===undefined||c===undefined){this.initWithTexture(b,d);}else{this.initWithTexture(b,d,a,e,c);}}},textureLoaded:function(){return this._textureLoaded;},addLoadedEventListener:function(b,a){this.addEventListener("load",b,a);},getRectInPixels:function(){var a=this._rectInPixels;return cc.rect(a.x,a.y,a.width,a.height);},setRectInPixels:function(a){if(!this._rectInPixels){this._rectInPixels=cc.rect(0,0,0,0);}this._rectInPixels.x=a.x;this._rectInPixels.y=a.y;this._rectInPixels.width=a.width;this._rectInPixels.height=a.height;this._rect=cc.rectPixelsToPoints(a);},isRotated:function(){return this._rotated;},setRotated:function(a){this._rotated=a;},getRect:function(){var a=this._rect;return cc.rect(a.x,a.y,a.width,a.height);},setRect:function(a){if(!this._rect){this._rect=cc.rect(0,0,0,0);}this._rect.x=a.x;this._rect.y=a.y;this._rect.width=a.width;this._rect.height=a.height;this._rectInPixels=cc.rectPointsToPixels(this._rect);},getOffsetInPixels:function(){return cc.p(this._offsetInPixels);},setOffsetInPixels:function(a){this._offsetInPixels.x=a.x;this._offsetInPixels.y=a.y;cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset);},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels);},setOriginalSizeInPixels:function(a){this._originalSizeInPixels.width=a.width;this._originalSizeInPixels.height=a.height;},getOriginalSize:function(){return cc.size(this._originalSize);},setOriginalSize:function(a){this._originalSize.width=a.width;this._originalSize.height=a.height;},getTexture:function(){if(this._texture){return this._texture;}if(this._textureFilename!==""){var a=cc.textureCache.addImage(this._textureFilename);if(a){this._textureLoaded=a.isLoaded();}return a;}return null;},setTexture:function(b){if(this._texture!=b){var a=b.isLoaded();this._textureLoaded=a;this._texture=b;if(!a){b.addEventListener("load",function(g){this._textureLoaded=true;if(this._rotated&&cc._renderType===cc._RENDER_TYPE_CANVAS){var c=g.getHtmlElementObj();c=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(c,this.getRect());var f=new cc.Texture2D();f.initWithElement(c);f.handleLoadedTexture();this.setTexture(f);var j=this.getRect();this.setRect(cc.rect(0,0,j.width,j.height));}var e=this._rect;if(e.width===0&&e.height===0){var d=g.width,i=g.height;this._rect.width=d;this._rect.height=i;this._rectInPixels=cc.rectPointsToPixels(this._rect);this._originalSizeInPixels.width=this._rectInPixels.width;this._originalSizeInPixels.height=this._rectInPixels.height;this._originalSize.width=d;this._originalSize.height=i;}this.dispatchEvent("load");},this);}}},getOffset:function(){return cc.p(this._offset);},setOffset:function(a){this._offset.x=a.x;this._offset.y=a.y;},clone:function(){var a=new cc.SpriteFrame();a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels);a.setTexture(this._texture);return a;},copyWithZone:function(){var a=new cc.SpriteFrame();a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels);a.setTexture(this._texture);return a;},copy:function(){return this.copyWithZone();},initWithTexture:function(f,e,b,g,d){if(arguments.length===2){e=cc.rectPointsToPixels(e);}g=g||cc.p(0,0);d=d||e;b=b||false;if(cc.isString(f)){this._texture=null;this._textureFilename=f;}else{if(f instanceof cc.Texture2D){this.setTexture(f);}}f=this.getTexture();this._rectInPixels=e;e=this._rect=cc.rectPixelsToPoints(e);if(f&&f.url&&f.isLoaded()){var c,a;if(b){c=e.x+e.height;a=e.y+e.width;}else{c=e.x+e.width;a=e.y+e.height;}if(c>f.getPixelsWide()){cc.error(cc._LogInfos.RectWidth,f.url);}if(a>f.getPixelsHigh()){cc.error(cc._LogInfos.RectHeight,f.url);}}this._offsetInPixels.x=g.x;this._offsetInPixels.y=g.y;cc._pointPixelsToPointsOut(g,this._offset);this._originalSizeInPixels.width=d.width;this._originalSizeInPixels.height=d.height;cc._sizePixelsToPointsOut(d,this._originalSize);this._rotated=b;return true;}});cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype);cc.SpriteFrame.create=function(b,d,a,e,c){return new cc.SpriteFrame(b,d,a,e,c);};cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create;cc.SpriteFrame._frameWithTextureForCanvas=function(d,c,a,f,b){var e=new cc.SpriteFrame();e._texture=d;e._rectInPixels=c;e._rect=cc.rectPixelsToPoints(c);e._offsetInPixels.x=f.x;e._offsetInPixels.y=f.y;cc._pointPixelsToPointsOut(e._offsetInPixels,e._offset);e._originalSizeInPixels.width=b.width;e._originalSizeInPixels.height=b.height;cc._sizePixelsToPointsOut(e._originalSizeInPixels,e._originalSize);e._rotated=a;return e;};cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(b){var a=this._CCNS_REG2.exec(b);if(!a){return cc.rect(0,0,0,0);}return cc.rect(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4]));},_pointFromString:function(b){var a=this._CCNS_REG1.exec(b);if(!a){return cc.p(0,0);}return cc.p(parseFloat(a[1]),parseFloat(a[2]));},_sizeFromString:function(b){var a=this._CCNS_REG1.exec(b);if(!a){return cc.size(0,0);}return cc.size(parseFloat(a[1]),parseFloat(a[2]));},_getFrameConfig:function(a){var b=cc.loader.getRes(a);cc.assert(b,cc._LogInfos.spriteFrameCache__getFrameConfig_2,a);cc.loader.release(a);if(b._inited){this._frameConfigCache[a]=b;return b;}this._frameConfigCache[a]=this._parseFrameConfig(b);return this._frameConfigCache[a];},_getFrameConfigByJsonObject:function(a,b){cc.assert(b,cc._LogInfos.spriteFrameCache__getFrameConfig_2,a);this._frameConfigCache[a]=this._parseFrameConfig(b);return this._frameConfigCache[a];},_parseFrameConfig:function(b){var g=b["frames"],q=b["metadata"]||b["meta"];var j={},p={};var k=0;if(q){var f=q["format"];k=(f.length<=1)?parseInt(f):f;p.image=q["textureFileName"]||q["textureFileName"]||q["image"];}for(var n in g){var i=g[n];if(!i){continue;}var d={};if(k==0){d.rect=cc.rect(i["x"],i["y"],i["width"],i["height"]);d.rotated=false;d.offset=cc.p(i["offsetX"],i["offsetY"]);var a=i["originalWidth"];var m=i["originalHeight"];if(!a||!m){cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig);}a=Math.abs(a);m=Math.abs(m);d.size=cc.size(a,m);}else{if(k==1||k==2){d.rect=this._rectFromString(i["frame"]);d.rotated=i["rotated"]||false;d.offset=this._pointFromString(i["offset"]);d.size=this._sizeFromString(i["sourceSize"]);}else{if(k==3){var c=this._sizeFromString(i["spriteSize"]);var o=this._rectFromString(i["textureRect"]);if(c){o=cc.rect(o.x,o.y,c.width,c.height);}d.rect=o;d.rotated=i["textureRotated"]||false;d.offset=this._pointFromString(i["spriteOffset"]);d.size=this._sizeFromString(i["spriteSourceSize"]);d.aliases=i["aliases"];}else{var h=i["frame"],e=i["sourceSize"];n=i["filename"]||n;d.rect=cc.rect(h["x"],h["y"],h["w"],h["h"]);d.rotated=i["rotated"]||false;d.offset=cc.p(0,0);d.size=cc.size(e["w"],e["h"]);}}}j[n]=d;}return{_inited:true,frames:j,meta:p};},_addSpriteFramesByObject:function(a,b,d){cc.assert(a,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);if(!b||!b["frames"]){return;}var c=this._frameConfigCache[a]||this._getFrameConfigByJsonObject(a,b);this._createSpriteFrames(c,d);},_createSpriteFrames:function(q,n){var g=q.frames,h=q.meta;if(!n){var f=cc.path.changeBasename(url,h.image||".png");n=cc.textureCache.addImage(f);}else{if(n instanceof cc.Texture2D){}else{if(cc.isString(n)){n=cc.textureCache.addImage(n);}else{cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3);}}}var a=this._spriteFramesAliases,d=this._spriteFrames;for(var t in g){var m=g[t];var e=d[t];if(!e){e=new cc.SpriteFrame(n,m.rect,m.rotated,m.offset,m.size);var s=m.aliases;if(s){for(var r=0,j=s.length;r<j;r++){var o=s[r];if(a[o]){cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,o);}a[o]=t;}}if(cc._renderType===cc._RENDER_TYPE_CANVAS&&e.isRotated()){var p=e.getTexture();if(p.isLoaded()){var c=e.getTexture().getHtmlElementObj();c=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(c,e.getRectInPixels());var k=new cc.Texture2D();k.initWithElement(c);k.handleLoadedTexture();e.setTexture(k);var b=e._rect;e.setRect(cc.rect(0,0,b.width,b.height));}}d[t]=e;}}},addSpriteFrames:function(a,c){cc.assert(a,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var d=this._frameConfigCache[a]||cc.loader.getRes(a);if(!d||!d["frames"]){return;}var b=this._frameConfigCache[a]||this._getFrameConfig(a);this._createSpriteFrames(b,c);},_checkConflict:function(c){var b=c["frames"];for(var a in b){if(this._spriteFrames[a]){cc.log(cc._LogInfos.spriteFrameCache__checkConflict,a);}}},addSpriteFrame:function(b,a){this._spriteFrames[a]=b;},removeSpriteFrames:function(){this._spriteFrames={};this._spriteFramesAliases={};},removeSpriteFrameByName:function(a){if(!a){return;}if(this._spriteFramesAliases[a]){delete (this._spriteFramesAliases[a]);}if(this._spriteFrames[a]){delete (this._spriteFrames[a]);}},removeSpriteFramesFromFile:function(d){var c=this,g=c._spriteFrames,b=c._spriteFramesAliases,a=c._frameConfigCache[d];if(!a){return;}var h=a.frames;for(var f in h){if(g[f]){delete (g[f]);for(var e in b){if(b[e]==f){delete b[e];}}}}},removeSpriteFramesFromTexture:function(f){var b=this,e=b._spriteFrames,a=b._spriteFramesAliases;for(var d in e){var g=e[d];if(g&&(g.getTexture()==f)){delete (e[d]);for(var c in a){if(a[c]==d){delete a[c];}}}}},getSpriteFrame:function(b){var a=this,d=a._spriteFrames[b];if(!d){var c=a._spriteFramesAliases[b];if(c){d=a._spriteFrames[c.toString()];if(!d){delete a._spriteFramesAliases[b];}}}return d;},_clear:function(){this._spriteFrames={};this._spriteFramesAliases={};this._frameConfigCache={};}};cc.g_NumberOfDraws=0;cc.GLToClipTransform=function(b){var a=new cc.kmMat4();cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,a);var c=new cc.kmMat4();cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,c);cc.kmMat4Multiply(b,a,c);};cc.Director=cc.Class.extend({_landscape:false,_nextDeltaTimeZero:false,_paused:false,_purgeDirectorInNextLoop:false,_sendCleanupToScene:false,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_accumDt:0,_contentScaleFactor:1,_displayStats:false,_deltaTime:0,_frameRate:0,_FPSLabel:null,_SPFLabel:null,_drawsLabel:null,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_frames:0,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterDraw:null,_eventAfterVisit:null,_eventAfterUpdate:null,ctor:function(){var a=this;a._lastUpdate=Date.now();cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){a._lastUpdate=Date.now();});},init:function(){this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS;this._scenesStack=[];this._projection=cc.Director.PROJECTION_DEFAULT;this._projectionDelegate=null;this._accumDt=0;this._frameRate=0;this._displayStats=false;this._totalFrames=this._frames=0;this._lastUpdate=Date.now();this._paused=false;this._purgeDirectorInNextLoop=false;this._winSizeInPoints=cc.size(0,0);this._openGLView=null;this._contentScaleFactor=1;this._scheduler=new cc.Scheduler();this._actionManager=cc.ActionManager?new cc.ActionManager():null;this._scheduler.scheduleUpdateForTarget(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,false);this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW);this._eventAfterDraw.setUserData(this);this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT);this._eventAfterVisit.setUserData(this);this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE);this._eventAfterUpdate.setUserData(this);this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED);this._eventProjectionChanged.setUserData(this);return true;},calculateDeltaTime:function(){var a=Date.now();if(this._nextDeltaTimeZero){this._deltaTime=0;this._nextDeltaTimeZero=false;}else{this._deltaTime=(a-this._lastUpdate)/1000;}if((cc.game.config[cc.game.CONFIG_KEY.debugMode]>0)&&(this._deltaTime>0.2)){this._deltaTime=1/60;}this._lastUpdate=a;},convertToGL:null,convertToUI:null,drawScene:function(){var a=cc.renderer;this.calculateDeltaTime();if(!this._paused){this._scheduler.update(this._deltaTime);cc.eventManager.dispatchEvent(this._eventAfterUpdate);}this._clear();if(this._nextScene){this.setNextScene();}if(this._beforeVisitScene){this._beforeVisitScene();}if(this._runningScene){if(a.childrenOrderDirty===true){cc.renderer.clearRenderCommands();this._runningScene._renderCmd._curLevel=0;this._runningScene.visit();a.resetFlag();}else{if(a.transformDirty()===true){a.transform();}}cc.eventManager.dispatchEvent(this._eventAfterVisit);}if(this._notificationNode){this._notificationNode.visit();}if(this._displayStats){this._showStats();}if(this._afterVisitScene){this._afterVisitScene();}a.rendering(cc._renderContext);cc.eventManager.dispatchEvent(this._eventAfterDraw);this._totalFrames++;if(this._displayStats){this._calculateMPF();}},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=true;},getContentScaleFactor:function(){return this._contentScaleFactor;},getNotificationNode:function(){return this._notificationNode;},getWinSize:function(){return cc.size(this._winSizeInPoints);},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor);},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){if(this._paused){return;}this._oldAnimationInterval=this._animationInterval;this.setAnimationInterval(1/4);this._paused=true;},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene);this._scenesStack.pop();var a=this._scenesStack.length;if(a==0){this.end();}else{this._sendCleanupToScene=true;this._nextScene=this._scenesStack[a-1];}},purgeCachedData:function(){cc.animationCache._clear();cc.spriteFrameCache._clear();cc.textureCache._clear();},purgeDirector:function(){this.getScheduler().unscheduleAllCallbacks();if(cc.eventManager){cc.eventManager.setEnabled(false);}if(this._runningScene){this._runningScene.onExitTransitionDidStart();this._runningScene.onExit();this._runningScene.cleanup();}this._runningScene=null;this._nextScene=null;this._scenesStack.length=0;this.stopAnimation();this.purgeCachedData();cc.checkGLErrorDebug();},pushScene:function(a){cc.assert(a,cc._LogInfos.Director_pushScene);this._sendCleanupToScene=false;this._scenesStack.push(a);this._nextScene=a;},runScene:function(b){cc.assert(b,cc._LogInfos.Director_pushScene);if(!this._runningScene){this.pushScene(b);this.startAnimation();}else{var a=this._scenesStack.length;if(a===0){this._sendCleanupToScene=true;this._scenesStack[a]=b;this._nextScene=b;}else{this._sendCleanupToScene=true;this._scenesStack[a-1]=b;this._nextScene=b;}}},resume:function(){if(!this._paused){return;}this.setAnimationInterval(this._oldAnimationInterval);this._lastUpdate=Date.now();if(!this._lastUpdate){cc.log(cc._LogInfos.Director_resume);}this._paused=false;this._deltaTime=0;},setContentScaleFactor:function(a){if(a!=this._contentScaleFactor){this._contentScaleFactor=a;this._createStatsLabel();}},setDepthTest:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(a){this._nextDeltaTimeZero=a;},setNextScene:function(){var b=false,a=false;if(cc.TransitionScene){b=this._runningScene?this._runningScene instanceof cc.TransitionScene:false;a=this._nextScene?this._nextScene instanceof cc.TransitionScene:false;}if(!a){var c=this._runningScene;if(c){c.onExitTransitionDidStart();c.onExit();}if(this._sendCleanupToScene&&c){c.cleanup();}}this._runningScene=this._nextScene;cc.renderer.childrenOrderDirty=true;this._nextScene=null;if((!b)&&(this._runningScene!=null)){this._runningScene.onEnter();this._runningScene.onEnterTransitionDidFinish();}},setNotificationNode:function(a){this._notificationNode=a;},getDelegate:function(){return this._projectionDelegate;},setDelegate:function(a){this._projectionDelegate=a;},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,_showStats:function(){this._frames++;this._accumDt+=this._deltaTime;if(this._FPSLabel&&this._SPFLabel&&this._drawsLabel){if(this._accumDt>cc.DIRECTOR_FPS_INTERVAL){this._SPFLabel.string=this._secondsPerFrame.toFixed(3);this._frameRate=this._frames/this._accumDt;this._frames=0;this._accumDt=0;this._FPSLabel.string=this._frameRate.toFixed(1);this._drawsLabel.string=(0|cc.g_NumberOfDraws).toString();}this._FPSLabel.visit();this._SPFLabel.visit();this._drawsLabel.visit();}else{this._createStatsLabel();}cc.g_NumberOfDraws=0;},isSendCleanupToScene:function(){return this._sendCleanupToScene;},getRunningScene:function(){return this._runningScene;},getAnimationInterval:function(){return this._animationInterval;},isDisplayStats:function(){return this._displayStats;},setDisplayStats:function(a){this._displayStats=a;},getSecondsPerFrame:function(){return this._secondsPerFrame;},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero;},isPaused:function(){return this._paused;},getTotalFrames:function(){return this._totalFrames;},popToRootScene:function(){this.popToSceneStackLevel(1);},popToSceneStackLevel:function(e){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var a=this._scenesStack;var d=a.length;if(d==0){this.end();return;}if(e>d){return;}while(d>e){var b=a.pop();if(b.running){b.onExitTransitionDidStart();b.onExit();}b.cleanup();d--;}this._nextScene=a[a.length-1];this._sendCleanupToScene=false;},getScheduler:function(){return this._scheduler;},setScheduler:function(a){if(this._scheduler!=a){this._scheduler=a;}},getActionManager:function(){return this._actionManager;},setActionManager:function(a){if(this._actionManager!=a){this._actionManager=a;}},getDeltaTime:function(){return this._deltaTime;},_createStatsLabel:null,_calculateMPF:function(){var a=Date.now();this._secondsPerFrame=(a-this._lastUpdate)/1000;}});cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed";cc.Director.EVENT_AFTER_DRAW="director_after_draw";cc.Director.EVENT_AFTER_VISIT="director_after_visit";cc.Director.EVENT_AFTER_UPDATE="director_after_update";cc.DisplayLinkDirector=cc.Director.extend({invalid:false,startAnimation:function(){this._nextDeltaTimeZero=true;this.invalid=false;},mainLoop:function(){if(this._purgeDirectorInNextLoop){this._purgeDirectorInNextLoop=false;this.purgeDirector();}else{if(!this.invalid){this.drawScene();}}},stopAnimation:function(){this.invalid=true;},setAnimationInterval:function(a){this._animationInterval=a;if(!this.invalid){this.stopAnimation();this.startAnimation();}}});cc.Director.sharedDirector=null;cc.Director.firstUseDirector=true;cc.Director._getInstance=function(){if(cc.Director.firstUseDirector){cc.Director.firstUseDirector=false;cc.Director.sharedDirector=new cc.DisplayLinkDirector();cc.Director.sharedDirector.init();}return cc.Director.sharedDirector;};cc.defaultFPS=60;cc.Director.PROJECTION_2D=0;cc.Director.PROJECTION_3D=1;cc.Director.PROJECTION_CUSTOM=3;cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D;if(cc._renderType===cc._RENDER_TYPE_CANVAS){var _p=cc.Director.prototype;_p.setProjection=function(a){this._projection=a;cc.eventManager.dispatchEvent(this._eventProjectionChanged);};_p.setDepthTest=function(){};_p.setOpenGLView=function(a){this._winSizeInPoints.width=cc._canvas.width;this._winSizeInPoints.height=cc._canvas.height;this._openGLView=a||cc.view;if(cc.eventManager){cc.eventManager.setEnabled(true);}};_p._clear=function(){var a=this._openGLView.getViewPortRect();var b=cc._renderContext.getContext();b.setTransform(1,0,0,1,0,0);b.clearRect(-a.x,a.y,a.width,a.height);};_p._createStatsLabel=function(){var c=this;var b=0;if(c._winSizeInPoints.width>c._winSizeInPoints.height){b=0|(c._winSizeInPoints.height/320*24);}else{b=0|(c._winSizeInPoints.width/320*24);}c._FPSLabel=new cc.LabelTTF("000.0","Arial",b);c._SPFLabel=new cc.LabelTTF("0.000","Arial",b);c._drawsLabel=new cc.LabelTTF("0000","Arial",b);var a=cc.DIRECTOR_STATS_POSITION;c._drawsLabel.setPosition(c._drawsLabel.width/2+a.x,c._drawsLabel.height*5/2+a.y);c._SPFLabel.setPosition(c._SPFLabel.width/2+a.x,c._SPFLabel.height*3/2+a.y);c._FPSLabel.setPosition(c._FPSLabel.width/2+a.x,c._FPSLabel.height/2+a.y);};_p.getVisibleSize=function(){return this.getWinSize();};_p.getVisibleOrigin=function(){return cc.p(0,0);};}else{cc.Director._fpsImage=new Image();cc._addEventListener(cc.Director._fpsImage,"load",function(){cc.Director._fpsImageLoaded=true;});if(cc._fpsImage){cc.Director._fpsImage.src=cc._fpsImage;}}cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1;cc.ListEntry=function(d,c,e,b,a,f){this.prev=d;this.next=c;this.target=e;this.priority=b;this.paused=a;this.markedForDeletion=f;};cc.HashUpdateEntry=function(c,b,d,a){this.list=c;this.entry=b;this.target=d;this.hh=a;};cc.HashTimerEntry=function(e,g,h,f,d,b,a){var c=this;c.timers=e;c.target=g;c.timerIndex=h;c.currentTimer=f;c.currentTimerSalvaged=d;c.paused=b;c.hh=a;};cc.Timer=cc.Class.extend({_interval:0,_callback:null,_target:null,_elapsed:0,_runForever:false,_useDelay:false,_timesExecuted:0,_repeat:0,_delay:0,getInterval:function(){return this._interval;},setInterval:function(a){this._interval=a;},getCallback:function(){return this._callback;},ctor:function(e,f,b,d,c){var a=this;a._target=e;a._callback=f;a._elapsed=-1;a._interval=b||0;a._delay=c||0;a._useDelay=a._delay>0;a._repeat=(d==null)?cc.REPEAT_FOREVER:d;a._runForever=(a._repeat==cc.REPEAT_FOREVER);},_doCallback:function(){var a=this;if(cc.isString(a._callback)){a._target[a._callback](a._elapsed);}else{a._callback.call(a._target,a._elapsed);}},update:function(c){var a=this;if(a._elapsed==-1){a._elapsed=0;a._timesExecuted=0;}else{var b=a._target,d=a._callback;a._elapsed+=c;if(a._runForever&&!a._useDelay){if(a._elapsed>=a._interval){if(b&&d){a._doCallback();}a._elapsed=0;}}else{if(a._useDelay){if(a._elapsed>=a._delay){if(b&&d){a._doCallback();}a._elapsed=a._elapsed-a._delay;a._timesExecuted+=1;a._useDelay=false;}}else{if(a._elapsed>=a._interval){if(b&&d){a._doCallback();}a._elapsed=0;a._timesExecuted+=1;}}if(a._timesExecuted>a._repeat){cc.director.getScheduler().unscheduleCallbackForTarget(b,d);}}}}});cc.Scheduler=cc.Class.extend({_timeScale:1,_updates:null,_hashForUpdates:null,_arrayForUpdates:null,_hashForTimers:null,_arrayForTimes:null,_currentTarget:null,_currentTargetSalvaged:false,_updateHashLocked:false,ctor:function(){var a=this;a._timeScale=1;a._updates=[[],[],[]];a._hashForUpdates={};a._arrayForUpdates=[];a._hashForTimers={};a._arrayForTimers=[];a._currentTarget=null;a._currentTargetSalvaged=false;a._updateHashLocked=false;},_removeHashElement:function(a){delete this._hashForTimers[a.target.__instanceId];cc.arrayRemoveObject(this._arrayForTimers,a);a.Timer=null;a.target=null;a=null;},_removeUpdateFromHash:function(c){var a=this,b=a._hashForUpdates[c.target.__instanceId];if(b){cc.arrayRemoveObject(b.list,b.entry);delete a._hashForUpdates[b.target.__instanceId];cc.arrayRemoveObject(a._arrayForUpdates,b);b.entry=null;b.target=null;}},_priorityIn:function(b,c,f,h){var j=this,g=new cc.ListEntry(null,null,c,f,h,false);if(!b){b=[];b.push(g);}else{var e=b.length-1;for(var a=0;a<=e;a++){if(f<b[a].priority){e=a;break;}}b.splice(a,0,g);}var d=new cc.HashUpdateEntry(b,g,c,null);j._arrayForUpdates.push(d);j._hashForUpdates[c.__instanceId]=d;return b;},_appendIn:function(e,f,c){var b=this,d=new cc.ListEntry(null,null,f,0,c,false);e.push(d);var a=new cc.HashUpdateEntry(e,d,f,null);b._arrayForUpdates.push(a);b._hashForUpdates[f.__instanceId]=a;},setTimeScale:function(a){this._timeScale=a;},getTimeScale:function(){return this._timeScale;},update:function(b){var n=this;var a=n._updates,d=n._arrayForTimers;var c,e,h,m;n._updateHashLocked=true;if(this._timeScale!=1){b*=this._timeScale;}for(h=0,m=a.length;h<m&&h>=0;h++){var g=n._updates[h];for(var f=0,k=g.length;f<k;f++){c=g[f];if((!c.paused)&&(!c.markedForDeletion)){c.target.update(b);}}}for(h=0,m=d.length;h<m;h++){e=d[h];if(!e){break;}n._currentTarget=e;n._currentTargetSalvaged=false;if(!e.paused){for(e.timerIndex=0;e.timerIndex<e.timers.length;e.timerIndex++){e.currentTimer=e.timers[e.timerIndex];e.currentTimerSalvaged=false;e.currentTimer.update(b);e.currentTimer=null;}}if((n._currentTargetSalvaged)&&(e.timers.length==0)){n._removeHashElement(e);h--;}}for(h=0,m=a.length;h<m;h++){var g=n._updates[h];for(var f=0,k=g.length;f<k;){c=g[f];if(!c){break;}if(c.markedForDeletion){n._removeUpdateFromHash(c);}else{f++;}}}n._updateHashLocked=false;n._currentTarget=null;},scheduleCallbackForTarget:function(g,j,c,b,f,h){cc.assert(j,cc._LogInfos.Scheduler_scheduleCallbackForTarget_2);cc.assert(g,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3);c=c||0;b=(b==null)?cc.REPEAT_FOREVER:b;f=f||0;h=h||false;var k=this,a;var e=k._hashForTimers[g.__instanceId];if(!e){e=new cc.HashTimerEntry(null,g,0,null,null,h,null);k._arrayForTimers.push(e);k._hashForTimers[g.__instanceId]=e;}if(e.timers==null){e.timers=[];}else{for(var d=0;d<e.timers.length;d++){a=e.timers[d];if(j==a._callback){cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,a.getInterval().toFixed(4),c.toFixed(4));a._interval=c;return;}}}a=new cc.Timer(g,j,c,b,f);e.timers.push(a);},scheduleUpdateForTarget:function(f,e,d){if(f===null){return;}var b=this,c=b._updates;var a=b._hashForUpdates[f.__instanceId];if(a){a.entry.markedForDeletion=false;return;}if(e==0){b._appendIn(c[1],f,d);}else{if(e<0){c[0]=b._priorityIn(c[0],f,e,d);}else{c[2]=b._priorityIn(c[2],f,e,d);}}},unscheduleCallbackForTarget:function(f,h){if((f==null)||(h==null)){return;}var b=this,d=b._hashForTimers[f.__instanceId];if(d){var e=d.timers;for(var c=0,a=e.length;c<a;c++){var g=e[c];if(h==g._callback){if((g==d.currentTimer)&&(!d.currentTimerSalvaged)){d.currentTimerSalvaged=true;}e.splice(c,1);if(d.timerIndex>=c){d.timerIndex--;}if(e.length==0){if(b._currentTarget==d){b._currentTargetSalvaged=true;}else{b._removeHashElement(d);}}return;}}}},unscheduleUpdateForTarget:function(c){if(c==null){return;}var a=this,b=a._hashForUpdates[c.__instanceId];if(b!=null){if(a._updateHashLocked){b.entry.markedForDeletion=true;}else{a._removeUpdateFromHash(b.entry);}}},unscheduleAllCallbacksForTarget:function(d){if(d==null){return;}var a=this,b=a._hashForTimers[d.__instanceId];if(b){var c=b.timers;if((!b.currentTimerSalvaged)&&(c.indexOf(b.currentTimer)>=0)){b.currentTimerSalvaged=true;}c.length=0;if(a._currentTarget==b){a._currentTargetSalvaged=true;}else{a._removeHashElement(b);}}a.unscheduleUpdateForTarget(d);},unscheduleAllCallbacks:function(){this.unscheduleAllCallbacksWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);},unscheduleAllCallbacksWithMinPriority:function(g){var k=this,b=k._arrayForTimers,a=k._updates;for(var d=0,h=b.length;d<h;d++){k.unscheduleAllCallbacksForTarget(b[d].target);}for(var d=2;d>=0;d--){if((d==1&&g>0)||(d==0&&g>=0)){continue;}var f=a[d];for(var c=0,e=f.length;c<e;c++){k.unscheduleUpdateForTarget(f[c].target);}}},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);},pauseAllTargetsWithMinPriority:function(k){var f=[];var n=this,d,b=n._arrayForTimers,a=n._updates;for(var e=0,m=b.length;e<m;e++){d=b[e];if(d){d.paused=true;f.push(d.target);}}for(var e=0,m=a.length;e<m;e++){var h=a[e];for(var c=0,g=h.length;c<g;c++){d=h[c];if(d){d.paused=true;f.push(d.target);}}}return f;},resumeTargets:function(a){if(!a){return;}for(var b=0;b<a.length;b++){this.resumeTarget(a[b]);}},pauseTarget:function(d){cc.assert(d,cc._LogInfos.Scheduler_pauseTarget);var a=this,c=a._hashForTimers[d.__instanceId];if(c){c.paused=true;}var b=a._hashForUpdates[d.__instanceId];if(b){b.entry.paused=true;}},resumeTarget:function(d){cc.assert(d,cc._LogInfos.Scheduler_resumeTarget);var a=this,c=a._hashForTimers[d.__instanceId];if(c){c.paused=false;}var b=a._hashForUpdates[d.__instanceId];if(b){b.entry.paused=false;}},isTargetPaused:function(b){cc.assert(b,cc._LogInfos.Scheduler_isTargetPaused);var a=this._hashForTimers[b.__instanceId];if(a){return a.paused;}return false;}});cc.Scheduler.PRIORITY_SYSTEM=(-2147483647-1);cc._tmp.PrototypeLabelTTF=function(){var a=cc.LabelTTF.prototype;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.string;cc.defineGetterSetter(a,"string",a.getString,a.setString);a.textAlign;cc.defineGetterSetter(a,"textAlign",a.getHorizontalAlignment,a.setHorizontalAlignment);a.verticalAlign;cc.defineGetterSetter(a,"verticalAlign",a.getVerticalAlignment,a.setVerticalAlignment);a.fontSize;cc.defineGetterSetter(a,"fontSize",a.getFontSize,a.setFontSize);a.fontName;cc.defineGetterSetter(a,"fontName",a.getFontName,a.setFontName);a.font;cc.defineGetterSetter(a,"font",a._getFont,a._setFont);a.boundingSize;a.boundingWidth;cc.defineGetterSetter(a,"boundingWidth",a._getBoundingWidth,a._setBoundingWidth);a.boundingHeight;cc.defineGetterSetter(a,"boundingHeight",a._getBoundingHeight,a._setBoundingHeight);a.fillStyle;cc.defineGetterSetter(a,"fillStyle",a._getFillStyle,a.setFontFillColor);a.strokeStyle;cc.defineGetterSetter(a,"strokeStyle",a._getStrokeStyle,a._setStrokeStyle);a.lineWidth;cc.defineGetterSetter(a,"lineWidth",a._getLineWidth,a._setLineWidth);a.shadowOffset;a.shadowOffsetX;cc.defineGetterSetter(a,"shadowOffsetX",a._getShadowOffsetX,a._setShadowOffsetX);a.shadowOffsetY;cc.defineGetterSetter(a,"shadowOffsetY",a._getShadowOffsetY,a._setShadowOffsetY);a.shadowOpacity;cc.defineGetterSetter(a,"shadowOpacity",a._getShadowOpacity,a._setShadowOpacity);a.shadowBlur;cc.defineGetterSetter(a,"shadowBlur",a._getShadowBlur,a._setShadowBlur);};cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_shadowEnabled:false,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:false,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:false,_lineWidths:null,_className:"LabelTTF",_lineHeight:0,_fontStyle:"normal",_fontWeight:"normal",initWithString:function(a,c,e,b,f,d){var g;if(a){g=a+"";}else{g="";}e=e||16;b=b||cc.size(0,0);f=f||cc.TEXT_ALIGNMENT_LEFT;d=d||cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=false;this._dimensions=cc.size(b.width,b.height);this._fontName=c||"Arial";this._hAlignment=f;this._vAlignment=d;this._fontSize=e;this._renderCmd._setFontStyle(this._fontName,e,this._fontStyle,this._fontWeight);this.string=g;this._renderCmd._setColorsString();this._renderCmd._updateTexture();this._setUpdateTextureDirty();return true;},_setUpdateTextureDirty:function(){this._needUpdateTexture=true;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty);},ctor:function(f,b,d,a,e,c){cc.Sprite.prototype.ctor.call(this);this._dimensions=cc.size(0,0);this._hAlignment=cc.TEXT_ALIGNMENT_LEFT;this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=false;this._fontName="Arial";this._shadowEnabled=false;this._shadowOffset=cc.p(0,0);this._shadowOpacity=0;this._shadowBlur=0;this._strokeEnabled=false;this._strokeColor=cc.color(255,255,255,255);this._strokeSize=0;this._textFillColor=cc.color(255,255,255,255);this._strokeShadowOffsetX=0;this._strokeShadowOffsetY=0;this._needUpdateTexture=false;this._lineWidths=[];this._renderCmd._setColorsString();this._textureLoaded=true;if(b&&b instanceof cc.FontDefinition){this.initWithStringAndTextDefinition(f,b);}else{cc.LabelTTF.prototype.initWithString.call(this,f,b,d,a,e,c);}},init:function(){return this.initWithString(" ",this._fontName,this._fontSize);},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">";},getLineHeight:function(){return this._lineHeight||this._renderCmd._getFontClientHeight();},setLineHeight:function(a){this._lineHeight=a;},getString:function(){return this._string;},getHorizontalAlignment:function(){return this._hAlignment;},getVerticalAlignment:function(){return this._vAlignment;},getDimensions:function(){return cc.size(this._dimensions);},getFontSize:function(){return this._fontSize;},getFontName:function(){return this._fontName;},initWithStringAndTextDefinition:function(b,a){this._updateWithTextDefinition(a,false);this.string=b;return true;},setTextDefinition:function(a){if(a){this._updateWithTextDefinition(a,true);}},getTextDefinition:function(){return this._prepareTextDefinition(false);},enableShadow:function(f,e,h,g){if(f.r!=null&&f.g!=null&&f.b!=null&&f.a!=null){this._enableShadow(f,e,h);}else{this._enableShadowNoneColor(f,e,h,g);}},_enableShadowNoneColor:function(e,d,b,a){b=b||0.5;if(false===this._shadowEnabled){this._shadowEnabled=true;}var c=this._shadowOffset;if(c&&(c.x!=e)||(c._y!=d)){c.x=e;c.y=d;}if(this._shadowOpacity!=b){this._shadowOpacity=b;}this._renderCmd._setColorsString();if(this._shadowBlur!=a){this._shadowBlur=a;}this._setUpdateTextureDirty();},_enableShadow:function(g,h,f){if(!this._shadowColor){this._shadowColor=cc.color(255,255,255,128);}this._shadowColor.r=g.r;this._shadowColor.g=g.g;this._shadowColor.b=g.b;var d,i,e,c;d=h.width||h.x||0;i=h.height||h.y||0;e=(g.a!=null)?(g.a/255):0.5;c=f;this._enableShadowNoneColor(d,i,e,c);},_getShadowOffsetX:function(){return this._shadowOffset.x;},_setShadowOffsetX:function(a){if(false===this._shadowEnabled){this._shadowEnabled=true;}if(this._shadowOffset.x!=a){this._shadowOffset.x=a;this._setUpdateTextureDirty();}},_getShadowOffsetY:function(){return this._shadowOffset._y;},_setShadowOffsetY:function(a){if(false===this._shadowEnabled){this._shadowEnabled=true;}if(this._shadowOffset._y!=a){this._shadowOffset._y=a;this._setUpdateTextureDirty();}},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y);},_setShadowOffset:function(a){if(false===this._shadowEnabled){this._shadowEnabled=true;}if(this._shadowOffset.x!=a.x||this._shadowOffset.y!=a.y){this._shadowOffset.x=a.x;this._shadowOffset.y=a.y;this._setUpdateTextureDirty();}},_getShadowOpacity:function(){return this._shadowOpacity;},_setShadowOpacity:function(a){if(false===this._shadowEnabled){this._shadowEnabled=true;}if(this._shadowOpacity!=a){this._shadowOpacity=a;this._renderCmd._setColorsString();this._setUpdateTextureDirty();}},_getShadowBlur:function(){return this._shadowBlur;},_setShadowBlur:function(a){if(false===this._shadowEnabled){this._shadowEnabled=true;}if(this._shadowBlur!=a){this._shadowBlur=a;this._setUpdateTextureDirty();}},disableShadow:function(){if(this._shadowEnabled){this._shadowEnabled=false;this._setUpdateTextureDirty();}},enableStroke:function(c,b){if(this._strokeEnabled===false){this._strokeEnabled=true;}var a=this._strokeColor;if((a.r!==c.r)||(a.g!==c.g)||(a.b!==c.b)){a.r=c.r;a.g=c.g;a.b=c.b;this._renderCmd._setColorsString();}if(this._strokeSize!==b){this._strokeSize=b||0;}this._setUpdateTextureDirty();},_getStrokeStyle:function(){return this._strokeColor;},_setStrokeStyle:function(b){if(this._strokeEnabled===false){this._strokeEnabled=true;}var a=this._strokeColor;if((a.r!==b.r)||(a.g!==b.g)||(a.b!==b.b)){a.r=b.r;a.g=b.g;a.b=b.b;this._renderCmd._setColorsString();this._setUpdateTextureDirty();}},_getLineWidth:function(){return this._strokeSize;},_setLineWidth:function(a){if(this._strokeEnabled===false){this._strokeEnabled=true;}if(this._strokeSize!==a){this._strokeSize=a||0;this._setUpdateTextureDirty();}},disableStroke:function(){if(this._strokeEnabled){this._strokeEnabled=false;this._setUpdateTextureDirty();}},setFontFillColor:function(b){var a=this._textFillColor;if(a.r!=b.r||a.g!=b.g||a.b!=b.b){a.r=b.r;a.g=b.g;a.b=b.b;this._renderCmd._setColorsString();this._needUpdateTexture=true;}},_getFillStyle:function(){return this._textFillColor;},_updateWithTextDefinition:function(c,b){if(c.fontDimensions){this._dimensions.width=c.boundingWidth;this._dimensions.height=c.boundingHeight;}else{this._dimensions.width=0;this._dimensions.height=0;}this._hAlignment=c.textAlign;this._vAlignment=c.verticalAlign;this._fontName=c.fontName;this._fontSize=c.fontSize||12;this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);if(c.shadowEnabled){this.enableShadow(c.shadowOffsetX,c.shadowOffsetY,c.shadowOpacity,c.shadowBlur);}if(c.strokeEnabled){this.enableStroke(c.strokeStyle,c.lineWidth);}this.setFontFillColor(c.fillStyle);if(b){this._renderCmd._updateTexture();}var a=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(a.colorDirty|a.opacityDirty|a.textDirty);},_prepareTextDefinition:function(b){var a=new cc.FontDefinition();if(b){a.fontSize=this._fontSize;a.boundingWidth=cc.contentScaleFactor()*this._dimensions.width;a.boundingHeight=cc.contentScaleFactor()*this._dimensions.height;}else{a.fontSize=this._fontSize;a.boundingWidth=this._dimensions.width;a.boundingHeight=this._dimensions.height;}a.fontName=this._fontName;a.textAlign=this._hAlignment;a.verticalAlign=this._vAlignment;if(this._strokeEnabled){a.strokeEnabled=true;var c=this._strokeColor;a.strokeStyle=cc.color(c.r,c.g,c.b);a.lineWidth=this._strokeSize;}else{a.strokeEnabled=false;}if(this._shadowEnabled){a.shadowEnabled=true;a.shadowBlur=this._shadowBlur;a.shadowOpacity=this._shadowOpacity;a.shadowOffsetX=(b?cc.contentScaleFactor():1)*this._shadowOffset.x;a.shadowOffsetY=(b?cc.contentScaleFactor():1)*this._shadowOffset.y;}else{a._shadowEnabled=false;}var d=this._textFillColor;a.fillStyle=cc.color(d.r,d.g,d.b);return a;},setString:function(a){a=String(a);if(this._originalText!=a){this._originalText=a+"";this._updateString();this._setUpdateTextureDirty();this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);}},_updateString:function(){if((!this._string||this._string==="")&&this._string!==this._originalText){cc.renderer.childrenOrderDirty=true;}this._string=this._originalText;},setHorizontalAlignment:function(a){if(a!==this._hAlignment){this._hAlignment=a;this._setUpdateTextureDirty();}},setVerticalAlignment:function(a){if(a!=this._vAlignment){this._vAlignment=a;this._setUpdateTextureDirty();}},setDimensions:function(c,a){var b;if(a===undefined){b=c.width;a=c.height;}else{b=c;}if(b!=this._dimensions.width||a!=this._dimensions.height){this._dimensions.width=b;this._dimensions.height=a;this._updateString();this._setUpdateTextureDirty();}},_getBoundingWidth:function(){return this._dimensions.width;},_setBoundingWidth:function(a){if(a!=this._dimensions.width){this._dimensions.width=a;this._updateString();this._setUpdateTextureDirty();}},_getBoundingHeight:function(){return this._dimensions.height;},_setBoundingHeight:function(a){if(a!=this._dimensions.height){this._dimensions.height=a;this._updateString();this._setUpdateTextureDirty();}},setFontSize:function(a){if(this._fontSize!==a){this._fontSize=a;this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);this._setUpdateTextureDirty();}},setFontName:function(a){if(this._fontName&&this._fontName!=a){this._fontName=a;this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);this._setUpdateTextureDirty();}},_getFont:function(){return this._renderCmd._getFontStyle();},_setFont:function(b){var a=cc.LabelTTF._fontStyleRE.exec(b);if(a){this._fontSize=parseInt(a[1]);this._fontName=a[2];this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);this._setUpdateTextureDirty();}},getContentSize:function(){if(this._needUpdateTexture){this._renderCmd._updateTTF();}return cc.Sprite.prototype.getContentSize.call(this);},_getWidth:function(){if(this._needUpdateTexture){this._renderCmd._updateTTF();}return cc.Sprite.prototype._getWidth.call(this);},_getHeight:function(){if(this._needUpdateTexture){this._renderCmd._updateTTF();}return cc.Sprite.prototype._getHeight.call(this);},setTextureRect:function(b,a,c){cc.Sprite.prototype.setTextureRect.call(this,b,a,c,false);},_createRenderCmd:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS){return new cc.LabelTTF.CanvasRenderCmd(this);}else{return new cc.LabelTTF.WebGLRenderCmd(this);}},_setFontStyle:function(a){if(this._fontStyle!=a){this._fontStyle=a;this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);this._setUpdateTextureDirty();}},_getFontStyle:function(){return this._fontStyle;},_setFontWeight:function(a){if(this._fontWeight!=a){this._fontWeight=a;this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight);this._setUpdateTextureDirty();}},_getFontWeight:function(){return this._fontWeight;}});cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js");cc._tmp.PrototypeLabelTTF();delete cc._tmp.PrototypeLabelTTF;cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/;cc.LabelTTF.create=function(f,b,d,a,e,c){return new cc.LabelTTF(f,b,d,a,e,c);};cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create;if(cc.USE_LA88_LABELS){cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTURECOLOR;}else{cc.LabelTTF._SHADER_PROGRAM=cc.SHADER_POSITION_TEXTUREA8COLOR;}cc.LabelTTF.__labelHeightDiv=cc.newElement("div");cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial";cc.LabelTTF.__labelHeightDiv.style.position="absolute";cc.LabelTTF.__labelHeightDiv.style.left="-100px";cc.LabelTTF.__labelHeightDiv.style.top="-100px";cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal";document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,false);document.body.appendChild(cc.LabelTTF.__labelHeightDiv);},false);cc.LabelTTF.__getFontHeightByDiv=function(b,c){var a=cc.LabelTTF.__fontHeightCache[b+"."+c];if(a>0){return a;}var d=cc.LabelTTF.__labelHeightDiv;d.innerHTML="ajghl~!";d.style.fontFamily=b;d.style.fontSize=c+"px";a=d.clientHeight;cc.LabelTTF.__fontHeightCache[b+"."+c]=a;d.innerHTML="";return a;};cc.LabelTTF.__fontHeightCache={};cc.LabelTTF._textAlign=["left","center","right"];cc.LabelTTF._textBaseline=["top","middle","bottom"];cc.LabelTTF.wrapInspection=true;cc.LabelTTF._wordRex=/([a-zA-Z0-9]+|\S)/;cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>]/;cc.LabelTTF._lastWordRex=/([a-zA-Z0-9]+|\S)$/;cc.LabelTTF._lastEnglish=/[a-zA-Z0-9]+$/;cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9]/;(function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18;this._fontStyleStr="";this._shadowColorStr="rgba(128, 128, 128, 0.5)";this._strokeColorStr="";this._fillColorStr="rgba(255,255,255,1)";this._labelCanvas=null;this._labelContext=null;this._lineWidths=[];this._strings=[];this._isMultiLine=false;};var a=cc.LabelTTF.RenderCmd.prototype;a.constructor=cc.LabelTTF.RenderCmd;a._getLabelContext=function(){if(this._labelContext){return this._labelContext;}var d=this._node;if(!this._labelCanvas){var b=cc.newElement("canvas");b.width=1;b.height=1;var c=new cc.Texture2D();c.initWithElement(b);d.setTexture(c);this._labelCanvas=b;}this._labelContext=this._labelCanvas.getContext("2d");return this._labelContext;};a._setFontStyle=function(c,d,e,b){this._fontStyleStr=e+" "+b+" "+d+"px '"+c+"'";this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(c,d);};a._getFontStyle=function(){return this._fontStyleStr;};a._getFontClientHeight=function(){return this._fontClientHeight;};a._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.textDirty^this._dirtyFlag;var f=this._node;var h=this._getLabelContext(),g=this._labelCanvas;var e=f._contentSize;if(f._string.length===0){g.width=1;g.height=e.height||1;f._texture&&f._texture.handleLoadedTexture();f.setTextureRect(cc.rect(0,0,1,e.height));return true;}h.font=this._fontStyleStr;this._updateTTF();var d=e.width,b=e.height;var c=g.width==d&&g.height==b;g.width=d;g.height=b;if(c){h.clearRect(0,0,d,b);}this._drawTTFInCanvas(h);f._texture&&f._texture.handleLoadedTexture();f.setTextureRect(cc.rect(0,0,d,b));return true;};a._measureConfig=function(){this._getLabelContext().font=this._fontStyleStr;};a._measure=function(b){return this._getLabelContext().measureText(b).width;};a._updateTTF=function(){var d=this._node;var f=d._dimensions.width,e,c;var h=this._lineWidths;h.length=0;this._isMultiLine=false;this._measureConfig();if(f!==0){this._strings=d._string.split("\n");for(e=0;e<this._strings.length;e++){this._checkWarp(this._strings,e,f);}}else{this._strings=d._string.split("\n");for(e=0,c=this._strings.length;e<c;e++){h.push(this._measure(this._strings[e]));}}if(this._strings.length>0){this._isMultiLine=true;}var g,m=0,j=0;if(d._strokeEnabled){m=j=d._strokeSize*2;}if(d._shadowEnabled){var k=d._shadowOffset;m+=Math.abs(k.x)*2;j+=Math.abs(k.y)*2;}if(f===0){if(this._isMultiLine){g=cc.size(Math.ceil(Math.max.apply(Math,h)+m),Math.ceil((this._fontClientHeight*this._strings.length)+j));}else{g=cc.size(Math.ceil(this._measure(d._string)+m),Math.ceil(this._fontClientHeight+j));}}else{if(d._dimensions.height===0){if(this._isMultiLine){g=cc.size(Math.ceil(f+m),Math.ceil((d.getLineHeight()*this._strings.length)+j));}else{g=cc.size(Math.ceil(f+m),Math.ceil(d.getLineHeight()+j));}}else{g=cc.size(Math.ceil(f+m),Math.ceil(d._dimensions.height+j));}}if(d._getFontStyle()!="normal"){g.width=Math.ceil(g.width+d._fontSize*0.3);}d.setContentSize(g);d._strokeShadowOffsetX=m;d._strokeShadowOffsetY=j;var b=d._anchorPoint;this._anchorPointInPoints.x=(m*0.5)+((g.width-m)*b.x);this._anchorPointInPoints.y=(j*0.5)+((g.height-j)*b.y);};a._drawTTFInCanvas=function(d){if(!d){return;}var o=this._node;var b=o._strokeShadowOffsetX,v=o._strokeShadowOffsetY;var j=o._contentSize.height-v,n=o._vAlignment,r=o._hAlignment,c=o._strokeSize;d.setTransform(1,0,0,1,0+b*0.5,j+v*0.5);if(d.font!=this._fontStyleStr){d.font=this._fontStyleStr;}d.fillStyle=this._fillColorStr;var u=0,h=0;var m=o._strokeEnabled;if(m){d.lineWidth=c*2;d.strokeStyle=this._strokeColorStr;}if(o._shadowEnabled){var p=o._shadowOffset;d.shadowColor=this._shadowColorStr;d.shadowOffsetX=p.x;d.shadowOffsetY=-p.y;d.shadowBlur=o._shadowBlur;}d.textBaseline=cc.LabelTTF._textBaseline[n];d.textAlign=cc.LabelTTF._textAlign[r];var t=o._contentSize.width-b;var e=o.getLineHeight();var g=(e-this._fontClientHeight)/2;if(r===cc.TEXT_ALIGNMENT_RIGHT){u+=t;}else{if(r===cc.TEXT_ALIGNMENT_CENTER){u+=t/2;}else{u+=0;}}if(this._isMultiLine){var f=this._strings.length;if(n===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM){h=e-g*2+j-e*f;}else{if(n===cc.VERTICAL_TEXT_ALIGNMENT_CENTER){h=(e-g*2)/2+(j-e*f)/2;}}for(var s=0;s<f;s++){var k=this._strings[s];var q=-j+(e*s+g)+h;if(m){d.strokeText(k,u,q);}d.fillText(k,u,q);}}else{if(n===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM){}else{if(n===cc.VERTICAL_TEXT_ALIGNMENT_TOP){h-=j;}else{h-=j*0.5;}}if(m){d.strokeText(o._string,u,h);}d.fillText(o._string,u,h);}};a._checkWarp=function(p,h,j){var k=p[h];var b=this._measure(k);if(b>j&&k.length>1){var o=k.length*(j/b)|0;var m=k.substr(o);var c=b-this._measure(m);var g;var n=0;var d=0;while(c>j&&d++<100){o*=j/c;o=o|0;m=k.substr(o);c=b-this._measure(m);}d=0;while(c<j&&d++<100){if(m){var f=cc.LabelTTF._wordRex.exec(m);n=f?f[0].length:1;g=m;}o=o+n;m=k.substr(o);c=b-this._measure(m);}o-=n;if(o===0){o=1;g=g.substr(1);}var e=k.substr(0,o),q;if(cc.LabelTTF.wrapInspection){if(cc.LabelTTF._symbolRex.test(g||m)){q=cc.LabelTTF._lastWordRex.exec(e);o-=q?q[0].length:0;g=k.substr(o);e=k.substr(0,o);}}if(cc.LabelTTF._firsrEnglish.test(g)){q=cc.LabelTTF._lastEnglish.exec(e);if(q&&e!==q[0]){o-=q[0].length;g=k.substr(o);e=k.substr(0,o);}}p[h]=g||m;p.splice(h,0,e);}};})();(function(){cc.LabelTTF.CanvasRenderCmd=function(b){cc.Sprite.CanvasRenderCmd.call(this,b);cc.LabelTTF.RenderCmd.call(this);};cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var a=cc.LabelTTF.CanvasRenderCmd.prototype;a.constructor=cc.LabelTTF.CanvasRenderCmd;a.updateStatus=function(){var c=cc.Node._dirtyFlags,d=this._dirtyFlag;var b=d&c.colorDirty,e=d&c.opacityDirty;if(b){this._updateDisplayColor();}if(e){this._updateDisplayOpacity();}if(b){this._updateColor();}else{if(d&c.textDirty){this._updateTexture();}}if(this._dirtyFlag&c.transformDirty){this.transform(this.getParentRenderCmd(),true);this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag;}};a._syncStatus=function(e){var d=cc.Node._dirtyFlags,f=this._dirtyFlag;var b=e?e._node:null;if(b&&b._cascadeColorEnabled&&(e._dirtyFlag&d.colorDirty)){f|=d.colorDirty;}if(b&&b._cascadeOpacityEnabled&&(e._dirtyFlag&d.opacityDirty)){f|=d.opacityDirty;}if(e&&(e._dirtyFlag&d.transformDirty)){f|=d.transformDirty;}var c=f&d.colorDirty,g=f&d.opacityDirty;this._dirtyFlag=f;if(c){this._syncDisplayColor();}if(g){this._syncDisplayOpacity();}if(c){this._updateColor();}else{if(f&d.textDirty){this._updateTexture();}}if(f&d.transformDirty){this.transform(e);}};a._setColorsString=function(){var d=this._displayedColor,f=this._node,c=f._shadowColor||this._displayedColor;var e=f._strokeColor,b=f._textFillColor;this._shadowColorStr="rgba("+(0|(c.r*0.5))+","+(0|(c.g*0.5))+","+(0|(c.b*0.5))+","+f._shadowOpacity+")";this._fillColorStr="rgba("+(0|(d.r/255*b.r))+","+(0|(d.g/255*b.g))+","+(0|(d.b/255*b.b))+", 1)";this._strokeColorStr="rgba("+(0|(d.r/255*e.r))+","+(0|(d.g/255*e.g))+","+(0|(d.b/255*e.b))+", 1)";};a._updateColor=function(){this._setColorsString();this._updateTexture();};})();var cc=cc||{};cc._tmp=cc._tmp||{};cc.associateWithNative=function(a,b){};cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,"numdel":110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1000,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005};cc.FMT_JPG=0;cc.FMT_PNG=1;cc.FMT_TIFF=2;cc.FMT_RAWDATA=3;cc.FMT_WEBP=4;cc.FMT_UNKNOWN=5;cc.getImageFormatByData=function(a){if(a.length>8&&a[0]==137&&a[1]==80&&a[2]==78&&a[3]==71&&a[4]==13&&a[5]==10&&a[6]==26&&a[7]==10){return cc.FMT_PNG;}if(a.length>2&&((a[0]==73&&a[1]==73)||(a[0]==77&&a[1]==77)||(a[0]==255&&a[1]==216))){return cc.FMT_TIFF;}return cc.FMT_UNKNOWN;};cc.inherits=function(b,a){function c(){}c.prototype=a.prototype;b.superClass_=a.prototype;b.prototype=new c();b.prototype.constructor=b;};cc.base=function(e,a,g){var c=arguments.callee.caller;if(c.superClass_){ret=c.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));return ret;}var b=Array.prototype.slice.call(arguments,2);var f=false;for(var d=e.constructor;d;d=d.superClass_&&d.superClass_.constructor){if(d.prototype[a]===c){f=true;}else{if(f){return d.prototype[a].apply(e,b);}}}if(e[a]===c){return e.constructor.prototype[a].apply(e,b);}else{throw Error("cc.base called from a method of one name "+"to a method of a different name");}};cc.rendererCanvas={childrenOrderDirty:true,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:false,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(a){return a._createRenderCmd();},rendering:function(b){var g=this._renderCmds,f,a,d=cc.view.getScaleX(),c=cc.view.getScaleY();var e=b||cc._renderContext;e.computeRealOffsetY();for(f=0,a=g.length;f<a;f++){g[f].rendering(e,d,c);}},_renderingToCacheCanvas:function(b,g,e,d){if(!b){cc.log("The context of RenderTexture is invalid.");}e=cc.isUndefined(e)?1:e;d=cc.isUndefined(d)?1:d;g=g||this._currentID;var h=this._cacheToCanvasCmds[g],f,a;b.computeRealOffsetY();for(f=0,a=h.length;f<a;f++){h[f].rendering(b,e,d);}h.length=0;var c=this._cacheInstanceIds;delete this._cacheToCanvasCmds[g];cc.arrayRemoveObject(c,g);if(c.length===0){this._isCacheToCanvasOn=false;}else{this._currentID=c[c.length-1];}},_turnToCacheMode:function(a){this._isCacheToCanvasOn=true;a=a||0;this._cacheToCanvasCmds[a]=[];if(this._cacheInstanceIds.indexOf(a)===-1){this._cacheInstanceIds.push(a);}this._currentID=a;},_turnToNormalMode:function(){this._isCacheToCanvasOn=false;},resetFlag:function(){this.childrenOrderDirty=false;this._transformNodePool.length=0;},transform:function(){var b=this._transformNodePool;b.sort(this._sortNodeByLevelAsc);for(var c=0,a=b.length;c<a;c++){if(b[c]._dirtyFlag!==0){b[c].updateStatus();}}b.length=0;},transformDirty:function(){return this._transformNodePool.length>0;},_sortNodeByLevelAsc:function(b,a){return b._curLevel-a._curLevel;},pushDirtyNode:function(a){this._transformNodePool.push(a);},clearRenderCommands:function(){this._renderCmds.length=0;},pushRenderCommand:function(d){if(!d._needDraw){return;}if(this._isCacheToCanvasOn){var b=this._currentID,a=this._cacheToCanvasCmds;var c=a[b];if(c.indexOf(d)===-1){c.push(d);}}else{if(this._renderCmds.indexOf(d)===-1){this._renderCmds.push(d);}}}};if(cc._renderType===cc._RENDER_TYPE_CANVAS){cc.renderer=cc.rendererCanvas;}(function(){cc.CanvasContextWrapper=function(b){this._context=b;this._saveCount=0;this._currentAlpha=b.globalAlpha;this._currentCompositeOperation=b.globalCompositeOperation;this._currentFillStyle=b.fillStyle;this._currentStrokeStyle=b.strokeStyle;this._offsetX=0;this._offsetY=0;this._realOffsetY=this.height;this._armatureMode=0;};var a=cc.CanvasContextWrapper.prototype;a.resetCache=function(){var b=this._context;this._currentAlpha=b.globalAlpha;this._currentCompositeOperation=b.globalCompositeOperation;this._currentFillStyle=b.fillStyle;this._currentStrokeStyle=b.strokeStyle;this._realOffsetY=this._context.canvas.height+this._offsetY;};a.setOffset=function(b,c){this._offsetX=b;this._offsetY=c;this._realOffsetY=this._context.canvas.height+this._offsetY;};a.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY;};a.setViewScale=function(c,b){this._scaleX=c;this._scaleY=b;};a.getContext=function(){return this._context;};a.save=function(){this._context.save();this._saveCount++;};a.restore=function(){this._context.restore();this._saveCount--;};a.setGlobalAlpha=function(b){if(this._saveCount>0){this._context.globalAlpha=b;}else{if(this._currentAlpha!==b){this._currentAlpha=b;this._context.globalAlpha=b;}}};a.setCompositeOperation=function(b){if(this._saveCount>0){this._context.globalCompositeOperation=b;}else{if(this._currentCompositeOperation!==b){this._currentCompositeOperation=b;this._context.globalCompositeOperation=b;}}};a.setFillStyle=function(b){if(this._saveCount>0){this._context.fillStyle=b;}else{if(this._currentFillStyle!==b){this._currentFillStyle=b;this._context.fillStyle=b;}}};a.setStrokeStyle=function(b){if(this._saveCount>0){this._context.strokeStyle=b;}else{if(this._currentStrokeStyle!==b){this._currentStrokeStyle=b;this._context.strokeStyle=b;}}};a.setTransform=function(d,c,b){if(this._armatureMode>0){this.restore();this.save();this._context.transform(d.a,d.c,d.b,d.d,d.tx*c,-(d.ty*b));}else{this._context.setTransform(d.a,d.c,d.b,d.d,this._offsetX+d.tx*c,this._realOffsetY-(d.ty*b));}};a._switchToArmatureMode=function(d,e,c,b){if(d){this._armatureMode++;this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*c,this._realOffsetY-(e.ty*b));this.save();}else{this._armatureMode--;this.restore();}};})();cc._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX != RotationY. Don't know which one to return",Node_getScale:"ScaleX != ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"child must be non-null",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."};cc._logToWebPage=function(f){if(!cc._canvas){return;}var b=cc._logList;var e=document;if(!b){var a=e.createElement("Div");var d=a.style;a.setAttribute("id","logInfoDiv");cc._canvas.parentNode.appendChild(a);a.setAttribute("width","200");a.setAttribute("height",cc._canvas.height);d.zIndex="99999";d.position="absolute";d.top="0";d.left="0";b=cc._logList=e.createElement("textarea");var c=b.style;b.setAttribute("rows","20");b.setAttribute("cols","30");b.setAttribute("disabled",true);a.appendChild(b);c.backgroundColor="transparent";c.borderBottom="1px solid #cccccc";c.borderRightWidth="0px";c.borderLeftWidth="0px";c.borderTopWidth="0px";c.borderTopStyle="none";c.borderRightStyle="none";c.borderLeftStyle="none";c.padding="0px";c.margin=0;}b.value=b.value+f+"\r\n";b.scrollTop=b.scrollHeight;};cc._formatString=function(a){if(cc.isObject(a)){try{return JSON.stringify(a);}catch(b){return"";}}else{return a;}};cc._initDebugSetting=function(c){var b=cc.game;if(c==b.DEBUG_MODE_NONE){return;}var a;if(c>b.DEBUG_MODE_ERROR){a=cc._logToWebPage.bind(cc);cc.error=function(){a("ERROR :  "+cc.formatStr.apply(cc,arguments));};cc.assert=function(e,f){if(!e&&f){for(var d=2;d<arguments.length;d++){f=f.replace(/(%s)|(%d)/,cc._formatString(arguments[d]));}a("Assert: "+f);}};if(c!=b.DEBUG_MODE_ERROR_FOR_WEB_PAGE){cc.warn=function(){a("WARN :  "+cc.formatStr.apply(cc,arguments));};}if(c==b.DEBUG_MODE_INFO_FOR_WEB_PAGE){cc.log=function(){a(cc.formatStr.apply(cc,arguments));};}}else{if(console&&console.log.apply){cc.error=function(){return console.error.apply(console,arguments);};cc.assert=function(e,f){if(!e&&f){for(var d=2;d<arguments.length;d++){f=f.replace(/(%s)|(%d)/,cc._formatString(arguments[d]));}throw f;}};if(c!=b.DEBUG_MODE_ERROR){cc.warn=function(){return console.warn.apply(console,arguments);};}if(c==b.DEBUG_MODE_INFO){cc.log=function(){return console.log.apply(console,arguments);};}}}};cc._initDebugSetting(cc.game.config[cc.game.CONFIG_KEY.debugMode]);cc.HashElement=cc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:false,paused:false,hh:null,ctor:function(){this.actions=[];this.target=null;this.actionIndex=0;this.currentAction=null;this.currentActionSalvaged=false;this.paused=false;this.hh=null;}});cc.ActionManager=cc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:false,_searchElementByTarget:function(a,c){for(var b=0;b<a.length;b++){if(c==a[b].target){return a[b];}}return null;},ctor:function(){this._hashTargets={};this._arrayTargets=[];this._currentTarget=null;this._currentTargetSalvaged=false;},addAction:function(c,d,b){if(!c){throw"cc.ActionManager.addAction(): action must be non-null";}if(!d){throw"cc.ActionManager.addAction(): action must be non-null";}var a=this._hashTargets[d.__instanceId];if(!a){a=new cc.HashElement();a.paused=b;a.target=d;this._hashTargets[d.__instanceId]=a;this._arrayTargets.push(a);}this._actionAllocWithHashElement(a);a.actions.push(c);c.startWithTarget(d);},removeAllActions:function(){var c=this._arrayTargets;for(var b=0;b<c.length;b++){var a=c[b];if(a){this.removeAllActionsFromTarget(a.target,true);}}},removeAllActionsFromTarget:function(c,a){if(c==null){return;}var b=this._hashTargets[c.__instanceId];if(b){if(b.actions.indexOf(b.currentAction)!==-1&&!(b.currentActionSalvaged)){b.currentActionSalvaged=true;}b.actions.length=0;if(this._currentTarget==b&&!a){this._currentTargetSalvaged=true;}else{this._deleteHashElement(b);}}},removeAction:function(c){if(c==null){return;}var d=c.getOriginalTarget();var b=this._hashTargets[d.__instanceId];if(b){for(var a=0;a<b.actions.length;a++){if(b.actions[a]==c){b.actions.splice(a,1);break;}}}else{cc.log(cc._LogInfos.ActionManager_removeAction);}},removeActionByTag:function(a,f){if(a==cc.ACTION_TAG_INVALID){cc.log(cc._LogInfos.ActionManager_addAction);}cc.assert(f,cc._LogInfos.ActionManager_addAction);var d=this._hashTargets[f.__instanceId];if(d){var b=d.actions.length;for(var c=0;c<b;++c){var e=d.actions[c];if(e&&e.getTag()===a&&e.getOriginalTarget()==f){this._removeActionAtIndex(c,d);break;}}}},getActionByTag:function(a,e){if(a==cc.ACTION_TAG_INVALID){cc.log(cc._LogInfos.ActionManager_getActionByTag);}var c=this._hashTargets[e.__instanceId];if(c){if(c.actions!=null){for(var b=0;b<c.actions.length;++b){var d=c.actions[b];if(d&&d.getTag()===a){return d;}}}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,a);}return null;},numberOfRunningActionsInTarget:function(b){var a=this._hashTargets[b.__instanceId];if(a){return(a.actions)?a.actions.length:0;}return 0;},pauseTarget:function(b){var a=this._hashTargets[b.__instanceId];if(a){a.paused=true;}},resumeTarget:function(b){var a=this._hashTargets[b.__instanceId];if(a){a.paused=false;}},pauseAllRunningActions:function(){var d=[];var c=this._arrayTargets;for(var b=0;b<c.length;b++){var a=c[b];if(a&&!a.paused){a.paused=true;d.push(a.target);}}return d;},resumeTargets:function(a){if(!a){return;}for(var b=0;b<a.length;b++){if(a[b]){this.resumeTarget(a[b]);}}},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdateForTarget(this);},_removeActionAtIndex:function(a,b){var c=b.actions[a];if((c==b.currentAction)&&(!b.currentActionSalvaged)){b.currentActionSalvaged=true;}b.actions.splice(a,1);if(b.actionIndex>=a){b.actionIndex--;}if(b.actions.length==0){if(this._currentTarget==b){this._currentTargetSalvaged=true;}else{this._deleteHashElement(b);}}},_deleteHashElement:function(a){if(a){delete this._hashTargets[a.target.__instanceId];cc.arrayRemoveObject(this._arrayTargets,a);a.actions=null;a.target=null;}},_actionAllocWithHashElement:function(a){if(a.actions==null){a.actions=[];}},update:function(c){var e=this._arrayTargets,b;for(var a=0;a<e.length;a++){this._currentTarget=e[a];b=this._currentTarget;if(!b.paused){for(b.actionIndex=0;b.actionIndex<(b.actions?b.actions.length:0);b.actionIndex++){b.currentAction=b.actions[b.actionIndex];if(!b.currentAction){continue;}b.currentActionSalvaged=false;b.currentAction.step(c*(b.currentAction._speedMethod?b.currentAction._speed:1));if(b.currentActionSalvaged){b.currentAction=null;}else{if(b.currentAction.isDone()){b.currentAction.stop();var d=b.currentAction;b.currentAction=null;this.removeAction(d);}}b.currentAction=null;}}if(this._currentTargetSalvaged&&b.actions.length===0){this._deleteHashElement(b);}}}});cc.ACTION_TAG_INVALID=-1;cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.originalTarget=null;this.target=null;this.tag=cc.ACTION_TAG_INVALID;},copy:function(){cc.log("copy is deprecated. Please use clone instead.");return this.clone();},clone:function(){var a=new cc.Action();a.originalTarget=null;a.target=null;a.tag=this.tag;return a;},isDone:function(){return true;},startWithTarget:function(a){this.originalTarget=a;this.target=a;},stop:function(){this.target=null;},step:function(a){cc.log("[Action step]. override me");},update:function(a){cc.log("[Action update]. override me");},getTarget:function(){return this.target;},setTarget:function(a){this.target=a;},getOriginalTarget:function(){return this.originalTarget;},setOriginalTarget:function(a){this.originalTarget=a;},getTag:function(){return this.tag;},setTag:function(a){this.tag=a;},retain:function(){},release:function(){}});cc.action=function(){return new cc.Action();};cc.Action.create=cc.action;cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this);this._duration=0;},getDuration:function(){return this._duration*(this._timesForRepeat||1);},setDuration:function(a){this._duration=a;},reverse:function(){cc.log("cocos2d: FiniteTimeAction#reverse: Implement me");return null;},clone:function(){return new cc.FiniteTimeAction();}});cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(b,a){cc.Action.prototype.ctor.call(this);this._speed=0;this._innerAction=null;b&&this.initWithAction(b,a);},getSpeed:function(){return this._speed;},setSpeed:function(a){this._speed=a;},initWithAction:function(b,a){if(!b){throw"cc.Speed.initWithAction(): action must be non nil";}this._innerAction=b;this._speed=a;return true;},clone:function(){var a=new cc.Speed();a.initWithAction(this._innerAction.clone(),this._speed);return a;},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,a);this._innerAction.startWithTarget(a);},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this);},step:function(a){this._innerAction.step(a*this._speed);},isDone:function(){return this._innerAction.isDone();},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed);},setInnerAction:function(a){if(this._innerAction!=a){this._innerAction=a;}},getInnerAction:function(){return this._innerAction;}});cc.speed=function(b,a){return new cc.Speed(b,a);};cc.Speed.create=cc.speed;cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:false,_boundaryFullyCovered:false,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(b,a){cc.Action.prototype.ctor.call(this);this._followedNode=null;this._boundarySet=false;this._boundaryFullyCovered=false;this._halfScreenSize=null;this._fullScreenSize=null;this.leftBoundary=0;this.rightBoundary=0;this.topBoundary=0;this.bottomBoundary=0;this._worldRect=cc.rect(0,0,0,0);if(b){a?this.initWithTarget(b,a):this.initWithTarget(b);}},clone:function(){var c=new cc.Follow();var a=this._worldRect;var b=new cc.Rect(a.x,a.y,a.width,a.height);c.initWithTarget(this._followedNode,b);return c;},isBoundarySet:function(){return this._boundarySet;},setBoudarySet:function(a){this._boundarySet=a;},initWithTarget:function(c,b){if(!c){throw"cc.Follow.initWithAction(): followedNode must be non nil";}var d=this;b=b||cc.rect(0,0,0,0);d._followedNode=c;d._worldRect=b;d._boundarySet=!cc._rectEqualToZero(b);d._boundaryFullyCovered=false;var a=cc.director.getWinSize();d._fullScreenSize=cc.p(a.width,a.height);d._halfScreenSize=cc.pMult(d._fullScreenSize,0.5);if(d._boundarySet){d.leftBoundary=-((b.x+b.width)-d._fullScreenSize.x);d.rightBoundary=-b.x;d.topBoundary=-b.y;d.bottomBoundary=-((b.y+b.height)-d._fullScreenSize.y);if(d.rightBoundary<d.leftBoundary){d.rightBoundary=d.leftBoundary=(d.leftBoundary+d.rightBoundary)/2;}if(d.topBoundary<d.bottomBoundary){d.topBoundary=d.bottomBoundary=(d.topBoundary+d.bottomBoundary)/2;}if((d.topBoundary==d.bottomBoundary)&&(d.leftBoundary==d.rightBoundary)){d._boundaryFullyCovered=true;}}return true;},step:function(b){var a=this._followedNode.x;var c=this._followedNode.y;a=this._halfScreenSize.x-a;c=this._halfScreenSize.y-c;this.target._renderCmd._dirtyFlag=0;if(this._boundarySet){if(this._boundaryFullyCovered){return;}this.target.setPosition(cc.clampf(a,this.leftBoundary,this.rightBoundary),cc.clampf(c,this.bottomBoundary,this.topBoundary));}else{this.target.setPosition(a,c);}},isDone:function(){return(!this._followedNode.running);},stop:function(){this.target=null;cc.Action.prototype.stop.call(this);}});cc.follow=function(b,a){return new cc.Follow(b,a);};cc.Follow.create=cc.follow;cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:false,_easeList:null,_timesForRepeat:1,_repeatForever:false,_repeatMethod:false,_speed:1,_speedMethod:false,ctor:function(a){this._speed=1;this._timesForRepeat=1;this._repeatForever=false;this.MAX_VALUE=2;this._repeatMethod=false;this._speedMethod=false;cc.FiniteTimeAction.prototype.ctor.call(this);a!==undefined&&this.initWithDuration(a);},getElapsed:function(){return this._elapsed;},initWithDuration:function(a){this._duration=(a===0)?cc.FLT_EPSILON:a;this._elapsed=0;this._firstTick=true;return true;},isDone:function(){return(this._elapsed>=this._duration);},_cloneDecoration:function(a){a._repeatForever=this._repeatForever;a._speed=this._speed;a._timesForRepeat=this._timesForRepeat;a._easeList=this._easeList;a._speedMethod=this._speedMethod;a._repeatMethod=this._repeatMethod;},_reverseEaseList:function(b){if(this._easeList){b._easeList=[];for(var a=0;a<this._easeList.length;a++){b._easeList.push(this._easeList[a].reverse());}}},clone:function(){var a=new cc.ActionInterval(this._duration);this._cloneDecoration(a);return a;},easing:function(b){if(this._easeList){this._easeList.length=0;}else{this._easeList=[];}for(var a=0;a<arguments.length;a++){this._easeList.push(arguments[a]);}return this;},_computeEaseTime:function(c){var a=this._easeList;if((!a)||(a.length===0)){return c;}for(var b=0,d=a.length;b<d;b++){c=a[b].easing(c);}return c;},step:function(b){if(this._firstTick){this._firstTick=false;this._elapsed=0;}else{this._elapsed+=b;}var a=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);a=(1>a?a:1);this.update(a>0?a:0);if(this._repeatMethod&&this._timesForRepeat>1&&this.isDone()){if(!this._repeatForever){this._timesForRepeat--;}this.startWithTarget(this.target);this.step(this._elapsed-this._duration);}},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,a);this._elapsed=0;this._firstTick=true;},reverse:function(){cc.log("cc.IntervalAction: reverse not implemented.");return null;},setAmplitudeRate:function(a){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.");},getAmplitudeRate:function(){cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass.");return 0;},speed:function(a){if(a<=0){cc.log("The speed parameter error");return this;}this._speedMethod=true;this._speed*=a;return this;},getSpeed:function(){return this._speed;},setSpeed:function(a){this._speed=a;return this;},repeat:function(a){a=Math.round(a);if(isNaN(a)||a<1){cc.log("The repeat parameter error");return this;}this._repeatMethod=true;this._timesForRepeat*=a;return this;},repeatForever:function(){this._repeatMethod=true;this._timesForRepeat=this.MAX_VALUE;this._repeatForever=true;return this;}});cc.actionInterval=function(a){return new cc.ActionInterval(a);};cc.ActionInterval.create=cc.actionInterval;cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this);this._actions=[];var a=(e instanceof Array)?e:arguments;var d=a.length-1;if((d>=0)&&(a[d]==null)){cc.log("parameters should not be ending with null in Javascript");}if(d>=0){var c=a[0],f;for(var b=1;b<d;b++){if(a[b]){f=c;c=cc.Sequence._actionOneTwo(f,a[b]);}}this.initWithTwoActions(c,a[d]);}},initWithTwoActions:function(b,a){if(!b||!a){throw"cc.Sequence.initWithTwoActions(): arguments must all be non nil";}var c=b._duration+a._duration;this.initWithDuration(c);this._actions[0]=b;this._actions[1]=a;return true;},clone:function(){var a=new cc.Sequence();this._cloneDecoration(a);a.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._split=this._actions[0]._duration/this._duration;this._last=-1;},stop:function(){if(this._last!==-1){this._actions[this._last].stop();}cc.Action.prototype.stop.call(this);},update:function(c){var g,d=0;var f=this._split,b=this._actions,a=this._last,e;c=this._computeEaseTime(c);if(c<f){g=(f!==0)?c/f:1;if(d===0&&a===1){b[1].update(0);b[1].stop();}}else{d=1;g=(f===1)?1:(c-f)/(1-f);if(a===-1){b[0].startWithTarget(this.target);b[0].update(1);b[0].stop();}if(!a){b[0].update(1);b[0].stop();}}e=b[d];if(a===d&&e.isDone()){return;}if(a!==d){e.startWithTarget(this.target);}g=g*e._timesForRepeat;e.update(g>1?g%1:g);this._last=d;},reverse:function(){var a=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.sequence=function(f){var b=(f instanceof Array)?f:arguments;if((b.length>0)&&(b[b.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var a,e,c,d;while(b&&b.length>0){e=Array.prototype.shift.call(b);d=e._timesForRepeat||1;e._repeatMethod=false;e._timesForRepeat=1;c=0;if(!a){a=e;c=1;}for(c;c<d;c++){a=cc.Sequence._actionOneTwo(a,e);}}return a;};cc.Sequence.create=cc.sequence;cc.Sequence._actionOneTwo=function(b,a){var c=new cc.Sequence();c.initWithTwoActions(b,a);return c;};cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:false,_innerAction:null,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);b!==undefined&&this.initWithAction(a,b);},initWithAction:function(a,c){var b=a._duration*c;if(this.initWithDuration(b)){this._times=c;this._innerAction=a;if(a instanceof cc.ActionInstant){this._actionInstant=true;this._times-=1;}this._total=0;return true;}return false;},clone:function(){var a=new cc.Repeat();this._cloneDecoration(a);a.initWithAction(this._innerAction.clone(),this._times);return a;},startWithTarget:function(a){this._total=0;this._nextDt=this._innerAction._duration/this._duration;cc.ActionInterval.prototype.startWithTarget.call(this,a);this._innerAction.startWithTarget(a);},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this);},update:function(d){d=this._computeEaseTime(d);var a=this._innerAction;var c=this._duration;var b=this._times;var e=this._nextDt;if(d>=e){while(d>e&&this._total<b){a.update(1);this._total++;a.stop();a.startWithTarget(this.target);e+=a._duration/c;this._nextDt=e;}if(d>=1&&this._total<b){this._total++;}if(!this._actionInstant){if(this._total===b){a.update(1);a.stop();}else{a.update(d-(e-a._duration/c));}}}else{a.update((d*b)%1);}},isDone:function(){return this._total==this._times;},reverse:function(){var a=new cc.Repeat(this._innerAction.reverse(),this._times);this._cloneDecoration(a);this._reverseEaseList(a);return a;},setInnerAction:function(a){if(this._innerAction!=a){this._innerAction=a;}},getInnerAction:function(){return this._innerAction;}});cc.repeat=function(a,b){return new cc.Repeat(a,b);};cc.Repeat.create=cc.repeat;cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._innerAction=null;a&&this.initWithAction(a);},initWithAction:function(a){if(!a){throw"cc.RepeatForever.initWithAction(): action must be non null";}this._innerAction=a;return true;},clone:function(){var a=new cc.RepeatForever();this._cloneDecoration(a);a.initWithAction(this._innerAction.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._innerAction.startWithTarget(a);},step:function(b){var a=this._innerAction;a.step(b);if(a.isDone()){a.startWithTarget(this.target);a.step(a.getElapsed()-a._duration);}},isDone:function(){return false;},reverse:function(){var a=new cc.RepeatForever(this._innerAction.reverse());this._cloneDecoration(a);this._reverseEaseList(a);return a;},setInnerAction:function(a){if(this._innerAction!=a){this._innerAction=a;}},getInnerAction:function(){return this._innerAction;}});cc.repeatForever=function(a){return new cc.RepeatForever(a);};cc.RepeatForever.create=cc.repeatForever;cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(e){cc.ActionInterval.prototype.ctor.call(this);this._one=null;this._two=null;var a=(e instanceof Array)?e:arguments;var d=a.length-1;if((d>=0)&&(a[d]==null)){cc.log("parameters should not be ending with null in Javascript");}if(d>=0){var c=a[0],f;for(var b=1;b<d;b++){if(a[b]){f=c;c=cc.Spawn._actionOneTwo(f,a[b]);}}this.initWithTwoActions(c,a[d]);}},initWithTwoActions:function(e,d){if(!e||!d){throw"cc.Spawn.initWithTwoActions(): arguments must all be non null";}var a=false;var c=e._duration;var b=d._duration;if(this.initWithDuration(Math.max(c,b))){this._one=e;this._two=d;if(c>b){this._two=cc.Sequence._actionOneTwo(d,cc.delayTime(c-b));}else{if(c<b){this._one=cc.Sequence._actionOneTwo(e,cc.delayTime(b-c));}}a=true;}return a;},clone:function(){var a=new cc.Spawn();this._cloneDecoration(a);a.initWithTwoActions(this._one.clone(),this._two.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._one.startWithTarget(a);this._two.startWithTarget(a);},stop:function(){this._one.stop();this._two.stop();cc.Action.prototype.stop.call(this);},update:function(a){a=this._computeEaseTime(a);if(this._one){this._one.update(a);}if(this._two){this._two.update(a);}},reverse:function(){var a=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.spawn=function(d){var a=(d instanceof Array)?d:arguments;if((a.length>0)&&(a[a.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var c=a[0];for(var b=1;b<a.length;b++){if(a[b]!=null){c=cc.Spawn._actionOneTwo(c,a[b]);}}return c;};cc.Spawn.create=cc.spawn;cc.Spawn._actionOneTwo=function(c,b){var a=new cc.Spawn();a.initWithTwoActions(c,b);return a;};cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(c,b,a){cc.ActionInterval.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(c,b,a);},initWithDuration:function(c,b,a){if(cc.ActionInterval.prototype.initWithDuration.call(this,c)){this._dstAngleX=b||0;this._dstAngleY=a||this._dstAngleX;return true;}return false;},clone:function(){var a=new cc.RotateTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY);return a;},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);var a=b.rotationX%360;var d=this._dstAngleX-a;if(d>180){d-=360;}if(d<-180){d+=360;}this._startAngleX=a;this._diffAngleX=d;this._startAngleY=b.rotationY%360;var c=this._dstAngleY-this._startAngleY;if(c>180){c-=360;}if(c<-180){c+=360;}this._diffAngleY=c;},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.");},update:function(a){a=this._computeEaseTime(a);if(this.target){this.target.rotationX=this._startAngleX+this._diffAngleX*a;this.target.rotationY=this._startAngleY+this._diffAngleY*a;}}});cc.rotateTo=function(c,b,a){return new cc.RotateTo(c,b,a);};cc.RotateTo.create=cc.rotateTo;cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(c,b,a){cc.ActionInterval.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(c,b,a);},initWithDuration:function(c,b,a){if(cc.ActionInterval.prototype.initWithDuration.call(this,c)){this._angleX=b||0;this._angleY=a||this._angleX;return true;}return false;},clone:function(){var a=new cc.RotateBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._angleX,this._angleY);return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._startAngleX=a.rotationX;this._startAngleY=a.rotationY;},update:function(a){a=this._computeEaseTime(a);if(this.target){this.target.rotationX=this._startAngleX+this._angleX*a;this.target.rotationY=this._startAngleY+this._angleY*a;}},reverse:function(){var a=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.rotateBy=function(c,b,a){return new cc.RotateBy(c,b,a);};cc.RotateBy.create=cc.rotateBy;cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(c,b,a){cc.ActionInterval.prototype.ctor.call(this);this._positionDelta=cc.p(0,0);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);b!==undefined&&this.initWithDuration(c,b,a);},initWithDuration:function(b,a,c){if(cc.ActionInterval.prototype.initWithDuration.call(this,b)){if(a.x!==undefined){c=a.y;a=a.x;}this._positionDelta.x=a;this._positionDelta.y=c;return true;}return false;},clone:function(){var a=new cc.MoveBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._positionDelta);return a;},startWithTarget:function(c){cc.ActionInterval.prototype.startWithTarget.call(this,c);var b=c.getPositionX();var a=c.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a;},update:function(e){e=this._computeEaseTime(e);if(this.target){var a=this._positionDelta.x*e;var g=this._positionDelta.y*e;var f=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var d=this.target.getPositionX();var b=this.target.getPositionY();var c=this._previousPosition;f.x=f.x+d-c.x;f.y=f.y+b-c.y;a=a+f.x;g=g+f.y;c.x=a;c.y=g;this.target.setPosition(a,g);}else{this.target.setPosition(f.x+a,f.y+g);}}},reverse:function(){var a=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.moveBy=function(c,b,a){return new cc.MoveBy(c,b,a);};cc.MoveBy.create=cc.moveBy;cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(b,a,c){cc.MoveBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);a!==undefined&&this.initWithDuration(b,a,c);},initWithDuration:function(b,a,c){if(cc.MoveBy.prototype.initWithDuration.call(this,b,a,c)){if(a.x!==undefined){c=a.y;a=a.x;}this._endPosition.x=a;this._endPosition.y=c;return true;}return false;},clone:function(){var a=new cc.MoveTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._endPosition);return a;},startWithTarget:function(a){cc.MoveBy.prototype.startWithTarget.call(this,a);this._positionDelta.x=this._endPosition.x-a.getPositionX();this._positionDelta.y=this._endPosition.y-a.getPositionY();}});cc.moveTo=function(b,a,c){return new cc.MoveTo(b,a,c);};cc.MoveTo.create=cc.moveTo;cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(a,c,b){cc.ActionInterval.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(a,c,b);},initWithDuration:function(b,d,c){var a=false;if(cc.ActionInterval.prototype.initWithDuration.call(this,b)){this._endSkewX=d;this._endSkewY=c;a=true;}return a;},clone:function(){var a=new cc.SkewTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._endSkewX,this._endSkewY);return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._startSkewX=a.skewX%180;this._deltaX=this._endSkewX-this._startSkewX;if(this._deltaX>180){this._deltaX-=360;}if(this._deltaX<-180){this._deltaX+=360;}this._startSkewY=a.skewY%360;this._deltaY=this._endSkewY-this._startSkewY;if(this._deltaY>180){this._deltaY-=360;}if(this._deltaY<-180){this._deltaY+=360;}},update:function(a){a=this._computeEaseTime(a);this.target.skewX=this._startSkewX+this._deltaX*a;this.target.skewY=this._startSkewY+this._deltaY*a;}});cc.skewTo=function(a,c,b){return new cc.SkewTo(a,c,b);};cc.SkewTo.create=cc.skewTo;cc.SkewBy=cc.SkewTo.extend({ctor:function(a,c,b){cc.SkewTo.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(a,c,b);},initWithDuration:function(c,d,b){var a=false;if(cc.SkewTo.prototype.initWithDuration.call(this,c,d,b)){this._skewX=d;this._skewY=b;a=true;}return a;},clone:function(){var a=new cc.SkewBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._skewX,this._skewY);return a;},startWithTarget:function(a){cc.SkewTo.prototype.startWithTarget.call(this,a);this._deltaX=this._skewX;this._deltaY=this._skewY;this._endSkewX=this._startSkewX+this._deltaX;this._endSkewY=this._startSkewY+this._deltaY;},reverse:function(){var a=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.skewBy=function(a,c,b){return new cc.SkewBy(a,c,b);};cc.SkewBy.create=cc.skewBy;cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(d,b,e,a,c){cc.ActionInterval.prototype.ctor.call(this);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);this._delta=cc.p(0,0);a!==undefined&&this.initWithDuration(d,b,e,a,c);},initWithDuration:function(d,b,e,a,c){if(cc.ActionInterval.prototype.initWithDuration.call(this,d)){if(c===undefined){c=a;a=e;e=b.y;b=b.x;}this._delta.x=b;this._delta.y=e;this._height=a;this._jumps=c;return true;}return false;},clone:function(){var a=new cc.JumpBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._delta,this._height,this._jumps);return a;},startWithTarget:function(c){cc.ActionInterval.prototype.startWithTarget.call(this,c);var b=c.getPositionX();var a=c.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a;},update:function(f){f=this._computeEaseTime(f);if(this.target){var b=f*this._jumps%1;var h=this._height*4*b*(1-b);h+=this._delta.y*f;var a=this._delta.x*f;var g=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var e=this.target.getPositionX();var c=this.target.getPositionY();var d=this._previousPosition;g.x=g.x+e-d.x;g.y=g.y+c-d.y;a=a+g.x;h=h+g.y;d.x=a;d.y=h;this.target.setPosition(a,h);}else{this.target.setPosition(g.x+a,g.y+h);}}},reverse:function(){var a=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.jumpBy=function(d,b,e,a,c){return new cc.JumpBy(d,b,e,a,c);};cc.JumpBy.create=cc.jumpBy;cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(d,b,e,a,c){cc.JumpBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);a!==undefined&&this.initWithDuration(d,b,e,a,c);},initWithDuration:function(d,b,e,a,c){if(cc.JumpBy.prototype.initWithDuration.call(this,d,b,e,a,c)){if(c===undefined){e=b.y;b=b.x;}this._endPosition.x=b;this._endPosition.y=e;return true;}return false;},startWithTarget:function(a){cc.JumpBy.prototype.startWithTarget.call(this,a);this._delta.x=this._endPosition.x-this._startPosition.x;this._delta.y=this._endPosition.y-this._startPosition.y;},clone:function(){var a=new cc.JumpTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._endPosition,this._height,this._jumps);return a;}});cc.jumpTo=function(d,b,e,a,c){return new cc.JumpTo(d,b,e,a,c);};cc.JumpTo.create=cc.jumpTo;cc.bezierAt=function(f,e,i,h,g){return(Math.pow(1-g,3)*f+3*g*(Math.pow(1-g,2))*e+3*Math.pow(g,2)*(1-g)*i+Math.pow(g,3)*h);};cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);this._config=[];this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);b&&this.initWithDuration(a,b);},initWithDuration:function(a,b){if(cc.ActionInterval.prototype.initWithDuration.call(this,a)){this._config=b;return true;}return false;},clone:function(){var d=new cc.BezierBy();this._cloneDecoration(d);var a=[];for(var c=0;c<this._config.length;c++){var b=this._config[c];a.push(cc.p(b.x,b.y));}d.initWithDuration(this._duration,a);return d;},startWithTarget:function(c){cc.ActionInterval.prototype.startWithTarget.call(this,c);var b=c.getPositionX();var a=c.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a;},update:function(b){b=this._computeEaseTime(b);if(this.target){var p=this._config;var a=0;var q=p[0].x;var o=p[1].x;var n=p[2].x;var h=0;var f=p[0].y;var e=p[1].y;var c=p[2].y;var k=cc.bezierAt(a,q,o,n,b);var j=cc.bezierAt(h,f,e,c,b);var d=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var i=this.target.getPositionX();var g=this.target.getPositionY();var m=this._previousPosition;d.x=d.x+i-m.x;d.y=d.y+g-m.y;k=k+d.x;j=j+d.y;m.x=k;m.y=j;this.target.setPosition(k,j);}else{this.target.setPosition(d.x+k,d.y+j);}}},reverse:function(){var a=this._config;var b=[cc.pAdd(a[1],cc.pNeg(a[2])),cc.pAdd(a[0],cc.pNeg(a[2])),cc.pNeg(a[2])];var c=new cc.BezierBy(this._duration,b);this._cloneDecoration(c);this._reverseEaseList(c);return c;}});cc.bezierBy=function(a,b){return new cc.BezierBy(a,b);};cc.BezierBy.create=cc.bezierBy;cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(a,b){cc.BezierBy.prototype.ctor.call(this);this._toConfig=[];b&&this.initWithDuration(a,b);},initWithDuration:function(a,b){if(cc.ActionInterval.prototype.initWithDuration.call(this,a)){this._toConfig=b;return true;}return false;},clone:function(){var a=new cc.BezierTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._toConfig);return a;},startWithTarget:function(d){cc.BezierBy.prototype.startWithTarget.call(this,d);var b=this._startPosition;var c=this._toConfig;var a=this._config;a[0]=cc.pSub(c[0],b);a[1]=cc.pSub(c[1],b);a[2]=cc.pSub(c[2],b);}});cc.bezierTo=function(a,b){return new cc.BezierTo(a,b);};cc.BezierTo.create=cc.bezierTo;cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(a,c,b){cc.ActionInterval.prototype.ctor.call(this);c!==undefined&&this.initWithDuration(a,c,b);},initWithDuration:function(a,c,b){if(cc.ActionInterval.prototype.initWithDuration.call(this,a)){this._endScaleX=c;this._endScaleY=(b!=null)?b:c;return true;}return false;},clone:function(){var a=new cc.ScaleTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._endScaleX,this._endScaleY);return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._startScaleX=a.scaleX;this._startScaleY=a.scaleY;this._deltaX=this._endScaleX-this._startScaleX;this._deltaY=this._endScaleY-this._startScaleY;},update:function(a){a=this._computeEaseTime(a);if(this.target){this.target.scaleX=this._startScaleX+this._deltaX*a;this.target.scaleY=this._startScaleY+this._deltaY*a;}}});cc.scaleTo=function(a,c,b){return new cc.ScaleTo(a,c,b);};cc.ScaleTo.create=cc.scaleTo;cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(a){cc.ScaleTo.prototype.startWithTarget.call(this,a);this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX;this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY;},reverse:function(){var a=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);this._cloneDecoration(a);this._reverseEaseList(a);return a;},clone:function(){var a=new cc.ScaleBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._endScaleX,this._endScaleY);return a;}});cc.scaleBy=function(a,c,b){return new cc.ScaleBy(a,c,b);};cc.ScaleBy.create=cc.scaleBy;cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:false,ctor:function(b,a){cc.ActionInterval.prototype.ctor.call(this);a!==undefined&&this.initWithDuration(b,a);},initWithDuration:function(b,a){if(cc.ActionInterval.prototype.initWithDuration.call(this,b)){this._times=a;return true;}return false;},clone:function(){var a=new cc.Blink();this._cloneDecoration(a);a.initWithDuration(this._duration,this._times);return a;},update:function(b){b=this._computeEaseTime(b);if(this.target&&!this.isDone()){var c=1/this._times;var a=b%c;this.target.visible=(a>(c/2));}},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._originalState=a.visible;},stop:function(){this.target.visible=this._originalState;cc.ActionInterval.prototype.stop.call(this);},reverse:function(){var a=new cc.Blink(this._duration,this._times);this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.blink=function(b,a){return new cc.Blink(b,a);};cc.Blink.create=cc.blink;cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(b,a){cc.ActionInterval.prototype.ctor.call(this);a!==undefined&&this.initWithDuration(b,a);},initWithDuration:function(b,a){if(cc.ActionInterval.prototype.initWithDuration.call(this,b)){this._toOpacity=a;return true;}return false;},clone:function(){var a=new cc.FadeTo();this._cloneDecoration(a);a.initWithDuration(this._duration,this._toOpacity);return a;},update:function(b){b=this._computeEaseTime(b);var a=this._fromOpacity!==undefined?this._fromOpacity:255;this.target.opacity=a+(this._toOpacity-a)*b;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._fromOpacity=a.opacity;}});cc.fadeTo=function(b,a){return new cc.FadeTo(b,a);};cc.FadeTo.create=cc.fadeTo;cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(a){cc.FadeTo.prototype.ctor.call(this);if(a==null){a=0;}this.initWithDuration(a,255);},reverse:function(){var a=new cc.FadeOut();a.initWithDuration(this._duration,0);this._cloneDecoration(a);this._reverseEaseList(a);return a;},clone:function(){var a=new cc.FadeIn();this._cloneDecoration(a);a.initWithDuration(this._duration,this._toOpacity);return a;},startWithTarget:function(a){if(this._reverseAction){this._toOpacity=this._reverseAction._fromOpacity;}cc.FadeTo.prototype.startWithTarget.call(this,a);}});cc.fadeIn=function(a){return new cc.FadeIn(a);};cc.FadeIn.create=cc.fadeIn;cc.FadeOut=cc.FadeTo.extend({ctor:function(a){cc.FadeTo.prototype.ctor.call(this);if(a==null){a=0;}this.initWithDuration(a,0);},reverse:function(){var a=new cc.FadeIn();a._reverseAction=this;a.initWithDuration(this._duration,255);this._cloneDecoration(a);this._reverseEaseList(a);return a;},clone:function(){var a=new cc.FadeOut();this._cloneDecoration(a);a.initWithDuration(this._duration,this._toOpacity);return a;}});cc.fadeOut=function(a){return new cc.FadeOut(a);};cc.FadeOut.create=cc.fadeOut;cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(d,c,b,a){cc.ActionInterval.prototype.ctor.call(this);this._to=cc.color(0,0,0);this._from=cc.color(0,0,0);a!==undefined&&this.initWithDuration(d,c,b,a);},initWithDuration:function(d,c,b,a){if(cc.ActionInterval.prototype.initWithDuration.call(this,d)){this._to=cc.color(c,b,a);return true;}return false;},clone:function(){var a=new cc.TintTo();this._cloneDecoration(a);var b=this._to;a.initWithDuration(this._duration,b.r,b.g,b.b);return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._from=this.target.color;},update:function(b){b=this._computeEaseTime(b);var a=this._from,c=this._to;if(a){this.target.color=cc.color(a.r+(c.r-a.r)*b,a.g+(c.g-a.g)*b,a.b+(c.b-a.b)*b);}}});cc.tintTo=function(d,c,b,a){return new cc.TintTo(d,c,b,a);};cc.TintTo.create=cc.tintTo;cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(d,a,c,b){cc.ActionInterval.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(d,a,c,b);},initWithDuration:function(d,a,c,b){if(cc.ActionInterval.prototype.initWithDuration.call(this,d)){this._deltaR=a;this._deltaG=c;this._deltaB=b;return true;}return false;},clone:function(){var a=new cc.TintBy();this._cloneDecoration(a);a.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB);return a;},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);var a=b.color;this._fromR=a.r;this._fromG=a.g;this._fromB=a.b;},update:function(a){a=this._computeEaseTime(a);this.target.color=cc.color(this._fromR+this._deltaR*a,this._fromG+this._deltaG*a,this._fromB+this._deltaB*a);},reverse:function(){var a=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);this._cloneDecoration(a);this._reverseEaseList(a);return a;}});cc.tintBy=function(d,a,c,b){return new cc.TintBy(d,a,c,b);};cc.TintBy.create=cc.tintBy;cc.DelayTime=cc.ActionInterval.extend({update:function(a){},reverse:function(){var a=new cc.DelayTime(this._duration);this._cloneDecoration(a);this._reverseEaseList(a);return a;},clone:function(){var a=new cc.DelayTime();this._cloneDecoration(a);a.initWithDuration(this._duration);return a;}});cc.delayTime=function(a){return new cc.DelayTime(a);};cc.DelayTime.create=cc.delayTime;cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._other=null;a&&this.initWithAction(a);},initWithAction:function(a){if(!a){throw"cc.ReverseTime.initWithAction(): action must be non null";}if(a==this._other){throw"cc.ReverseTime.initWithAction(): the action was already passed in.";}if(cc.ActionInterval.prototype.initWithDuration.call(this,a._duration)){this._other=a;return true;}return false;},clone:function(){var a=new cc.ReverseTime();this._cloneDecoration(a);a.initWithAction(this._other.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._other.startWithTarget(a);},update:function(a){a=this._computeEaseTime(a);if(this._other){this._other.update(1-a);}},reverse:function(){return this._other.clone();},stop:function(){this._other.stop();cc.Action.prototype.stop.call(this);}});cc.reverseTime=function(a){return new cc.ReverseTime(a);};cc.ReverseTime.create=cc.reverseTime;cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._splitTimes=[];a&&this.initWithAnimation(a);},getAnimation:function(){return this._animation;},setAnimation:function(a){this._animation=a;},initWithAnimation:function(c){if(!c){throw"cc.Animate.initWithAnimation(): animation must be non-NULL";}var j=c.getDuration();if(this.initWithDuration(j*c.getLoops())){this._nextFrame=0;this.setAnimation(c);this._origFrame=null;this._executedLoops=0;var h=this._splitTimes;h.length=0;var d=0;var a=j/c.getTotalDelayUnits();var f=c.getFrames();cc.arrayVerifyType(f,cc.AnimationFrame);for(var e=0;e<f.length;e++){var b=f[e];var g=(d*a)/j;d+=b.getDelayUnits();h.push(g);}return true;}return false;},clone:function(){var a=new cc.Animate();this._cloneDecoration(a);a.initWithAnimation(this._animation.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);if(this._animation.getRestoreOriginalFrame()){this._origFrame=a.displayFrame();}this._nextFrame=0;this._executedLoops=0;},update:function(d){d=this._computeEaseTime(d);if(d<1){d*=this._animation.getLoops();var c=0|d;if(c>this._executedLoops){this._nextFrame=0;this._executedLoops++;}d=d%1;}var f=this._animation.getFrames();var e=f.length,a=this._splitTimes;for(var b=this._nextFrame;b<e;b++){if(a[b]<=d){this.target.setSpriteFrame(f[b].getSpriteFrame());this._nextFrame=b+1;}else{break;}}},reverse:function(){var b=this._animation;var f=b.getFrames();var a=[];cc.arrayVerifyType(f,cc.AnimationFrame);if(f.length>0){for(var d=f.length-1;d>=0;d--){var c=f[d];if(!c){break;}a.push(c.clone());}}var e=new cc.Animation(a,b.getDelayPerUnit(),b.getLoops());e.setRestoreOriginalFrame(b.getRestoreOriginalFrame());var g=new cc.Animate(e);this._cloneDecoration(g);this._reverseEaseList(g);return g;},stop:function(){if(this._animation.getRestoreOriginalFrame()&&this.target){this.target.setSpriteFrame(this._origFrame);}cc.Action.prototype.stop.call(this);}});cc.animate=function(a){return new cc.Animate(a);};cc.Animate.create=cc.animate;cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(b,a){cc.ActionInterval.prototype.ctor.call(this);a&&this.initWithTarget(b,a);},initWithTarget:function(b,a){if(this.initWithDuration(a._duration)){this._forcedTarget=b;this._action=a;return true;}return false;},clone:function(){var a=new cc.TargetedAction();this._cloneDecoration(a);a.initWithTarget(this._forcedTarget,this._action.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._action.startWithTarget(this._forcedTarget);},stop:function(){this._action.stop();},update:function(a){a=this._computeEaseTime(a);this._action.update(a);},getForcedTarget:function(){return this._forcedTarget;},setForcedTarget:function(a){if(this._forcedTarget!=a){this._forcedTarget=a;}}});cc.targetedAction=function(b,a){return new cc.TargetedAction(b,a);};cc.TargetedAction.create=cc.targetedAction;cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return true;},step:function(a){this.update(1);},update:function(a){},reverse:function(){return this.clone();},clone:function(){return new cc.ActionInstant();}});cc.Show=cc.ActionInstant.extend({update:function(a){this.target.visible=true;},reverse:function(){return new cc.Hide();},clone:function(){return new cc.Show();}});cc.show=function(){return new cc.Show();};cc.Show.create=cc.show;cc.Hide=cc.ActionInstant.extend({update:function(a){this.target.visible=false;},reverse:function(){return new cc.Show();},clone:function(){return new cc.Hide();}});cc.hide=function(){return new cc.Hide();};cc.Hide.create=cc.hide;cc.ToggleVisibility=cc.ActionInstant.extend({update:function(a){this.target.visible=!this.target.visible;},reverse:function(){return new cc.ToggleVisibility();},clone:function(){return new cc.ToggleVisibility();}});cc.toggleVisibility=function(){return new cc.ToggleVisibility();};cc.ToggleVisibility.create=cc.toggleVisibility;cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:true,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);a!==undefined&&this.init(a);},update:function(a){this.target.removeFromParent(this._isNeedCleanUp);},init:function(a){this._isNeedCleanUp=a;return true;},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp);},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp);}});cc.removeSelf=function(a){return new cc.RemoveSelf(a);};cc.RemoveSelf.create=cc.removeSelf;cc.FlipX=cc.ActionInstant.extend({_flippedX:false,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedX=false;a!==undefined&&this.initWithFlipX(a);},initWithFlipX:function(a){this._flippedX=a;return true;},update:function(a){this.target.flippedX=this._flippedX;},reverse:function(){return new cc.FlipX(!this._flippedX);},clone:function(){var a=new cc.FlipX();a.initWithFlipX(this._flippedX);return a;}});cc.flipX=function(a){return new cc.FlipX(a);};cc.FlipX.create=cc.flipX;cc.FlipY=cc.ActionInstant.extend({_flippedY:false,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedY=false;a!==undefined&&this.initWithFlipY(a);},initWithFlipY:function(a){this._flippedY=a;return true;},update:function(a){this.target.flippedY=this._flippedY;},reverse:function(){return new cc.FlipY(!this._flippedY);},clone:function(){var a=new cc.FlipY();a.initWithFlipY(this._flippedY);return a;}});cc.flipY=function(a){return new cc.FlipY(a);};cc.FlipY.create=cc.flipY;cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(b,a){cc.FiniteTimeAction.prototype.ctor.call(this);this._x=0;this._y=0;if(b!==undefined){if(b.x!==undefined){a=b.y;b=b.x;}this.initWithPosition(b,a);}},initWithPosition:function(a,b){this._x=a;this._y=b;return true;},update:function(a){this.target.setPosition(this._x,this._y);},clone:function(){var a=new cc.Place();a.initWithPosition(this._x,this._y);return a;}});cc.place=function(b,a){return new cc.Place(b,a);};cc.Place.create=cc.place;cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_callFunc:null,_function:null,_data:null,ctor:function(b,a,c){cc.FiniteTimeAction.prototype.ctor.call(this);if(b!==undefined){if(a===undefined){this.initWithFunction(b);}else{this.initWithFunction(b,a,c);}}},initWithFunction:function(b,a,c){if(a){this._data=c;this._callFunc=b;this._selectorTarget=a;}else{if(b){this._function=b;}}return true;},execute:function(){if(this._callFunc!=null){this._callFunc.call(this._selectorTarget,this.target,this._data);}else{if(this._function){this._function.call(null,this.target);}}},update:function(a){this.execute();},getTargetCallback:function(){return this._selectorTarget;},setTargetCallback:function(a){if(a!=this._selectorTarget){if(this._selectorTarget){this._selectorTarget=null;}this._selectorTarget=a;}},clone:function(){var a=new cc.CallFunc();if(this._selectorTarget){a.initWithFunction(this._callFunc,this._selectorTarget,this._data);}else{if(this._function){a.initWithFunction(this._function);}}return a;}});cc.callFunc=function(b,a,c){return new cc.CallFunc(b,a,c);};cc.CallFunc.create=cc.callFunc;cc.ActionCamera=cc.ActionInterval.extend({_centerXOrig:0,_centerYOrig:0,_centerZOrig:0,_eyeXOrig:0,_eyeYOrig:0,_eyeZOrig:0,_upXOrig:0,_upYOrig:0,_upZOrig:0,ctor:function(){var a=this;cc.ActionInterval.prototype.ctor.call(a);a._centerXOrig=0;a._centerYOrig=0;a._centerZOrig=0;a._eyeXOrig=0;a._eyeYOrig=0;a._eyeZOrig=0;a._upXOrig=0;a._upYOrig=0;a._upZOrig=0;},startWithTarget:function(f){var e=this;cc.ActionInterval.prototype.startWithTarget.call(e,f);var d=f.getCamera();var b=d.getCenter();e._centerXOrig=b.x;e._centerYOrig=b.y;e._centerZOrig=b.z;var c=d.getEye();e._eyeXOrig=c.x;e._eyeYOrig=c.y;e._eyeZOrig=c.z;var a=d.getUp();e._upXOrig=a.x;e._upYOrig=a.y;e._upZOrig=a.z;},clone:function(){return new cc.ActionCamera();},reverse:function(){return new cc.ReverseTime(this);}});cc.OrbitCamera=cc.ActionCamera.extend({_radius:0,_deltaRadius:0,_angleZ:0,_deltaAngleZ:0,_angleX:0,_deltaAngleX:0,_radZ:0,_radDeltaZ:0,_radX:0,_radDeltaX:0,ctor:function(e,a,f,c,g,d,b){cc.ActionCamera.prototype.ctor.call(this);b!==undefined&&this.initWithDuration(e,a,f,c,g,d,b);},initWithDuration:function(e,a,g,c,h,d,b){if(cc.ActionInterval.prototype.initWithDuration.call(this,e)){var f=this;f._radius=a;f._deltaRadius=g;f._angleZ=c;f._deltaAngleZ=h;f._angleX=d;f._deltaAngleX=b;f._radDeltaZ=cc.degreesToRadians(h);f._radDeltaX=cc.degreesToRadians(b);return true;}return false;},sphericalRadius:function(){var f,i,k;var c=this.target.getCamera();var b=c.getEye();var d=c.getCenter();var h=b.x-d.x,g=b.y-d.y,e=b.z-d.z;var a=Math.sqrt(Math.pow(h,2)+Math.pow(g,2)+Math.pow(e,2));var j=Math.sqrt(Math.pow(h,2)+Math.pow(g,2));if(j===0){j=cc.FLT_EPSILON;}if(a===0){a=cc.FLT_EPSILON;}i=Math.acos(e/a);if(h<0){k=Math.PI-Math.asin(g/j);}else{k=Math.asin(g/j);}f=a/cc.Camera.getZEye();return{newRadius:f,zenith:i,azimuth:k};},startWithTarget:function(b){var a=this;cc.ActionInterval.prototype.startWithTarget.call(a,b);var c=a.sphericalRadius();if(isNaN(a._radius)){a._radius=c.newRadius;}if(isNaN(a._angleZ)){a._angleZ=cc.radiansToDegrees(c.zenith);}if(isNaN(a._angleX)){a._angleX=cc.radiansToDegrees(c.azimuth);}a._radZ=cc.degreesToRadians(a._angleZ);a._radX=cc.degreesToRadians(a._angleX);},clone:function(){var b=new cc.OrbitCamera(),c=this;b.initWithDuration(c._duration,c._radius,c._deltaRadius,c._angleZ,c._deltaAngleZ,c._angleX,c._deltaAngleX);return b;},update:function(f){f=this._computeEaseTime(f);var e=(this._radius+this._deltaRadius*f)*cc.Camera.getZEye();var c=this._radZ+this._radDeltaZ*f;var g=this._radX+this._radDeltaX*f;var d=Math.sin(c)*Math.cos(g)*e+this._centerXOrig;var b=Math.sin(c)*Math.sin(g)*e+this._centerYOrig;var a=Math.cos(c)*e+this._centerZOrig;this.target.getCamera().setEye(d,b,a);this.target.setNodeDirty();}});cc.orbitCamera=function(e,a,f,c,g,d,b){return new cc.OrbitCamera(e,a,f,c,g,d,b);};cc.OrbitCamera.create=cc.orbitCamera;cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);a&&this.initWithAction(a);},initWithAction:function(a){if(!a){throw"cc.ActionEase.initWithAction(): action must be non nil";}if(this.initWithDuration(a.getDuration())){this._inner=a;return true;}return false;},clone:function(){var a=new cc.ActionEase();a.initWithAction(this._inner.clone());return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._inner.startWithTarget(this.target);},stop:function(){this._inner.stop();cc.ActionInterval.prototype.stop.call(this);},update:function(a){this._inner.update(a);},reverse:function(){return new cc.ActionEase(this._inner.reverse());},getInnerAction:function(){return this._inner;}});cc.actionEase=function(a){return new cc.ActionEase(a);};cc.ActionEase.create=cc.actionEase;cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(b,a){cc.ActionEase.prototype.ctor.call(this);a!==undefined&&this.initWithAction(b,a);},setRate:function(a){this._rate=a;},getRate:function(){return this._rate;},initWithAction:function(b,a){if(cc.ActionEase.prototype.initWithAction.call(this,b)){this._rate=a;return true;}return false;},clone:function(){var a=new cc.EaseRateAction();a.initWithAction(this._inner.clone(),this._rate);return a;},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate);}});cc.easeRateAction=function(b,a){return new cc.EaseRateAction(b,a);};cc.EaseRateAction.create=cc.easeRateAction;cc.EaseIn=cc.EaseRateAction.extend({update:function(a){this._inner.update(Math.pow(a,this._rate));},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate);},clone:function(){var a=new cc.EaseIn();a.initWithAction(this._inner.clone(),this._rate);return a;}});cc.EaseIn.create=function(b,a){return new cc.EaseIn(b,a);};cc.easeIn=function(a){return{_rate:a,easing:function(b){return Math.pow(b,this._rate);},reverse:function(){return cc.easeIn(1/this._rate);}};};cc.EaseOut=cc.EaseRateAction.extend({update:function(a){this._inner.update(Math.pow(a,1/this._rate));},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate);},clone:function(){var a=new cc.EaseOut();a.initWithAction(this._inner.clone(),this._rate);return a;}});cc.EaseOut.create=function(b,a){return new cc.EaseOut(b,a);};cc.easeOut=function(a){return{_rate:a,easing:function(b){return Math.pow(b,1/this._rate);},reverse:function(){return cc.easeOut(1/this._rate);}};};cc.EaseInOut=cc.EaseRateAction.extend({update:function(a){a*=2;if(a<1){this._inner.update(0.5*Math.pow(a,this._rate));}else{this._inner.update(1-0.5*Math.pow(2-a,this._rate));}},clone:function(){var a=new cc.EaseInOut();a.initWithAction(this._inner.clone(),this._rate);return a;},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate);}});cc.EaseInOut.create=function(b,a){return new cc.EaseInOut(b,a);};cc.easeInOut=function(a){return{_rate:a,easing:function(b){b*=2;if(b<1){return 0.5*Math.pow(b,this._rate);}else{return 1-0.5*Math.pow(2-b,this._rate);}},reverse:function(){return cc.easeInOut(this._rate);}};};cc.EaseExponentialIn=cc.ActionEase.extend({update:function(a){this._inner.update(a===0?0:Math.pow(2,10*(a-1)));},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse());},clone:function(){var a=new cc.EaseExponentialIn();a.initWithAction(this._inner.clone());return a;}});cc.EaseExponentialIn.create=function(a){return new cc.EaseExponentialIn(a);};cc._easeExponentialInObj={easing:function(a){return a===0?0:Math.pow(2,10*(a-1));},reverse:function(){return cc._easeExponentialOutObj;}};cc.easeExponentialIn=function(){return cc._easeExponentialInObj;};cc.EaseExponentialOut=cc.ActionEase.extend({update:function(a){this._inner.update(a==1?1:(-(Math.pow(2,-10*a))+1));},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse());},clone:function(){var a=new cc.EaseExponentialOut();a.initWithAction(this._inner.clone());return a;}});cc.EaseExponentialOut.create=function(a){return new cc.EaseExponentialOut(a);};cc._easeExponentialOutObj={easing:function(a){return a==1?1:(-(Math.pow(2,-10*a))+1);},reverse:function(){return cc._easeExponentialInObj;}};cc.easeExponentialOut=function(){return cc._easeExponentialOutObj;};cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(a){if(a!=1&&a!==0){a*=2;if(a<1){a=0.5*Math.pow(2,10*(a-1));}else{a=0.5*(-Math.pow(2,-10*(a-1))+2);}}this._inner.update(a);},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse());},clone:function(){var a=new cc.EaseExponentialInOut();a.initWithAction(this._inner.clone());return a;}});cc.EaseExponentialInOut.create=function(a){return new cc.EaseExponentialInOut(a);};cc._easeExponentialInOutObj={easing:function(a){if(a!==1&&a!==0){a*=2;if(a<1){return 0.5*Math.pow(2,10*(a-1));}else{return 0.5*(-Math.pow(2,-10*(a-1))+2);}}return a;},reverse:function(){return cc._easeExponentialInOutObj;}};cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj;};cc.EaseSineIn=cc.ActionEase.extend({update:function(a){a=a===0||a===1?a:-1*Math.cos(a*Math.PI/2)+1;this._inner.update(a);},reverse:function(){return new cc.EaseSineOut(this._inner.reverse());},clone:function(){var a=new cc.EaseSineIn();a.initWithAction(this._inner.clone());return a;}});cc.EaseSineIn.create=function(a){return new cc.EaseSineIn(a);};cc._easeSineInObj={easing:function(a){return(a===0||a===1)?a:-1*Math.cos(a*Math.PI/2)+1;},reverse:function(){return cc._easeSineOutObj;}};cc.easeSineIn=function(){return cc._easeSineInObj;};cc.EaseSineOut=cc.ActionEase.extend({update:function(a){a=a===0||a===1?a:Math.sin(a*Math.PI/2);this._inner.update(a);},reverse:function(){return new cc.EaseSineIn(this._inner.reverse());},clone:function(){var a=new cc.EaseSineOut();a.initWithAction(this._inner.clone());return a;}});cc.EaseSineOut.create=function(a){return new cc.EaseSineOut(a);};cc._easeSineOutObj={easing:function(a){return(a===0||a==1)?a:Math.sin(a*Math.PI/2);},reverse:function(){return cc._easeSineInObj;}};cc.easeSineOut=function(){return cc._easeSineOutObj;};cc.EaseSineInOut=cc.ActionEase.extend({update:function(a){a=a===0||a===1?a:-0.5*(Math.cos(Math.PI*a)-1);this._inner.update(a);},clone:function(){var a=new cc.EaseSineInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse());}});cc.EaseSineInOut.create=function(a){return new cc.EaseSineInOut(a);};cc._easeSineInOutObj={easing:function(a){return(a===0||a===1)?a:-0.5*(Math.cos(Math.PI*a)-1);},reverse:function(){return cc._easeSineInOutObj;}};cc.easeSineInOut=function(){return cc._easeSineInOutObj;};cc.EaseElastic=cc.ActionEase.extend({_period:0.3,ctor:function(a,b){cc.ActionEase.prototype.ctor.call(this);a&&this.initWithAction(a,b);},getPeriod:function(){return this._period;},setPeriod:function(a){this._period=a;},initWithAction:function(a,b){cc.ActionEase.prototype.initWithAction.call(this,a);this._period=(b==null)?0.3:b;return true;},reverse:function(){cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass.");return null;},clone:function(){var a=new cc.EaseElastic();a.initWithAction(this._inner.clone(),this._period);return a;}});cc.EaseElastic.create=function(a,b){return new cc.EaseElastic(a,b);};cc.EaseElasticIn=cc.EaseElastic.extend({update:function(c){var a=0;if(c===0||c===1){a=c;}else{var b=this._period/4;c=c-1;a=-Math.pow(2,10*c)*Math.sin((c-b)*Math.PI*2/this._period);}this._inner.update(a);},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period);},clone:function(){var a=new cc.EaseElasticIn();a.initWithAction(this._inner.clone(),this._period);return a;}});cc.EaseElasticIn.create=function(a,b){return new cc.EaseElasticIn(a,b);};cc._easeElasticInObj={easing:function(a){if(a===0||a===1){return a;}a=a-1;return -Math.pow(2,10*a)*Math.sin((a-(0.3/4))*Math.PI*2/0.3);},reverse:function(){return cc._easeElasticOutObj;}};cc.easeElasticIn=function(a){if(a&&a!==0.3){return{_period:a,easing:function(b){if(b===0||b===1){return b;}b=b-1;return -Math.pow(2,10*b)*Math.sin((b-(this._period/4))*Math.PI*2/this._period);},reverse:function(){return cc.easeElasticOut(this._period);}};}return cc._easeElasticInObj;};cc.EaseElasticOut=cc.EaseElastic.extend({update:function(c){var a=0;if(c===0||c==1){a=c;}else{var b=this._period/4;a=Math.pow(2,-10*c)*Math.sin((c-b)*Math.PI*2/this._period)+1;}this._inner.update(a);},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period);},clone:function(){var a=new cc.EaseElasticOut();a.initWithAction(this._inner.clone(),this._period);return a;}});cc.EaseElasticOut.create=function(a,b){return new cc.EaseElasticOut(a,b);};cc._easeElasticOutObj={easing:function(a){return(a===0||a===1)?a:Math.pow(2,-10*a)*Math.sin((a-(0.3/4))*Math.PI*2/0.3)+1;},reverse:function(){return cc._easeElasticInObj;}};cc.easeElasticOut=function(a){if(a&&a!==0.3){return{_period:a,easing:function(b){return(b===0||b===1)?b:Math.pow(2,-10*b)*Math.sin((b-(this._period/4))*Math.PI*2/this._period)+1;},reverse:function(){return cc.easeElasticIn(this._period);}};}return cc._easeElasticOutObj;};cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(c){var a=0;var d=this._period;if(c===0||c==1){a=c;}else{c=c*2;if(!d){d=this._period=0.3*1.5;}var b=d/4;c=c-1;if(c<0){a=-0.5*Math.pow(2,10*c)*Math.sin((c-b)*Math.PI*2/d);}else{a=Math.pow(2,-10*c)*Math.sin((c-b)*Math.PI*2/d)*0.5+1;}}this._inner.update(a);},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period);},clone:function(){var a=new cc.EaseElasticInOut();a.initWithAction(this._inner.clone(),this._period);return a;}});cc.EaseElasticInOut.create=function(a,b){return new cc.EaseElasticInOut(a,b);};cc.easeElasticInOut=function(a){a=a||0.3;return{_period:a,easing:function(d){var b=0;var e=this._period;if(d===0||d===1){b=d;}else{d=d*2;if(!e){e=this._period=0.3*1.5;}var c=e/4;d=d-1;if(d<0){b=-0.5*Math.pow(2,10*d)*Math.sin((d-c)*Math.PI*2/e);}else{b=Math.pow(2,-10*d)*Math.sin((d-c)*Math.PI*2/e)*0.5+1;}}return b;},reverse:function(){return cc.easeElasticInOut(this._period);}};};cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(a){if(a<1/2.75){return 7.5625*a*a;}else{if(a<2/2.75){a-=1.5/2.75;return 7.5625*a*a+0.75;}else{if(a<2.5/2.75){a-=2.25/2.75;return 7.5625*a*a+0.9375;}}}a-=2.625/2.75;return 7.5625*a*a+0.984375;},clone:function(){var a=new cc.EaseBounce();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseBounce(this._inner.reverse());}});cc.EaseBounce.create=function(a){return new cc.EaseBounce(a);};cc.EaseBounceIn=cc.EaseBounce.extend({update:function(b){var a=1-this.bounceTime(1-b);this._inner.update(a);},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse());},clone:function(){var a=new cc.EaseBounceIn();a.initWithAction(this._inner.clone());return a;}});cc.EaseBounceIn.create=function(a){return new cc.EaseBounceIn(a);};cc._bounceTime=function(a){if(a<1/2.75){return 7.5625*a*a;}else{if(a<2/2.75){a-=1.5/2.75;return 7.5625*a*a+0.75;}else{if(a<2.5/2.75){a-=2.25/2.75;return 7.5625*a*a+0.9375;}}}a-=2.625/2.75;return 7.5625*a*a+0.984375;};cc._easeBounceInObj={easing:function(a){return 1-cc._bounceTime(1-a);},reverse:function(){return cc._easeBounceOutObj;}};cc.easeBounceIn=function(){return cc._easeBounceInObj;};cc.EaseBounceOut=cc.EaseBounce.extend({update:function(b){var a=this.bounceTime(b);this._inner.update(a);},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse());},clone:function(){var a=new cc.EaseBounceOut();a.initWithAction(this._inner.clone());return a;}});cc.EaseBounceOut.create=function(a){return new cc.EaseBounceOut(a);};cc._easeBounceOutObj={easing:function(a){return cc._bounceTime(a);},reverse:function(){return cc._easeBounceInObj;}};cc.easeBounceOut=function(){return cc._easeBounceOutObj;};cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(b){var a=0;if(b<0.5){b=b*2;a=(1-this.bounceTime(1-b))*0.5;}else{a=this.bounceTime(b*2-1)*0.5+0.5;}this._inner.update(a);},clone:function(){var a=new cc.EaseBounceInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse());}});cc.EaseBounceInOut.create=function(a){return new cc.EaseBounceInOut(a);};cc._easeBounceInOutObj={easing:function(b){var a;if(b<0.5){b=b*2;a=(1-cc._bounceTime(1-b))*0.5;}else{a=cc._bounceTime(b*2-1)*0.5+0.5;}return a;},reverse:function(){return cc._easeBounceInOutObj;}};cc.easeBounceInOut=function(){return cc._easeBounceInOutObj;};cc.EaseBackIn=cc.ActionEase.extend({update:function(b){var a=1.70158;b=b===0||b==1?b:b*b*((a+1)*b-a);this._inner.update(b);},reverse:function(){return new cc.EaseBackOut(this._inner.reverse());},clone:function(){var a=new cc.EaseBackIn();a.initWithAction(this._inner.clone());return a;}});cc.EaseBackIn.create=function(a){return new cc.EaseBackIn(a);};cc._easeBackInObj={easing:function(b){var a=1.70158;return(b===0||b===1)?b:b*b*((a+1)*b-a);},reverse:function(){return cc._easeBackOutObj;}};cc.easeBackIn=function(){return cc._easeBackInObj;};cc.EaseBackOut=cc.ActionEase.extend({update:function(b){var a=1.70158;b=b-1;this._inner.update(b*b*((a+1)*b+a)+1);},reverse:function(){return new cc.EaseBackIn(this._inner.reverse());},clone:function(){var a=new cc.EaseBackOut();a.initWithAction(this._inner.clone());return a;}});cc.EaseBackOut.create=function(a){return new cc.EaseBackOut(a);};cc._easeBackOutObj={easing:function(b){var a=1.70158;b=b-1;return b*b*((a+1)*b+a)+1;},reverse:function(){return cc._easeBackInObj;}};cc.easeBackOut=function(){return cc._easeBackOutObj;};cc.EaseBackInOut=cc.ActionEase.extend({update:function(b){var a=1.70158*1.525;b=b*2;if(b<1){this._inner.update((b*b*((a+1)*b-a))/2);}else{b=b-2;this._inner.update((b*b*((a+1)*b+a))/2+1);}},clone:function(){var a=new cc.EaseBackInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse());}});cc.EaseBackInOut.create=function(a){return new cc.EaseBackInOut(a);};cc._easeBackInOutObj={easing:function(b){var a=1.70158*1.525;b=b*2;if(b<1){return(b*b*((a+1)*b-a))/2;}else{b=b-2;return(b*b*((a+1)*b+a))/2+1;}},reverse:function(){return cc._easeBackInOutObj;}};cc.easeBackInOut=function(){return cc._easeBackInOutObj;};cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(a){cc.ActionEase.prototype.ctor.call(this,a);},_updateTime:function(f,e,i,h,g){return(Math.pow(1-g,3)*f+3*g*(Math.pow(1-g,2))*e+3*Math.pow(g,2)*(1-g)*i+Math.pow(g,3)*h);},update:function(b){var a=this._updateTime(this._p0,this._p1,this._p2,this._p3,b);this._inner.update(a);},clone:function(){var a=new cc.EaseBezierAction();a.initWithAction(this._inner.clone());a.setBezierParamer(this._p0,this._p1,this._p2,this._p3);return a;},reverse:function(){var a=new cc.EaseBezierAction(this._inner.reverse());a.setBezierParamer(this._p3,this._p2,this._p1,this._p0);return a;},setBezierParamer:function(d,c,b,a){this._p0=d||0;this._p1=c||0;this._p2=b||0;this._p3=a||0;}});cc.EaseBezierAction.create=function(a){return new cc.EaseBezierAction(a);};cc.easeBezierAction=function(d,c,b,a){return{easing:function(e){return cc.EaseBezierAction.prototype._updateTime(d,c,b,a,e);},reverse:function(){return cc.easeBezierAction(a,b,c,d);}};};cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(a){return Math.pow(a,2);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuadraticActionIn();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse());}});cc.EaseQuadraticActionIn.create=function(a){return new cc.EaseQuadraticActionIn(a);};cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn;}};cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn;};cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(a){return -a*(a-2);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuadraticActionOut();a.initWithAction();return a;},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse());}});cc.EaseQuadraticActionOut.create=function(a){return new cc.EaseQuadraticActionOut(a);};cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut;}};cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut;};cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(b){var a=b;b*=2;if(b<1){a=b*b*0.5;}else{--b;a=-0.5*(b*(b-2)-1);}return a;},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuadraticActionInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse());}});cc.EaseQuadraticActionInOut.create=function(a){return new cc.EaseQuadraticActionInOut(a);};cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut;}};cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut;};cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a*a;},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuarticActionIn();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse());}});cc.EaseQuarticActionIn.create=function(a){return new cc.EaseQuarticActionIn(a);};cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn;}};cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn;};cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(a){a-=1;return -(a*a*a*a-1);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuarticActionOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse());}});cc.EaseQuarticActionOut.create=function(a){return new cc.EaseQuarticActionOut(a);};cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut;}};cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut;};cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(a){a=a*2;if(a<1){return 0.5*a*a*a*a;}a-=2;return -0.5*(a*a*a*a-2);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuarticActionInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse());}});cc.EaseQuarticActionInOut.create=function(a){return new cc.EaseQuarticActionInOut(a);};cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut;}};cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut;};cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a*a*a;},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuinticActionIn();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse());}});cc.EaseQuinticActionIn.create=function(a){return new cc.EaseQuinticActionIn(a);};cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn;}};cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn;};cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(a){a-=1;return(a*a*a*a*a+1);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuinticActionOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse());}});cc.EaseQuinticActionOut.create=function(a){return new cc.EaseQuinticActionOut(a);};cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut;}};cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut;};cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(a){a=a*2;if(a<1){return 0.5*a*a*a*a*a;}a-=2;return 0.5*(a*a*a*a*a+2);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseQuinticActionInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse());}});cc.EaseQuinticActionInOut.create=function(a){return new cc.EaseQuinticActionInOut(a);};cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut;}};cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut;};cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(a){return -1*(Math.sqrt(1-a*a)-1);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCircleActionIn();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse());}});cc.EaseCircleActionIn.create=function(a){return new cc.EaseCircleActionIn(a);};cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn;}};cc.easeCircleActionIn=function(){return cc._easeCircleActionIn;};cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(a){a=a-1;return Math.sqrt(1-a*a);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCircleActionOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse());}});cc.EaseCircleActionOut.create=function(a){return new cc.EaseCircleActionOut(a);};cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut;}};cc.easeCircleActionOut=function(){return cc._easeCircleActionOut;};cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(a){a=a*2;if(a<1){return -0.5*(Math.sqrt(1-a*a)-1);}a-=2;return 0.5*(Math.sqrt(1-a*a)+1);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCircleActionInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse());}});cc.EaseCircleActionInOut.create=function(a){return new cc.EaseCircleActionInOut(a);};cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut;}};cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut;};cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a;},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCubicActionIn();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse());}});cc.EaseCubicActionIn.create=function(a){return new cc.EaseCubicActionIn(a);};cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn;}};cc.easeCubicActionIn=function(){return cc._easeCubicActionIn;};cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(a){a-=1;return(a*a*a+1);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCubicActionOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse());}});cc.EaseCubicActionOut.create=function(a){return new cc.EaseCubicActionOut(a);};cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut;}};cc.easeCubicActionOut=function(){return cc._easeCubicActionOut;};cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(a){a=a*2;if(a<1){return 0.5*a*a*a;}a-=2;return 0.5*(a*a*a+2);},update:function(a){this._inner.update(this._updateTime(a));},clone:function(){var a=new cc.EaseCubicActionInOut();a.initWithAction(this._inner.clone());return a;},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse());}});cc.EaseCubicActionInOut.create=function(a){return new cc.EaseCubicActionInOut(a);};cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut;}};cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut;};cc.cardinalSplineAt=function(n,m,k,i,j,o){var b=o*o;var a=b*o;var p=(1-j)/2;var h=p*((-a+(2*b))-o);var f=p*(-a+b)+(2*a-3*b+1);var d=p*(a-2*b+o)+(-2*a+3*b);var c=p*(a-b);var g=(n.x*h+m.x*f+k.x*d+i.x*c);var e=(n.y*h+m.y*f+k.y*d+i.y*c);return cc.p(g,e);};cc.reverseControlPoints=function(b){var a=[];for(var c=b.length-1;c>=0;c--){a.push(cc.p(b[c].x,b[c].y));}return a;};cc.cloneControlPoints=function(b){var a=[];for(var c=0;c<b.length;c++){a.push(cc.p(b[c].x,b[c].y));}return a;};cc.copyControlPoints=cc.cloneControlPoints;cc.getControlPointAt=function(a,c){var b=Math.min(a.length-1,Math.max(c,0));return a[b];};cc.reverseControlPointsInline=function(c){var a=c.length;var d=0|(a/2);for(var e=0;e<d;++e){var b=c[e];c[e]=c[a-e-1];c[a-e-1]=b;}};cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(c,b,a){cc.ActionInterval.prototype.ctor.call(this);this._points=[];a!==undefined&&this.initWithDuration(c,b,a);},initWithDuration:function(c,b,a){if(!b||b.length==0){throw"Invalid configuration. It must at least have one control point";}if(cc.ActionInterval.prototype.initWithDuration.call(this,c)){this.setPoints(b);this._tension=a;return true;}return false;},clone:function(){var a=new cc.CardinalSplineTo();a.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension);return a;},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._deltaT=1/(this._points.length-1);this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY());this._accumulatedDiff=cc.p(0,0);},update:function(c){c=this._computeEaseTime(c);var b,d;var a=this._points;if(c==1){b=a.length-1;d=1;}else{var i=this._deltaT;b=0|(c/i);d=(c-i*b)/i;}var g=cc.cardinalSplineAt(cc.getControlPointAt(a,b-1),cc.getControlPointAt(a,b-0),cc.getControlPointAt(a,b+1),cc.getControlPointAt(a,b+2),this._tension,d);if(cc.ENABLE_STACKABLE_ACTIONS){var f,e;f=this.target.getPositionX()-this._previousPosition.x;e=this.target.getPositionY()-this._previousPosition.y;if(f!=0||e!=0){var h=this._accumulatedDiff;f=h.x+f;e=h.y+e;h.x=f;h.y=e;g.x+=f;g.y+=e;}}this.updatePosition(g);},reverse:function(){var a=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,a,this._tension);},updatePosition:function(a){this.target.setPosition(a);this._previousPosition=a;},getPoints:function(){return this._points;},setPoints:function(a){this._points=a;}});cc.cardinalSplineTo=function(c,b,a){return new cc.CardinalSplineTo(c,b,a);};cc.CardinalSplineTo.create=cc.cardinalSplineTo;cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(c,b,a){cc.CardinalSplineTo.prototype.ctor.call(this);this._startPosition=cc.p(0,0);a!==undefined&&this.initWithDuration(c,b,a);},startWithTarget:function(a){cc.CardinalSplineTo.prototype.startWithTarget.call(this,a);this._startPosition.x=a.getPositionX();this._startPosition.y=a.getPositionY();},reverse:function(){var e=this._points.slice();var d;var c=e[0];for(var a=1;a<e.length;++a){d=e[a];e[a]=cc.pSub(d,c);c=d;}var b=cc.reverseControlPoints(e);c=b[b.length-1];b.pop();c.x=-c.x;c.y=-c.y;b.unshift(c);for(var a=1;a<b.length;++a){d=b[a];d.x=-d.x;d.y=-d.y;d.x+=c.x;d.y+=c.y;b[a]=d;c=d;}return cc.cardinalSplineBy(this._duration,b,this._tension);},updatePosition:function(a){var d=this._startPosition;var c=a.x+d.x;var b=a.y+d.y;this._previousPosition.x=c;this._previousPosition.y=b;this.target.setPosition(c,b);},clone:function(){var b=new cc.CardinalSplineBy();b.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension);return b;}});cc.cardinalSplineBy=function(c,b,a){return new cc.CardinalSplineBy(c,b,a);};cc.CardinalSplineBy.create=cc.cardinalSplineBy;cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(b,a){a&&this.initWithDuration(b,a);},initWithDuration:function(b,a){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,b,a,0.5);},clone:function(){var a=new cc.CatmullRomTo();a.initWithDuration(this._duration,cc.copyControlPoints(this._points));return a;}});cc.catmullRomTo=function(b,a){return new cc.CatmullRomTo(b,a);};cc.CatmullRomTo.create=cc.catmullRomTo;cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(b,a){cc.CardinalSplineBy.prototype.ctor.call(this);a&&this.initWithDuration(b,a);},initWithDuration:function(b,a){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,b,a,0.5);},clone:function(){var a=new cc.CatmullRomBy();a.initWithDuration(this._duration,cc.copyControlPoints(this._points));return a;}});cc.catmullRomBy=function(b,a){return new cc.CatmullRomBy(b,a);};cc.CatmullRomBy.create=cc.catmullRomBy;cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(b,a){}});cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(b,a,d,c){cc.ActionInterval.prototype.ctor.call(this);this.key="";c!==undefined&&this.initWithDuration(b,a,d,c);},initWithDuration:function(b,a,d,c){if(cc.ActionInterval.prototype.initWithDuration.call(this,b)){this.key=a;this.to=c;this.from=d;return true;}return false;},startWithTarget:function(a){if(!a||!a.updateTweenAction){throw"cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function";}cc.ActionInterval.prototype.startWithTarget.call(this,a);this.delta=this.to-this.from;},update:function(a){this.target.updateTweenAction(this.to-this.delta*(1-a),this.key);},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from);},clone:function(){var a=new cc.ActionTween();a.initWithDuration(this._duration,this.key,this.from,this.to);return a;}});cc.actionTween=function(b,a,d,c){return new cc.ActionTween(b,a,d,c);};cc.ActionTween.create=cc.actionTween;(function(){var c=false;var g=cc.sys;var b={"common":{multichannel:true,webAudio:cc.sys._supportWebAudio,auto:true}};b[g.BROWSER_TYPE_IE]={multichannel:true,webAudio:cc.sys._supportWebAudio,auto:true,emptied:true};b[g.BROWSER_TYPE_ANDROID]={multichannel:false,webAudio:false,auto:false};b[g.BROWSER_TYPE_CHROME]={multichannel:true,webAudio:true,auto:false};b[g.BROWSER_TYPE_FIREFOX]={multichannel:true,webAudio:true,auto:true};b[g.BROWSER_TYPE_UC]={multichannel:true,webAudio:false,auto:false};b[g.BROWSER_TYPE_QQ]={multichannel:false,webAudio:false,auto:true};b[g.BROWSER_TYPE_OUPENG]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_WECHAT]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_360]={multichannel:false,webAudio:false,auto:true};b[g.BROWSER_TYPE_MIUI]={multichannel:false,webAudio:false,auto:true};b[g.BROWSER_TYPE_LIEBAO]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_SOUGOU]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_BAIDU]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_BAIDU_APP]={multichannel:false,webAudio:false,auto:false,replay:true,emptied:true};b[g.BROWSER_TYPE_SAFARI]={multichannel:true,webAudio:true,auto:false,webAudioCallback:function(e){document.createElement("audio").src=e;}};var a,f;try{var d=navigator.userAgent.toLowerCase();switch(g.browserType){case g.BROWSER_TYPE_IE:f=d.match(/(msie |rv:)([\d.]+)/);break;case g.BROWSER_TYPE_FIREFOX:f=d.match(/(firefox\/|rv:)([\d.]+)/);break;case g.BROWSER_TYPE_CHROME:f=d.match(/chrome\/([\d.]+)/);break;case g.BROWSER_TYPE_BAIDU:f=d.match(/baidubrowser\/([\d.]+)/);break;case g.BROWSER_TYPE_UC:f=d.match(/ucbrowser\/([\d.]+)/);break;case g.BROWSER_TYPE_QQ:f=d.match(/qqbrowser\/([\d.]+)/);break;case g.BROWSER_TYPE_OUPENG:f=d.match(/oupeng\/([\d.]+)/);break;case g.BROWSER_TYPE_WECHAT:f=d.match(/micromessenger\/([\d.]+)/);break;case g.BROWSER_TYPE_SAFARI:f=d.match(/safari\/([\d.]+)/);break;case g.BROWSER_TYPE_MIUI:f=d.match(/miuibrowser\/([\d.]+)/);break;}a=f?f[1]:"";}catch(h){console.log(h);}if(a){switch(g.browserType){case g.BROWSER_TYPE_CHROME:if(parseInt(a)<30){b[g.BROWSER_TYPE_CHROME]={multichannel:false,webAudio:true,auto:false};}break;case g.BROWSER_TYPE_MIUI:a=a.match(/\d+/g);if(a[0]<2||(a[0]==2&&a[1]==0&&a[2]<=1)){b[g.BROWSER_TYPE_MIUI].auto=false;}break;}}if(cc.sys.isMobile){if(cc.sys.os!=cc.sys.OS_IOS){cc.__audioSupport=b[g.browserType]||b["common"];}else{cc.__audioSupport=b[g.BROWSER_TYPE_SAFARI];}}else{if(cc.sys.browserType!=cc.sys.BROWSER_TYPE_IE){cc.__audioSupport=b["common"];}else{cc.__audioSupport=b[g.BROWSER_TYPE_IE];}}if(c){setTimeout(function(){cc.log("browse type: "+g.browserType);cc.log("browse version: "+a);cc.log("multichannel: "+cc.__audioSupport.multichannel);cc.log("webAudio: "+cc.__audioSupport.webAudio);cc.log("auto: "+cc.__audioSupport.auto);},0);}})();cc.Audio=cc.Class.extend({volume:1,loop:false,src:null,_touch:false,_playing:false,_AUDIO_TYPE:"AUDIO",_pause:false,_buffer:null,_currentSource:null,_startTime:null,_currentTime:null,_context:null,_volume:null,_ignoreEnded:false,_element:null,ctor:function(b,c,a){b&&(this._context=b);c&&(this._volume=c);if(b&&c){this._AUDIO_TYPE="WEBAUDIO";}this.src=a;},_setBufferCallback:null,setBuffer:function(a){if(!a){return;}var b=this._playing;this._AUDIO_TYPE="WEBAUDIO";if(this._buffer&&this._buffer!=a&&this.getPlaying()){this.stop();}this._buffer=a;if(b){this.play();}this._volume["gain"].value=this.volume;this._setBufferCallback&&this._setBufferCallback(a);},_setElementCallback:null,setElement:function(b){if(!b){return;}var a=this._playing;this._AUDIO_TYPE="AUDIO";if(this._element&&this._element!=b&&this.getPlaying()){this.stop();}this._element=b;if(a){this.play();}b.volume=this.volume;b.loop=this.loop;this._setElementCallback&&this._setElementCallback(b);},play:function(b,a){this._playing=true;this.loop=a===undefined?this.loop:a;if(this._AUDIO_TYPE==="AUDIO"){this._playOfAudio(b);}else{this._playOfWebAudio(b);}},getPlaying:function(){if(!this._playing){return this._playing;}if(this._AUDIO_TYPE==="AUDIO"){var b=this._element;if(!b||this._pause){this._playing=false;return false;}else{if(b.ended){this._playing=false;return false;}else{return true;}}}else{var a=this._currentSource;if(!this._playing&&!a){return true;}if(a["playbackState"]==null){return this._playing;}else{return this._currentTime+this._context.currentTime-this._startTime<this._currentSource.buffer.duration;}}},_playOfWebAudio:function(e){var b=this._currentSource;if(!this._buffer){return;}if(!this._pause&&b){if(this._context.currentTime===0||this._currentTime+this._context.currentTime-this._startTime>this._currentSource.buffer.duration){this._stopOfWebAudio();}else{return;}}var c=this._context["createBufferSource"]();c.buffer=this._buffer;c["connect"](this._volume);c.loop=this.loop;this._startTime=this._context.currentTime;this._currentTime=0;if(c.start){c.start(0,e||0);}else{if(c["noteGrainOn"]){var d=c.buffer.duration;if(this.loop){c["noteGrainOn"](0,e,d);}else{c["noteGrainOn"](0,e,d-e);}}else{c["noteOn"](0);}}this._currentSource=c;var a=this;c["onended"]=function(){if(a._ignoreEnded){a._ignoreEnded=false;}else{a._playing=false;}};},_playOfAudio:function(){var a=this._element;if(a){a.loop=this.loop;a.play();}},stop:function(){this._playing=false;if(this._AUDIO_TYPE==="AUDIO"){this._stopOfAudio();}else{this._stopOfWebAudio();}},_stopOfWebAudio:function(){var a=this._currentSource;this._ignoreEnded=true;if(a){a.stop(0);this._currentSource=null;}},_stopOfAudio:function(){var a=this._element;if(a){a.pause();if(a.duration&&a.duration!=Infinity){a.currentTime=0;}}},pause:function(){this._playing=false;this._pause=true;if(this._AUDIO_TYPE==="AUDIO"){this._pauseOfAudio();}else{this._pauseOfWebAudio();}},_pauseOfWebAudio:function(){this._currentTime+=this._context.currentTime-this._startTime;var a=this._currentSource;if(a){a.stop(0);}},_pauseOfAudio:function(){var a=this._element;if(a){a.pause();}},resume:function(){if(this._pause){if(this._AUDIO_TYPE==="AUDIO"){this._resumeOfAudio();}else{this._resumeOfWebAudio();}this._pause=false;this._playing=true;}},_resumeOfWebAudio:function(){var a=this._currentSource;if(a){this._startTime=this._context.currentTime;var b=this._currentTime%a.buffer.duration;this._playOfWebAudio(b);}},_resumeOfAudio:function(){var a=this._element;if(a){a.play();}},setVolume:function(a){if(a>1){a=1;}if(a<0){a=0;}this.volume=a;if(this._AUDIO_TYPE==="AUDIO"){if(this._element){this._element.volume=a;}}else{if(this._volume){this._volume["gain"].value=a;}}},getVolume:function(){return this.volume;},cloneNode:function(){var d,a;if(this._AUDIO_TYPE==="AUDIO"){d=new cc.Audio();var c=document.createElement("audio");c.src=this.src;d.setElement(c);}else{var b=this._context["createGain"]();b["gain"].value=1;b["connect"](this._context["destination"]);d=new cc.Audio(this._context,b,this.src);if(this._buffer){d.setBuffer(this._buffer);}else{a=this;this._setBufferCallback=function(e){d.setBuffer(e);a._setBufferCallback=null;};}}d._AUDIO_TYPE=this._AUDIO_TYPE;return d;}});(function(d){var i=d.webAudio,h=d.multichannel,f=d.auto;var g=[];(function(){var m=document.createElement("audio");if(m.canPlayType){var p=m.canPlayType('audio/ogg; codecs="vorbis"');if(p&&p!==""){g.push(".ogg");}var j=m.canPlayType("audio/mpeg");if(j&&j!==""){g.push(".mp3");}var k=m.canPlayType('audio/wav; codecs="1"');if(k&&k!==""){g.push(".wav");}var o=m.canPlayType("audio/mp4");if(o&&o!==""){g.push(".mp4");}var n=m.canPlayType("audio/x-m4a");if(n&&n!==""){g.push(".m4a");}}})();try{if(i){var b=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext)();}}catch(c){i=false;cc.log("browser don't support webAudio");}var e={cache:{},load:function(n,j,s,m){if(g.length===0){return m("can not support audio!");}var p;var r=cc.path.extname(n);var k=[r];for(p=0;p<g.length;p++){if(r!==g[p]){k.push(g[p]);}}var o;if(e.cache[j]){return m(null,e.cache[j]);}if(i){var q=b["createGain"]();q["gain"].value=1;q["connect"](b["destination"]);o=new cc.Audio(b,q,n);}else{o=new cc.Audio(null,null,n);}this.loadAudioFromExtList(n,k,o,m);e.cache[j]=o;},loadAudioFromExtList:function(o,m,r,n){if(m.length===0){var u="can not found the resource of audio! Last match url is : ";u+=o.replace(/\.(.*)?$/,"(");g.forEach(function(x){u+=x+"|";});u=u.replace(/\|$/,")");return n(u);}o=cc.path.changeExtname(o,m.splice(0,1));if(i){if(d.webAudioCallback){d.webAudioCallback(o);}var p=new XMLHttpRequest();p.open("GET",o,true);p.responseType="arraybuffer";p.onload=function(){b["decodeAudioData"](p.response,function(x){r.setBuffer(x);n(null,r);},function(){e.loadAudioFromExtList(o,m,r,n);});};p.send();}else{var s=document.createElement("audio");var v=false;var q=false;var j=setTimeout(function(){if(s.readyState==0){t();}else{q=true;n("audio load timeout : "+o,r);}},10000);var w=function(){if(!v){r.setElement(s);s.removeEventListener("canplaythrough",w,false);s.removeEventListener("error",k,false);s.removeEventListener("emptied",t,false);!q&&n(null,r);v=true;clearTimeout(j);}};var k=function(){if(!v){return;}s.removeEventListener("canplaythrough",w,false);s.removeEventListener("error",k,false);s.removeEventListener("emptied",t,false);!q&&e.loadAudioFromExtList(o,m,r,n);v=true;clearTimeout(j);};var t=function(){q=true;w();n(null,r);};cc._addEventListener(s,"canplaythrough",w,false);cc._addEventListener(s,"error",k,false);if(d.emptied){cc._addEventListener(s,"emptied",t,false);}s.src=o;s.load();}}};cc.loader.register(["mp3","ogg","wav","mp4","m4a"],e);cc.audioEngine={_currMusic:null,_musicVolume:1,willPlayMusic:function(){return false;},playMusic:function(m,j){var k=this._currMusic;if(k&&k.src!==m&&k.getPlaying()){k.stop();}var n=e.cache[m];if(!n){cc.loader.load(m);n=e.cache[m];}n.play(0,j);n.setVolume(this._musicVolume);this._currMusic=n;},stopMusic:function(j){var k=this._currMusic;if(k){k.stop();if(j){cc.loader.release(k.src);}}},pauseMusic:function(){var j=this._currMusic;if(j){j.pause();}},resumeMusic:function(){var j=this._currMusic;if(j){j.resume();}},rewindMusic:function(){var j=this._currMusic;if(j){j.stop();j.play();}},getMusicVolume:function(){return this._musicVolume;},setMusicVolume:function(k){k=k-0;if(isNaN(k)){k=1;}if(k>1){k=1;}if(k<0){k=0;}this._musicVolume=k;var j=this._currMusic;if(j){j.setVolume(k);}},isMusicPlaying:function(){var j=this._currMusic;if(j){return j.getPlaying();}else{return false;}},_audioPool:{},_maxAudioInstance:5,_effectVolume:1,playEffect:function(k,j){if(!h){return null;}var n=this._audioPool[k];if(!n){n=this._audioPool[k]=[];}var m;for(m=0;m<n.length;m++){if(!n[m].getPlaying()){break;}}if(n[m]){o=n[m];o.setVolume(this._effectVolume);o.play(0,j);}else{if(!i&&m>this._maxAudioInstance){cc.log("Error: %s greater than %d",k,this._maxAudioInstance);}else{var o=e.cache[k];if(!o){cc.loader.load(k);o=e.cache[k];}o=o.cloneNode();o.setVolume(this._effectVolume);o.loop=j||false;o.play();n.push(o);}}return o;},setEffectsVolume:function(n){n=n-0;if(isNaN(n)){n=1;}if(n>1){n=1;}if(n<0){n=0;}this._effectVolume=n;var j=this._audioPool;for(var o in j){var k=j[o];if(Array.isArray(k)){for(var m=0;m<k.length;m++){k[m].setVolume(n);}}}},getEffectsVolume:function(){return this._effectVolume;},pauseEffect:function(j){if(j){j.pause();}},pauseAllEffects:function(){var k=this._audioPool;for(var n in k){var m=k[n];for(var j=0;j<k[n].length;j++){if(m[j].getPlaying()){m[j].pause();}}}},resumeEffect:function(j){if(j){j.resume();}},resumeAllEffects:function(){var k=this._audioPool;for(var n in k){var m=k[n];for(var j=0;j<k[n].length;j++){m[j].resume();}}},stopEffect:function(j){if(j){j.stop();}},stopAllEffects:function(){var k=this._audioPool;for(var n in k){var m=k[n];for(var j=0;j<k[n].length;j++){m[j].stop();}}},unloadEffect:function(j){if(!j){return;}cc.loader.release(j);var k=this._audioPool[j];if(k){k.length=0;}delete this._audioPool[j];delete e.cache[j];},end:function(){this.stopMusic();this.stopAllEffects();},_pauseCache:[],_pausePlaying:function(){var j=this._currMusic;if(j&&j.getPlaying()){j.pause();this._pauseCache.push(j);}var m=this._audioPool;for(var o in m){var n=m[o];for(var k=0;k<m[o].length;k++){if(n[k].getPlaying()){n[k].pause();this._pauseCache.push(n[k]);}}}},_resumePlaying:function(){var k=this._pauseCache;for(var j=0;j<k.length;j++){k[j].resume();}k.length=0;}};if(!f){var a=function(){var j=cc.audioEngine._currMusic;if(j&&j._touch===false&&j._playing&&j.getPlaying()){j._touch=true;j.play(0,j.loop);!d.replay&&cc._canvas.removeEventListener("touchstart",a);}};setTimeout(function(){if(cc._canvas){cc._canvas.addEventListener("touchstart",a,false);}},150);}cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.audioEngine._pausePlaying();});cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.audioEngine._resumePlaying();});})(cc.__audioSupport);cc._globalFontSize=cc.ITEM_SIZE;cc._globalFontName="Arial";cc._globalFontNameRelease=false;cc.MenuItem=cc.Node.extend({_enabled:false,_target:null,_callback:null,_isSelected:false,_className:"MenuItem",ctor:function(c,b){var a=cc.Node.prototype;a.ctor.call(this);this._target=null;this._callback=null;this._isSelected=false;this._enabled=false;a.setAnchorPoint.call(this,0.5,0.5);this._target=b||null;this._callback=c||null;if(this._callback){this._enabled=true;}},isSelected:function(){return this._isSelected;},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return false;},setTarget:function(a,b){this._target=b;this._callback=a;},isEnabled:function(){return this._enabled;},setEnabled:function(a){this._enabled=a;},initWithCallback:function(b,a){this.anchorX=0.5;this.anchorY=0.5;this._target=a;this._callback=b;this._enabled=true;this._isSelected=false;return true;},rect:function(){var c=this._position,b=this._contentSize,a=this._anchorPoint;return cc.rect(c.x-b.width*a.x,c.y-b.height*a.y,b.width,b.height);},selected:function(){this._isSelected=true;},unselected:function(){this._isSelected=false;},setCallback:function(b,a){this._target=a;this._callback=b;},activate:function(){if(this._enabled){var a=this._target,b=this._callback;if(!b){return;}if(a&&cc.isString(b)){a[b](this);}else{if(a&&cc.isFunction(b)){b.call(a,this);}else{b(this);}}}}});var _p=cc.MenuItem.prototype;_p.enabled;cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled);cc.MenuItem.create=function(b,a){return new cc.MenuItem(b,a);};cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(b,a,c){cc.MenuItem.prototype.ctor.call(this,a,c);this._disabledColor=null;this._label=null;this._colorBackup=null;if(b){this._originalScale=1;this._colorBackup=cc.color.WHITE;this._disabledColor=cc.color(126,126,126);this.setLabel(b);this.cascadeColor=true;this.cascadeOpacity=true;}},getDisabledColor:function(){return this._disabledColor;},setDisabledColor:function(a){this._disabledColor=a;},getLabel:function(){return this._label;},setLabel:function(a){if(a){this.addChild(a);a.anchorX=0;a.anchorY=0;this.width=a.width;this.height=a.height;}if(this._label){this.removeChild(this._label,true);}this._label=a;},setEnabled:function(a){if(this._enabled!=a){var b=this._label;if(!a){this._colorBackup=b.color;b.color=this._disabledColor;}else{b.color=this._colorBackup;}}cc.MenuItem.prototype.setEnabled.call(this,a);},setOpacity:function(a){this._label.opacity=a;},getOpacity:function(){return this._label.opacity;},setColor:function(a){this._label.color=a;},getColor:function(){return this._label.color;},initWithLabel:function(b,a,c){this.initWithCallback(a,c);this._originalScale=1;this._colorBackup=cc.color.WHITE;this._disabledColor=cc.color(126,126,126);this.setLabel(b);this.cascadeColor=true;this.cascadeOpacity=true;return true;},setString:function(a){this._label.string=a;this.width=this._label.width;this.height=this._label.height;},getString:function(){return this._label.string;},activate:function(){if(this._enabled){this.stopAllActions();this.scale=this._originalScale;cc.MenuItem.prototype.activate.call(this);}},selected:function(){if(this._enabled){cc.MenuItem.prototype.selected.call(this);var a=this.getActionByTag(cc.ZOOM_ACTION_TAG);if(a){this.stopAction(a);}else{this._originalScale=this.scale;}var b=cc.scaleTo(0.1,this._originalScale*1.2);b.setTag(cc.ZOOM_ACTION_TAG);this.runAction(b);}},unselected:function(){if(this._enabled){cc.MenuItem.prototype.unselected.call(this);this.stopActionByTag(cc.ZOOM_ACTION_TAG);var a=cc.scaleTo(0.1,this._originalScale);a.setTag(cc.ZOOM_ACTION_TAG);this.runAction(a);}}});var _p=cc.MenuItemLabel.prototype;_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);_p.disabledColor;cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor);_p.label;cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel);cc.MenuItemLabel.create=function(b,a,c){return new cc.MenuItemLabel(b,a,c);};cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(e,a,d,h,c,g,f){var b;if(e&&e.length>0){b=new cc.LabelAtlas(e,a,d,h,c);}cc.MenuItemLabel.prototype.ctor.call(this,b,g,f);},initWithString:function(e,a,d,h,c,g,f){if(!e||e.length==0){throw"cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0";}var b=new cc.LabelAtlas();b.initWithString(e,a,d,h,c);if(this.initWithLabel(b,g,f)){}return true;}});cc.MenuItemAtlasFont.create=function(d,a,c,g,b,f,e){return new cc.MenuItemAtlasFont(d,a,c,g,b,f,e);};cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(b,d,c){var a;if(b&&b.length>0){this._fontName=cc._globalFontName;this._fontSize=cc._globalFontSize;a=new cc.LabelTTF(b,this._fontName,this._fontSize);}else{this._fontSize=0;this._fontName="";}cc.MenuItemLabel.prototype.ctor.call(this,a,d,c);},initWithString:function(b,d,c){if(!b||b.length==0){throw"Value should be non-null and its length should be greater than 0";}this._fontName=cc._globalFontName;this._fontSize=cc._globalFontSize;var a=new cc.LabelTTF(b,this._fontName,this._fontSize);if(this.initWithLabel(a,d,c)){}return true;},setFontSize:function(a){this._fontSize=a;this._recreateLabel();},getFontSize:function(){return this._fontSize;},setFontName:function(a){this._fontName=a;this._recreateLabel();},getFontName:function(){return this._fontName;},_recreateLabel:function(){var a=new cc.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(a);}});cc.MenuItemFont.setFontSize=function(a){cc._globalFontSize=a;};cc.MenuItemFont.fontSize=function(){return cc._globalFontSize;};cc.MenuItemFont.setFontName=function(a){if(cc._globalFontNameRelease){cc._globalFontName="";}cc._globalFontName=a;cc._globalFontNameRelease=true;};var _p=cc.MenuItemFont.prototype;_p.fontSize;cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize);_p.fontName;cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName);cc.MenuItemFont.fontName=function(){return cc._globalFontName;};cc.MenuItemFont.create=function(a,c,b){return new cc.MenuItemFont(a,c,b);};cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(b,c,d,e,a){cc.MenuItem.prototype.ctor.call(this);this._normalImage=null;this._selectedImage=null;this._disabledImage=null;if(c!==undefined){b=b;c=c;var h,f,g;if(a!==undefined){h=d;g=e;f=a;}else{if(e!==undefined&&cc.isFunction(e)){h=d;g=e;}else{if(e!==undefined&&cc.isFunction(d)){f=e;g=d;h=new cc.Sprite(c.getTexture(),c.getTextureRect());}else{if(d===undefined){h=new cc.Sprite(c.getTexture(),c.getTextureRect());}}}}this.initWithNormalSprite(b,c,h,g,f);}},getNormalImage:function(){return this._normalImage;},setNormalImage:function(a){if(this._normalImage==a){return;}if(a){this.addChild(a,0,cc.NORMAL_TAG);a.anchorX=0;a.anchorY=0;}if(this._normalImage){this.removeChild(this._normalImage,true);}this._normalImage=a;this.width=this._normalImage.width;this.height=this._normalImage.height;this._updateImagesVisibility();if(a.textureLoaded&&!a.textureLoaded()){a.addEventListener("load",function(b){this.width=b.width;this.height=b.height;},this);}},getSelectedImage:function(){return this._selectedImage;},setSelectedImage:function(a){if(this._selectedImage==a){return;}if(a){this.addChild(a,0,cc.SELECTED_TAG);a.anchorX=0;a.anchorY=0;}if(this._selectedImage){this.removeChild(this._selectedImage,true);}this._selectedImage=a;this._updateImagesVisibility();},getDisabledImage:function(){return this._disabledImage;},setDisabledImage:function(a){if(this._disabledImage==a){return;}if(a){this.addChild(a,0,cc.DISABLE_TAG);a.anchorX=0;a.anchorY=0;}if(this._disabledImage){this.removeChild(this._disabledImage,true);}this._disabledImage=a;this._updateImagesVisibility();},initWithNormalSprite:function(b,d,c,f,e){this.initWithCallback(f,e);this.setNormalImage(b);this.setSelectedImage(d);this.setDisabledImage(c);var a=this._normalImage;if(a){this.width=a.width;this.height=a.height;if(a.textureLoaded&&!a.textureLoaded()){a.addEventListener("load",function(g){this.width=g.width;this.height=g.height;this.cascadeColor=true;this.cascadeOpacity=true;},this);}}this.cascadeColor=true;this.cascadeOpacity=true;return true;},setColor:function(a){this._normalImage.color=a;if(this._selectedImage){this._selectedImage.color=a;}if(this._disabledImage){this._disabledImage.color=a;}},getColor:function(){return this._normalImage.color;},setOpacity:function(a){this._normalImage.opacity=a;if(this._selectedImage){this._selectedImage.opacity=a;}if(this._disabledImage){this._disabledImage.opacity=a;}},getOpacity:function(){return this._normalImage.opacity;},selected:function(){cc.MenuItem.prototype.selected.call(this);if(this._normalImage){if(this._disabledImage){this._disabledImage.visible=false;}if(this._selectedImage){this._normalImage.visible=false;this._selectedImage.visible=true;}else{this._normalImage.visible=true;}}},unselected:function(){cc.MenuItem.prototype.unselected.call(this);if(this._normalImage){this._normalImage.visible=true;if(this._selectedImage){this._selectedImage.visible=false;}if(this._disabledImage){this._disabledImage.visible=false;}}},setEnabled:function(a){if(this._enabled!=a){cc.MenuItem.prototype.setEnabled.call(this,a);this._updateImagesVisibility();}},_updateImagesVisibility:function(){var a=this._normalImage,c=this._selectedImage,b=this._disabledImage;if(this._enabled){if(a){a.visible=true;}if(c){c.visible=false;}if(b){b.visible=false;}}else{if(b){if(a){a.visible=false;}if(c){c.visible=false;}if(b){b.visible=true;}}else{if(a){a.visible=true;}if(c){c.visible=false;}}}}});var _p=cc.MenuItemSprite.prototype;_p.normalImage;cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage);_p.selectedImage;cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage);_p.disabledImage;cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage);cc.MenuItemSprite.create=function(b,c,d,e,a){return new cc.MenuItemSprite(b,c,d,e,a||undefined);};cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(d,b,a,i,h){var f=null,g=null,c=null,j=null,e=null;if(d===undefined){cc.MenuItemSprite.prototype.ctor.call(this);}else{f=new cc.Sprite(d);b&&(g=new cc.Sprite(b));if(i===undefined){j=a;}else{if(h===undefined){j=a;e=i;}else{if(h){c=new cc.Sprite(a);j=i;e=h;}}}cc.MenuItemSprite.prototype.ctor.call(this,f,g,c,j,e);}},setNormalSpriteFrame:function(a){this.setNormalImage(new cc.Sprite(a));},setSelectedSpriteFrame:function(a){this.setSelectedImage(new cc.Sprite(a));},setDisabledSpriteFrame:function(a){this.setDisabledImage(new cc.Sprite(a));},initWithNormalImage:function(b,e,h,g,f){var a=null;var d=null;var c=null;if(b){a=new cc.Sprite(b);}if(e){d=new cc.Sprite(e);}if(h){c=new cc.Sprite(h);}return this.initWithNormalSprite(a,d,c,g,f);}});cc.MenuItemImage.create=function(b,c,d,e,a){return new cc.MenuItemImage(b,c,d,e,a);};cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this);this._selectedIndex=0;this.subItems=[];this._opacity=0;this._color=cc.color.WHITE;if(arguments.length>0){this.initWithItems(Array.prototype.slice.apply(arguments));}},getOpacity:function(){return this._opacity;},setOpacity:function(a){this._opacity=a;if(this.subItems&&this.subItems.length>0){for(var b=0;b<this.subItems.length;b++){this.subItems[b].opacity=a;}}this._color.a=a;},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a);},setColor:function(a){var c=this._color;c.r=a.r;c.g=a.g;c.b=a.b;if(this.subItems&&this.subItems.length>0){for(var b=0;b<this.subItems.length;b++){this.subItems[b].setColor(a);}}if(a.a!==undefined&&!a.a_undefined){this.setOpacity(a.a);}},getSelectedIndex:function(){return this._selectedIndex;},setSelectedIndex:function(e){if(e!=this._selectedIndex){this._selectedIndex=e;var a=this.getChildByTag(cc.CURRENT_ITEM);if(a){a.removeFromParent(false);}var d=this.subItems[this._selectedIndex];this.addChild(d,0,cc.CURRENT_ITEM);var b=d.width,c=d.height;this.width=b;this.height=c;d.setPosition(b/2,c/2);}},getSubItems:function(){return this.subItems;},setSubItems:function(a){this.subItems=a;},initWithItems:function(c){var b=c.length;if(cc.isFunction(c[c.length-2])){this.initWithCallback(c[c.length-2],c[c.length-1]);b=b-2;}else{if(cc.isFunction(c[c.length-1])){this.initWithCallback(c[c.length-1],null);b=b-1;}else{this.initWithCallback(null,null);}}var a=this.subItems;a.length=0;for(var d=0;d<b;d++){if(c[d]){a.push(c[d]);}}this._selectedIndex=cc.UINT_MAX;this.setSelectedIndex(0);this.cascadeColor=true;this.cascadeOpacity=true;return true;},addSubItem:function(a){this.subItems.push(a);},activate:function(){if(this._enabled){var a=(this._selectedIndex+1)%this.subItems.length;this.setSelectedIndex(a);}cc.MenuItem.prototype.activate.call(this);},selected:function(){cc.MenuItem.prototype.selected.call(this);this.subItems[this._selectedIndex].selected();},unselected:function(){cc.MenuItem.prototype.unselected.call(this);this.subItems[this._selectedIndex].unselected();},setEnabled:function(a){if(this._enabled!=a){cc.MenuItem.prototype.setEnabled.call(this,a);var c=this.subItems;if(c&&c.length>0){for(var b=0;b<c.length;b++){c[b].enabled=a;}}}},selectedItem:function(){return this.subItems[this._selectedIndex];},getSelectedItem:function(){return this.subItems[this._selectedIndex];},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.setSelectedIndex(this._selectedIndex);}});var _p=cc.MenuItemToggle.prototype;_p.selectedIndex;cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex);cc.MenuItemToggle.create=function(){if((arguments.length>0)&&(arguments[arguments.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var a=new cc.MenuItemToggle();a.initWithItems(Array.prototype.slice.apply(arguments));return a;};cc.MENU_STATE_WAITING=0;cc.MENU_STATE_TRACKING_TOUCH=1;cc.MENU_HANDLER_PRIORITY=-128;cc.DEFAULT_PADDING=5;cc.Menu=cc.Layer.extend({enabled:false,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(c){cc.Layer.prototype.ctor.call(this);this._color=cc.color.WHITE;this.enabled=false;this._opacity=255;this._selectedItem=null;this._state=-1;this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled});if((arguments.length>0)&&(arguments[arguments.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var d=arguments.length,a;if(d==0){a=[];}else{if(d==1){if(c instanceof Array){a=c;}else{a=[c];}}else{if(d>1){a=[];for(var b=0;b<d;b++){if(arguments[b]){a.push(arguments[b]);}}}}}this.initWithArray(a);},onEnter:function(){var a=this._touchListener;if(!a._isRegistered()){cc.eventManager.addListener(a,this);}cc.Node.prototype.onEnter.call(this);},isEnabled:function(){return this.enabled;},setEnabled:function(a){this.enabled=a;},initWithItems:function(a){var c=[];if(a){for(var b=0;b<a.length;b++){if(a[b]){c.push(a[b]);}}}return this.initWithArray(c);},initWithArray:function(a){if(cc.Layer.prototype.init.call(this)){this.enabled=true;var b=cc.winSize;this.setPosition(b.width/2,b.height/2);this.setContentSize(b);this.setAnchorPoint(0.5,0.5);this.ignoreAnchorPointForPosition(true);if(a){for(var c=0;c<a.length;c++){this.addChild(a[c],c);}}this._selectedItem=null;this._state=cc.MENU_STATE_WAITING;this.cascadeColor=true;this.cascadeOpacity=true;return true;}return false;},addChild:function(c,b,a){if(!(c instanceof cc.MenuItem)){throw"cc.Menu.addChild() : Menu only supports MenuItem objects as children";}cc.Layer.prototype.addChild.call(this,c,b,a);},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING);},alignItemsVerticallyWithPadding:function(h){var j=-h,b=this._children,d,c,e,f,a;if(b&&b.length>0){for(c=0,d=b.length;c<d;c++){j+=b[c].height*b[c].scaleY+h;}var g=j/2;for(c=0,d=b.length;c<d;c++){a=b[c];f=a.height;e=a.scaleY;a.setPosition(0,g-f*e/2);g-=f*e+h;}}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING);},alignItemsHorizontallyWithPadding:function(h){var c=-h,b=this._children,d,e,f,j,a;if(b&&b.length>0){for(d=0,e=b.length;d<e;d++){c+=b[d].width*b[d].scaleX+h;}var g=-c/2;for(d=0,e=b.length;d<e;d++){a=b[d];f=a.scaleX;j=b[d].width;a.setPosition(g+j*f/2,0);g+=j*f+h;}}},alignItemsInColumns:function(){if((arguments.length>0)&&(arguments[arguments.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var q=[];for(var e=0;e<arguments.length;e++){q.push(arguments[e]);}var o=-5;var p=0;var b=0;var n=0;var d,f,h;var a=this._children;if(a&&a.length>0){for(e=0,h=a.length;e<h;e++){if(p>=q.length){continue;}d=q[p];if(!d){continue;}f=a[e].height;b=((b>=f||isNaN(f))?b:f);++n;if(n>=d){o+=b+5;n=0;b=0;++p;}}}var g=cc.director.getWinSize();p=0;b=0;d=0;var m=0;var k=0;var j=(o/2);if(a&&a.length>0){for(e=0,h=a.length;e<h;e++){var c=a[e];if(d==0){d=q[p];m=g.width/(1+d);k=m;}f=c._getHeight();b=((b>=f||isNaN(f))?b:f);c.setPosition(k-g.width/2,j-f/2);k+=m;++n;if(n>=d){j-=b+5;n=0;d=0;b=0;++p;}}}},alignItemsInRows:function(){if((arguments.length>0)&&(arguments[arguments.length-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var j=[],m;for(m=0;m<arguments.length;m++){j.push(arguments[m]);}var b=[];var o=[];var d=-10;var q=-5;var h=0;var f=0;var g=0;var c,e,p,k;var a=this._children;if(a&&a.length>0){for(m=0,p=a.length;m<p;m++){e=a[m];if(h>=j.length){continue;}c=j[h];if(!c){continue;}k=e.width;f=((f>=k||isNaN(k))?f:k);q+=(e.height+5);++g;if(g>=c){b.push(f);o.push(q);d+=f+10;g=0;f=0;q=-5;++h;}}}var n=cc.director.getWinSize();h=0;f=0;c=0;var s=-d/2;var r=0;if(a&&a.length>0){for(m=0,p=a.length;m<p;m++){e=a[m];if(c==0){c=j[h];r=o[h];}k=e._getWidth();f=((f>=k||isNaN(k))?f:k);e.setPosition(s+b[h]/2,r-n.height/2);r-=e.height+10;++g;if(g>=c){s+=f+5;g=0;c=0;f=0;++h;}}}},removeChild:function(b,a){if(b==null){return;}if(!(b instanceof cc.MenuItem)){cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children");return;}if(this._selectedItem==b){this._selectedItem=null;}cc.Node.prototype.removeChild.call(this,b,a);},_onTouchBegan:function(e,a){var b=a.getCurrentTarget();if(b._state!=cc.MENU_STATE_WAITING||!b._visible||!b.enabled){return false;}for(var d=b.parent;d!=null;d=d.parent){if(!d.isVisible()){return false;}}b._selectedItem=b._itemForTouch(e);if(b._selectedItem){b._state=cc.MENU_STATE_TRACKING_TOUCH;b._selectedItem.selected();b._selectedItem.setNodeDirty();return true;}return false;},_onTouchEnded:function(c,a){var b=a.getCurrentTarget();if(b._state!==cc.MENU_STATE_TRACKING_TOUCH){cc.log("cc.Menu.onTouchEnded(): invalid state");return;}if(b._selectedItem){b._selectedItem.unselected();b._selectedItem.setNodeDirty();b._selectedItem.activate();}b._state=cc.MENU_STATE_WAITING;},_onTouchCancelled:function(c,a){var b=a.getCurrentTarget();if(b._state!==cc.MENU_STATE_TRACKING_TOUCH){cc.log("cc.Menu.onTouchCancelled(): invalid state");return;}if(this._selectedItem){b._selectedItem.unselected();b._selectedItem.setNodeDirty();}b._state=cc.MENU_STATE_WAITING;},_onTouchMoved:function(d,b){var c=b.getCurrentTarget();if(c._state!==cc.MENU_STATE_TRACKING_TOUCH){cc.log("cc.Menu.onTouchMoved(): invalid state");return;}var a=c._itemForTouch(d);if(a!=c._selectedItem){if(c._selectedItem){c._selectedItem.unselected();c._selectedItem.setNodeDirty();}c._selectedItem=a;if(c._selectedItem){c._selectedItem.selected();c._selectedItem.setNodeDirty();}}},onExit:function(){if(this._state==cc.MENU_STATE_TRACKING_TOUCH){if(this._selectedItem){this._selectedItem.unselected();this._selectedItem=null;}this._state=cc.MENU_STATE_WAITING;}cc.Node.prototype.onExit.call(this);},setOpacityModifyRGB:function(a){},isOpacityModifyRGB:function(){return false;},_itemForTouch:function(g){var a=g.getLocation();var f=this._children,e;if(f&&f.length>0){for(var c=f.length-1;c>=0;c--){e=f[c];if(e.isVisible()&&e.isEnabled()){var b=e.convertToNodeSpace(a);var d=e.rect();d.x=0;d.y=0;if(cc.rectContainsPoint(d,b)){return e;}}}}return null;}});var _p=cc.Menu.prototype;_p.enabled;cc.Menu.create=function(b){var c=arguments.length;if((c>0)&&(arguments[c-1]==null)){cc.log("parameters should not be ending with null in Javascript");}var a;if(c==0){a=new cc.Menu();}else{if(c==1){a=new cc.Menu(b);}else{a=new cc.Menu(Array.prototype.slice.call(arguments,0));}}return a;};