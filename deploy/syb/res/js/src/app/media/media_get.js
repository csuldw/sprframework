define(["app/home","app/valid","app/media/media_add","app/media/media_list","lib/plugins/tables.min","lib/plugins/urls.min","lib/plugins/lists.min","lib/plugins/colors.min","lib/plugins/font_family.min","lib/plugins/font_size.min","lib/plugins/block_styles.min","lib/plugins/media_manager.min","lib/plugins/video.min","lib/plugins/char_counter.min","lib/plugins/zh_cn"],function(home,v){var id=$("#pId").val();var loadComment=function(num){$.ajax({url:"/app/media/comment/list/"+ id,type:"POST",data:{page:num}}).done(function(data){if(data.success==true&&data.responseData.records>0){$(".comment-list").html($("#tpl-comment-item").render(data.responseData.rows));home.paging($(".comment-pager"),data.responseData.total,data.responseData.page,loadComment,"small","middle",$(".comment-list"));}});}
return{init:function(){id=$("#pId").val();$(function(){$('textarea#editor').editable({inlineMode:false});});$(".pub-media").click(function(){$.ajax({url:"/app/media/add",type:"POST",data:home.generateFormData("#media-form-add")}).done(function(data){if(data.success==true){home.success(data.message);}else{home.error(data.message);}})})
$(".btn-post-comment").click(function(){if(v.doValidForm($("#c_c_f"))){var $b=$(this);var c=$b.html();home.lbtn($b);$.ajax({url:"/app/media/comment/add/"+ id,type:"POST",data:home.generateFormData($("#c_c_f"))}).done(function(data){if(data.success==true){loadComment();$("#c_c_f").find("textarea").val("");home.success(data.message);}
home.cbtn($b,c);});}});loadComment(1);}};});